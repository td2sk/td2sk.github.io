var Mo=Object.defineProperty;var To=(n,s,c)=>s in n?Mo(n,s,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[s]=c;var xt=(n,s,c)=>(To(n,typeof s!="symbol"?s+"":s,c),c);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const E of document.querySelectorAll('link[rel="modulepreload"]'))f(E);new MutationObserver(E=>{for(const D of E)if(D.type==="childList")for(const U of D.addedNodes)U.tagName==="LINK"&&U.rel==="modulepreload"&&f(U)}).observe(document,{childList:!0,subtree:!0});function c(E){const D={};return E.integrity&&(D.integrity=E.integrity),E.referrerPolicy&&(D.referrerPolicy=E.referrerPolicy),E.crossOrigin==="use-credentials"?D.credentials="include":E.crossOrigin==="anonymous"?D.credentials="omit":D.credentials="same-origin",D}function f(E){if(E.ep)return;E.ep=!0;const D=c(E);fetch(E.href,D)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist={exports:{}},jsuites={exports:{}},hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(n,s){(function(f,E){n.exports=E()})(commonjsGlobal,function(){return function(){var c={195:function(U){(function(d,r){U.exports=r()})(this,function(){return function(Le){function r(Me,Ie){this.highOrder=Me,this.lowOrder=Ie}var b=[new r(1779033703,4089235720),new r(3144134277,2227873595),new r(1013904242,4271175723),new r(2773480762,1595750129),new r(1359893119,2917565137),new r(2600822924,725511199),new r(528734635,4215389547),new r(1541459225,327033209)],H=[new r(1116352408,3609767458),new r(1899447441,602891725),new r(3049323471,3964484399),new r(3921009573,2173295548),new r(961987163,4081628472),new r(1508970993,3053834265),new r(2453635748,2937671579),new r(2870763221,3664609560),new r(3624381080,2734883394),new r(310598401,1164996542),new r(607225278,1323610764),new r(1426881987,3590304994),new r(1925078388,4068182383),new r(2162078206,991336113),new r(2614888103,633803317),new r(3248222580,3479774868),new r(3835390401,2666613458),new r(4022224774,944711139),new r(264347078,2341262773),new r(604807628,2007800933),new r(770255983,1495990901),new r(1249150122,1856431235),new r(1555081692,3175218132),new r(1996064986,2198950837),new r(2554220882,3999719339),new r(2821834349,766784016),new r(2952996808,2566594879),new r(3210313671,3203337956),new r(3336571891,1034457026),new r(3584528711,2466948901),new r(113926993,3758326383),new r(338241895,168717936),new r(666307205,1188179964),new r(773529912,1546045734),new r(1294757372,1522805485),new r(1396182291,2643833823),new r(1695183700,2343527390),new r(1986661051,1014477480),new r(2177026350,1206759142),new r(2456956037,344077627),new r(2730485921,1290863460),new r(2820302411,3158454273),new r(3259730800,3505952657),new r(3345764771,106217008),new r(3516065817,3606008344),new r(3600352804,1432725776),new r(4094571909,1467031594),new r(275423344,851169720),new r(430227734,3100823752),new r(506948616,1363258195),new r(659060556,3750685593),new r(883997877,3785050280),new r(958139571,3318307427),new r(1322822218,3812723403),new r(1537002063,2003034995),new r(1747873779,3602036899),new r(1955562222,1575990012),new r(2024104815,1125592928),new r(2227730452,2716904306),new r(2361852424,442776044),new r(2428436474,593698344),new r(2756734187,3733110249),new r(3204031479,2999351573),new r(3329325298,3815920427),new r(3391569614,3928383900),new r(3515267271,566280711),new r(3940187606,3454069534),new r(4118630271,4000239992),new r(116418474,1914138554),new r(174292421,2731055270),new r(289380356,3203993006),new r(460393269,320620315),new r(685471733,587496836),new r(852142971,1086792851),new r(1017036298,365543100),new r(1126000580,2618297676),new r(1288033470,3409855158),new r(1501505948,4234509866),new r(1607167915,987167468),new r(1816402316,1246189591)],P=new Array(64),g,u,m,j,h,C,T,I,B,F,N,O,G=8;function q(Me){return unescape(encodeURIComponent(Me))}function se(Me){for(var Ie=[],Oe=(1<<G)-1,ze=Me.length*G,Ge=0;Ge<ze;Ge+=G)Ie[Ge>>5]|=(Me.charCodeAt(Ge/G)&Oe)<<32-G-Ge%32;return Ie}function ge(Me){for(var Ie="0123456789abcdef",Oe="",ze=Me.length*4,Ge,Qe=0;Qe<ze;Qe+=1)Ge=Me[Qe>>2]>>(3-Qe%4)*8,Oe+=Ie.charAt(Ge>>4&15)+Ie.charAt(Ge&15);return Oe}function ie(Me,Ie){var Oe,ze,Ge,Qe;return Oe=(Me.lowOrder&65535)+(Ie.lowOrder&65535),ze=(Me.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Oe>>>16),Ge=(ze&65535)<<16|Oe&65535,Oe=(Me.highOrder&65535)+(Ie.highOrder&65535)+(ze>>>16),ze=(Me.highOrder>>>16)+(Ie.highOrder>>>16)+(Oe>>>16),Qe=(ze&65535)<<16|Oe&65535,new r(Qe,Ge)}function xe(Me,Ie,Oe,ze){var Ge,Qe,ct,at;return Ge=(Me.lowOrder&65535)+(Ie.lowOrder&65535)+(Oe.lowOrder&65535)+(ze.lowOrder&65535),Qe=(Me.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Oe.lowOrder>>>16)+(ze.lowOrder>>>16)+(Ge>>>16),ct=(Qe&65535)<<16|Ge&65535,Ge=(Me.highOrder&65535)+(Ie.highOrder&65535)+(Oe.highOrder&65535)+(ze.highOrder&65535)+(Qe>>>16),Qe=(Me.highOrder>>>16)+(Ie.highOrder>>>16)+(Oe.highOrder>>>16)+(ze.highOrder>>>16)+(Ge>>>16),at=(Qe&65535)<<16|Ge&65535,new r(at,ct)}function Te(Me,Ie,Oe,ze,Ge){var Qe,ct,at,dt;return Qe=(Me.lowOrder&65535)+(Ie.lowOrder&65535)+(Oe.lowOrder&65535)+(ze.lowOrder&65535)+(Ge.lowOrder&65535),ct=(Me.lowOrder>>>16)+(Ie.lowOrder>>>16)+(Oe.lowOrder>>>16)+(ze.lowOrder>>>16)+(Ge.lowOrder>>>16)+(Qe>>>16),at=(ct&65535)<<16|Qe&65535,Qe=(Me.highOrder&65535)+(Ie.highOrder&65535)+(Oe.highOrder&65535)+(ze.highOrder&65535)+(Ge.highOrder&65535)+(ct>>>16),ct=(Me.highOrder>>>16)+(Ie.highOrder>>>16)+(Oe.highOrder>>>16)+(ze.highOrder>>>16)+(Ge.highOrder>>>16)+(Qe>>>16),dt=(ct&65535)<<16|Qe&65535,new r(dt,at)}function ye(Me,Ie,Oe){return new r(Me.highOrder&Ie.highOrder^Me.highOrder&Oe.highOrder^Ie.highOrder&Oe.highOrder,Me.lowOrder&Ie.lowOrder^Me.lowOrder&Oe.lowOrder^Ie.lowOrder&Oe.lowOrder)}function ae(Me,Ie,Oe){return new r(Me.highOrder&Ie.highOrder^~Me.highOrder&Oe.highOrder,Me.lowOrder&Ie.lowOrder^~Me.lowOrder&Oe.lowOrder)}function ke(Me,Ie){return Ie<=32?new r(Me.highOrder>>>Ie|Me.lowOrder<<32-Ie,Me.lowOrder>>>Ie|Me.highOrder<<32-Ie):new r(Me.lowOrder>>>Ie|Me.highOrder<<32-Ie,Me.highOrder>>>Ie|Me.lowOrder<<32-Ie)}function Ke(Me){var Ie=ke(Me,28),Oe=ke(Me,34),ze=ke(Me,39);return new r(Ie.highOrder^Oe.highOrder^ze.highOrder,Ie.lowOrder^Oe.lowOrder^ze.lowOrder)}function qe(Me){var Ie=ke(Me,14),Oe=ke(Me,18),ze=ke(Me,41);return new r(Ie.highOrder^Oe.highOrder^ze.highOrder,Ie.lowOrder^Oe.lowOrder^ze.lowOrder)}function Be(Me){var Ie=ke(Me,1),Oe=ke(Me,8),ze=Y(Me,7);return new r(Ie.highOrder^Oe.highOrder^ze.highOrder,Ie.lowOrder^Oe.lowOrder^ze.lowOrder)}function lt(Me){var Ie=ke(Me,19),Oe=ke(Me,61),ze=Y(Me,6);return new r(Ie.highOrder^Oe.highOrder^ze.highOrder,Ie.lowOrder^Oe.lowOrder^ze.lowOrder)}function Y(Me,Ie){return Ie<=32?new r(Me.highOrder>>>Ie,Me.lowOrder>>>Ie|Me.highOrder<<32-Ie):new r(0,Me.highOrder<<32-Ie)}var Le=q(Le),Ue=Le.length*G;Le=se(Le),Le[Ue>>5]|=128<<24-Ue%32,Le[(Ue+128>>10<<5)+31]=Ue;for(var B=0;B<Le.length;B+=32){g=b[0],u=b[1],m=b[2],j=b[3],h=b[4],C=b[5],T=b[6],I=b[7];for(var F=0;F<80;F++)F<16?P[F]=new r(Le[F*2+B],Le[F*2+B+1]):P[F]=xe(lt(P[F-2]),P[F-7],Be(P[F-15]),P[F-16]),N=Te(I,qe(h),ae(h,C,T),H[F],P[F]),O=ie(Ke(g),ye(g,u,m)),I=T,T=C,C=h,h=ie(j,N),j=m,m=u,u=g,g=ie(N,O);b[0]=ie(g,b[0]),b[1]=ie(u,b[1]),b[2]=ie(m,b[2]),b[3]=ie(j,b[3]),b[4]=ie(h,b[4]),b[5]=ie(C,b[5]),b[6]=ie(T,b[6]),b[7]=ie(I,b[7])}for(var mt=[],B=0;B<b.length;B++)mt.push(b[B].highOrder),mt.push(b[B].lowOrder);return ge(mt)}})}},f={};function E(U){var d=f[U];if(d!==void 0)return d.exports;var r=f[U]={exports:{}};return c[U].call(r.exports,r,r.exports,E),r.exports}(function(){E.n=function(U){var d=U&&U.__esModule?function(){return U.default}:function(){return U};return E.d(d,{a:d}),d}})(),function(){E.d=function(U,d){for(var r in d)E.o(d,r)&&!E.o(U,r)&&Object.defineProperty(U,r,{enumerable:!0,get:d[r]})}}(),function(){E.o=function(U,d){return Object.prototype.hasOwnProperty.call(U,d)}}();var D={};return function(){E.d(D,{default:function(){return Nt}});var U={};U.two=function(w){return w=""+w,w.length==1&&(w="0"+w),w},U.focus=function(w){if(w.innerText.length){var A=document.createRange(),l=window.getSelection(),o=w.childNodes[w.childNodes.length-1];A.setStart(o,o.length),A.collapse(!0),l.removeAllRanges(),l.addRange(A),w.scrollLeft=w.scrollWidth}},U.isNumeric=function(w){return typeof w=="string"&&(w=w.trim()),!isNaN(w)&&w!==null&&w!==""},U.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(w){var A=Math.random()*16|0,l=w=="x"?A:A&3|8;return l.toString(16)})},U.getNode=function(){var w=document.getSelection().anchorNode;return w?w.nodeType==3?w.parentNode:w:null},U.hash=function(w){var A=0,l,o;if(w.length===0)return A;for(l=0;l<w.length;l++)o=w.charCodeAt(l),o>32&&(A=(A<<5)-A+o,A|=0);return A},U.randomColor=function(w){var A=-.25,l=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");l.length<6&&(l=l[0]+l[0]+l[1]+l[1]+l[2]+l[2]);var o=[],k,Q;for(Q=0;Q<3;Q++)k=parseInt(l.substr(Q*2,2),16),k=Math.round(Math.min(Math.max(0,k+k*A),255)).toString(16),o.push(("00"+k).substr(k.length));return w==!0?"#"+U.two(o[0].toString(16))+U.two(o[1].toString(16))+U.two(o[2].toString(16)):o},U.getWindowWidth=function(){var w=window,A=document,l=A.documentElement,o=A.getElementsByTagName("body")[0],k=w.innerWidth||l.clientWidth||o.clientWidth;return k},U.getWindowHeight=function(){var w=window,A=document,l=A.documentElement,o=A.getElementsByTagName("body")[0],k=w.innerHeight||l.clientHeight||o.clientHeight;return k},U.getPosition=function(w){if(w.changedTouches&&w.changedTouches[0])var A=w.changedTouches[0].pageX,l=w.changedTouches[0].pageY;else var A=window.Event?w.pageX:w.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),l=window.Event?w.pageY:w.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[A,l]},U.click=function(w){if(w.click)w.click();else{var A=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});w.dispatchEvent(A)}},U.findElement=function(w,A){var l=!1;function o(k){k&&!l&&(typeof A=="function"?l=A(k):typeof A=="string"&&k.classList&&k.classList.contains(A)&&(l=k)),k.parentNode&&!l&&o(k.parentNode)}return o(w),l};var d=U;function r(){var w={};w.now=function(k,Q){var ee=null,S=null,M=null,V=null,K=null,oe=null;return Array.isArray(k)?(ee=k[0],S=k[1],M=k[2],V=k[3],K=k[4],oe=k[5]):(k||(k=new Date),ee=k.getFullYear(),S=k.getMonth()+1,M=k.getDate(),V=k.getHours(),K=k.getMinutes(),oe=k.getSeconds()),Q==!0?d.two(ee)+"-"+d.two(S)+"-"+d.two(M):d.two(ee)+"-"+d.two(S)+"-"+d.two(M)+" "+d.two(V)+":"+d.two(K)+":"+d.two(oe)},w.toArray=function(k){var ee=k.split(k.indexOf("T")!==-1?"T":" "),Q=ee[1],ee=ee[0].split("-"),S=parseInt(ee[0]),M=parseInt(ee[1]),V=parseInt(ee[2]),K=0,oe=0;return Q&&(Q=Q.split(":"),K=parseInt(Q[0]),oe=parseInt(Q[1])),[S,M,V,K,oe,0]};var A=Date.UTC(1900,0,0),l=Date.UTC(1900,1,29),o=864e5;return w.dateToNum=function(k){typeof k=="string"&&(k=new Date(k+"  GMT+0"));var Q=k.getTime();return Q>=l&&(Q+=o),Q-=A,Q/o},w.numToDate=function(k){var Q=A+k*o;Q>=l&&(Q-=o);const ee=new Date(Q);var S=[ee.getUTCFullYear(),ee.getUTCMonth()+1,ee.getUTCDate(),ee.getUTCHours(),ee.getUTCMinutes(),ee.getUTCSeconds()];return w.now(S)},w.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],w.months=["January","February","March","April","May","June","July","August","September","October","November","December"],w.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],w.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],w}var b=r(),H=function(w){document.dictionary||(document.dictionary={});var A=null,l=null,o=Object.keys(w);for(l=0;l<o.length;l++)document.dictionary[o[l]]=w[o[l]];for(l=0;l<b.weekdays.length;l++)A=P(b.weekdays[l]),b.weekdays[l]&&(b.weekdays[l]=A,b.weekdaysShort[l]=A.substr(0,3));for(l=0;l<b.months.length;l++)A=P(b.months[l]),A&&(b.months[l]=A,b.monthsShort[l]=A.substr(0,3))},P=function(w){return typeof document<"u"&&document.dictionary&&document.dictionary[w]||w},g={setDictionary:H,translate:P};function u(w,A){if(A==!0)document.jsuitesComponents=document.jsuitesComponents.filter(function(o){return o!==null}),setTimeout(function(){document.jsuitesComponents.push(w)},0);else{var l=document.jsuitesComponents.indexOf(w);l>=0&&document.jsuitesComponents.splice(l,1)}}function m(w,A,l){if(w=w.split("."),w.length){let o=this,k=null;for(;w.length>1;)if(k=w.shift(),o.hasOwnProperty(k))o=o[k];else{if(typeof A>"u")return;o[k]={},o=o[k]}if(k=w.shift(),typeof A<"u")return l===!0?delete o[k]:o[k]=A,!0;if(o)return o[k]}return!1}function j(w,A){var l={};l.options={};var o={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},k=null;for(var Q in o)A&&A.hasOwnProperty(Q)?l.options[Q]=A[Q]:l.options[Q]=o[Q];w.classList.add("jsorting"),w.addEventListener("dragstart",function(M){var V=Array.prototype.indexOf.call(M.target.parentNode.children,M.target);k={element:M.target,o:V,d:V},M.target.style.opacity="0.25",typeof l.options.ondragstart=="function"&&l.options.ondragstart(w,M.target,M)}),w.addEventListener("dragover",function(M){if(M.preventDefault(),ee(M.target)&&k&&M.target.getAttribute("draggable")=="true"&&k.element!=M.target){if(l.options.direction)var V=M.target.clientWidth/2>M.offsetX;else var V=M.target.clientHeight/2>M.offsetY;V?M.target.parentNode.insertBefore(k.element,M.target):M.target.parentNode.insertBefore(k.element,M.target.nextSibling),k.d=Array.prototype.indexOf.call(M.target.parentNode.children,k.element)}}),w.addEventListener("dragleave",function(M){M.preventDefault()}),w.addEventListener("dragend",function(M){M.preventDefault(),k&&(typeof l.options.ondragend=="function"&&l.options.ondragend(w,k.element,M),k.o<k.d?M.target.parentNode.insertBefore(k.element,M.target.parentNode.children[k.o]):M.target.parentNode.insertBefore(k.element,M.target.parentNode.children[k.o].nextSibling),k.element.style.opacity="",k=null)}),w.addEventListener("drop",function(M){M.preventDefault(),k&&k.o!=k.d&&typeof l.options.ondrop=="function"&&l.options.ondrop(w,k.o,k.d,k.element,M.target,M),k.element.style.opacity="",k=null});for(var ee=function(M){var V=!1;function K(oe){oe.className&&oe.classList.contains("jsorting")&&(V=!0),V||K(oe.parentNode)}return K(M),V},S=0;S<w.children.length;S++)w.children[S].hasAttribute("draggable")||w.children[S].setAttribute("draggable","true");return w.val=function(){for(var M=null,V=[],K=0;K<w.children.length;K++)(M=w.children[K].getAttribute("data-id"))&&V.push(M);return V},w}function h(w,A){var l={};(!A.loadUp||typeof A.loadUp!="function")&&(A.loadUp=function(){return!1}),(!A.loadDown||typeof A.loadDown!="function")&&(A.loadDown=function(){return!1}),A.timer||(A.timer=100);var o=null,k=function(Q){if(o==null){var ee=!1,S=w.scrollTop;w.scrollTop+w.clientHeight*2>=w.scrollHeight?A.loadDown()&&(S==w.scrollTop&&(w.scrollTop=w.scrollTop-w.clientHeight),ee=!0):w.scrollTop<=w.clientHeight&&A.loadUp()&&(S==w.scrollTop&&(w.scrollTop=w.scrollTop+w.clientHeight),ee=!0),o=setTimeout(function(){o=null},A.timer),ee&&typeof A.onupdate=="function"&&A.onupdate()}};return w.onscroll=function(Q){k()},w.onwheel=function(Q){k()},l}function C(){var w=function(A,l){if(Array.isArray(A)){var o={instance:[],complete:l};if(A.length>0)for(var k=0;k<A.length;k++)A[k].multiple=o,o.instance.push(w(A[k]));return o}if(A.data||(A.data={}),A.type&&(A.method=A.type),A.method||(A.method="GET"),A.dataType||(A.dataType="json"),A.data){var Q=function(oe,ve){var de=[];if(oe){var fe=Object.keys(oe);if(fe.length)for(var le=0;le<fe.length;le++){if(ve)var me=ve+"["+fe[le]+"]";else var me=fe[le];if(oe[me]instanceof FileList)de[me]=oe[fe[le]];else if(oe[fe[le]]===null||oe[fe[le]]===void 0)de[me]="";else if(typeof oe[fe[le]]=="object")for(var Ne=Q(oe[fe[le]],me),We=Object.keys(Ne),Je=0;Je<We.length;Je++)de[We[Je]]=Ne[We[Je]];else de[me]=oe[fe[le]]}}return de},ee=Q(A.data),S=Object.keys(ee);if(A.method=="GET"){if(S.length){for(var M=[],k=0;k<S.length;k++)M.push(S[k]+"="+encodeURIComponent(ee[S[k]]));A.url.indexOf("?")<0&&(A.url+="?"),A.url+=M.join("&")}}else for(var M=new FormData,k=0;k<S.length;k++)if(ee[S[k]]instanceof FileList){if(ee[S[k]].length)for(var V=0;V<ee[S[k]].length;V++)M.append(S[k],ee[S[k]][V],ee[S[k]][V].name)}else M.append(S[k],ee[S[k]])}var K=new XMLHttpRequest;return K.open(A.method,A.url,!0),K.setRequestHeader("X-Requested-With","XMLHttpRequest"),A.contentType&&K.setRequestHeader("Content-Type",A.contentType),A.method==="POST"?K.setRequestHeader("Accept","application/json"):A.dataType==="blob"?K.responseType="blob":A.contentType||(A.dataType==="json"?K.setRequestHeader("Content-Type","text/json"):A.dataType==="html"&&K.setRequestHeader("Content-Type","text/html")),A.cache!==!0&&(K.setRequestHeader("pragma","no-cache"),K.setRequestHeader("cache-control","no-cache")),A.withCredentials===!0&&(K.withCredentials=!0),typeof A.beforeSend=="function"&&A.beforeSend(K),typeof w.beforeSend=="function"&&w.beforeSend(K),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(K),K.onload=function(){if(K.status>=200&&K.status<300)if(A.dataType==="json")try{var oe=JSON.parse(K.responseText);A.success&&typeof A.success=="function"&&A.success(oe)}catch(de){A.error&&typeof A.error=="function"&&A.error(de,oe)}else{if(A.dataType==="blob")var oe=K.response;else var oe=K.responseText;A.success&&typeof A.success=="function"&&A.success(oe)}else A.error&&typeof A.error=="function"&&A.error(K.responseText,K.status);if(w.queue&&w.queue.length>0&&w.send(w.queue.shift()),w.requests&&w.requests.length){var ve=w.requests.indexOf(K);if(w.requests.splice(ve,1),w.requests.length||A.complete&&typeof A.complete=="function"&&A.complete(oe),A.group&&w.oncomplete&&typeof w.oncomplete[A.group]=="function"&&(w.pending(A.group)||(w.oncomplete[A.group](),w.oncomplete[A.group]=null)),A.multiple&&A.multiple.instance){var ve=A.multiple.instance.indexOf(K);A.multiple.instance.splice(ve,1),A.multiple.instance.length||A.multiple.complete&&typeof A.multiple.complete=="function"&&A.multiple.complete(oe)}}},K.options=A,K.data=M,A.queue===!0&&w.requests.length>0?w.queue.push(K):w.send(K),K};return w.send=function(A){A.data?Array.isArray(A.data)?A.send(A.data.join("&")):A.send(A.data):A.send(),w.requests.push(A)},w.exists=function(A,l){var o=new XMLHttpRequest;o.open("HEAD",A,!1),o.send(),o.status&&l(o.status)},w.pending=function(A){var l=0,o=w.requests;if(o&&o.length)for(var k=0;k<o.length;k++)(!A||A==o[k].options.group)&&l++;return l},w.oncomplete={},w.requests=[],w.queue=[],w}var T=C();function I(){const w={loading:{}};return w.loading.show=function(A){w.loading.element||(w.loading.element=document.createElement("div"),w.loading.element.className="jloading"),document.body.appendChild(w.loading.element),A>0&&setTimeout(function(){w.loading.hide()},A*1e3)},w.loading.hide=function(){w.loading.element&&w.loading.element.parentNode&&document.body.removeChild(w.loading.element)},w.slideLeft=function(A,l,o){l==!0?(A.classList.add("slide-left-in"),setTimeout(function(){A.classList.remove("slide-left-in"),typeof o=="function"&&o()},400)):(A.classList.add("slide-left-out"),setTimeout(function(){A.classList.remove("slide-left-out"),typeof o=="function"&&o()},400))},w.slideRight=function(A,l,o){l===!0?(A.classList.add("slide-right-in"),setTimeout(function(){A.classList.remove("slide-right-in"),typeof o=="function"&&o()},400)):(A.classList.add("slide-right-out"),setTimeout(function(){A.classList.remove("slide-right-out"),typeof o=="function"&&o()},400))},w.slideTop=function(A,l,o){l===!0?(A.classList.add("slide-top-in"),setTimeout(function(){A.classList.remove("slide-top-in"),typeof o=="function"&&o()},400)):(A.classList.add("slide-top-out"),setTimeout(function(){A.classList.remove("slide-top-out"),typeof o=="function"&&o()},400))},w.slideBottom=function(A,l,o){l===!0?(A.classList.add("slide-bottom-in"),setTimeout(function(){A.classList.remove("slide-bottom-in"),typeof o=="function"&&o()},400)):(A.classList.add("slide-bottom-out"),setTimeout(function(){A.classList.remove("slide-bottom-out"),typeof o=="function"&&o()},100))},w.fadeIn=function(A,l){A.style.display="",A.classList.add("fade-in"),setTimeout(function(){A.classList.remove("fade-in"),typeof l=="function"&&l()},2e3)},w.fadeOut=function(A,l){A.classList.add("fade-out"),setTimeout(function(){A.style.display="none",A.classList.remove("fade-out"),typeof l=="function"&&l()},1e3)},w}var B=I();function F(){var w={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},A=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var v=0;this.date[4]&&(v=parseFloat(this.date[4]/60));var _=parseInt(this.date[3])+v;_/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?_=d.two(this.date[3])+":"+d.two(this.date[4])+":"+d.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),_=d.two(this.date[0])+"-"+d.two(this.date[1])+"-"+d.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(_+=" "+d.two(this.date[3])+":"+d.two(this.date[4])+":"+d.two(this.date[5])));return _},l=function(){var v="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)v=parseInt(this.date[3]);else{let J=parseInt(this.date[3]);J<13&&this.values.indexOf("PM")!==-1?v=(J+12)%24:v=J%24}this.date[4]&&(v+=parseFloat(this.date[4]/60)),this.date[5]&&(v+=parseFloat(this.date[5]/3600)),v/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var _=b.now(this.date);v=b.dateToNum(_),this.date[4]&&(v+=parseFloat(this.date[4]/60))}return isNaN(v)&&(v=""),v},o=function(v){return v===null||v===""||v===void 0},k=function(v){var _=(""+v)[0];return _=="="},Q=function(v){return v==="currency"||v==="percentage"||v==="numeric"},ee=function(v){if(v&&Number(v)==v)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var _=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=_[1]}else{v||(v=this.mask);var J=new RegExp("0{1}(.{1})0+","ig"),_=J.exec(v);if(_&&_[1]&&_[1].length==1)return this.options.decimal=_[1],_[1];var J=new RegExp("#{1}(.{1})#+","ig"),_=J.exec(v);_&&_[1]&&_[1].length==1?_[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},S=function(v,_){if(v=="")return"";_||(_=ee.call(this)),v=(""+v).split(_);var J=v[0].match(/[-]+/g);if(J&&J.length?J=!0:J=!1,v[0]=v[0].match(/[0-9]+/g),v[0]?(J&&v[0].unshift("-"),v[0]=v[0].join("")):J&&(v[0]="-"),v[0]||v[1])v[1]!==void 0&&(v[1]=v[1].match(/[0-9]+/g),v[1]?v[1]=v[1].join(""):v[1]="");else return"";return v},M=function(v,_){if(v==="")return"";var J=ee.call(this),he=this.options;if(v=S.call(this,v),v==="")return"";var Z=null;if(v[0]&&(he.style==="percent"?Z=parseFloat(v[0])/100:Z=parseFloat(v[0]+".1")),(v[0]==="-"||v[0]==="-00")&&!v[1]&&_&&_.inputType=="deleteContentBackward")return"";var ue=new Intl.NumberFormat(this.locale,he).format(Z);if(ue=ue.split(J),he.style==="percent"&&ue[0].indexOf("%")!==-1&&(ue[0]=ue[0].replace("%",""),ue[2]="%"),typeof ue[1]<"u"){var je=ue[1].replace(/[0-9]*/g,"");je&&(ue[2]=je)}return v[1]!==void 0?ue[1]=J+v[1]:ue[1]="",ue.join("")},V=function(v,_){var J=ve.call(v);if(J){var he=M.call(this,J,_),Z=he.length-J.length,ue=oe.call(v)+Z;ve.call(v,he,ue,!0)}},K=function(v){var _=S.call(this,v);return _?(_[0]==="-"&&(_[0]="-0"),parseFloat(_.join("."))):null},oe=function(v,_){if(v===void 0)if(this.tagName=="DIV"){var J=0,he=window.getSelection();if(he&&he.rangeCount!==0){var Z=he.getRangeAt(0),ue=Z.cloneRange();ue.selectNodeContents(this),ue.setEnd(Z.endContainer,Z.endOffset),J=ue.toString().length}return J}else return this.selectionStart;else{var je=ve.call(this);if(_){for(var ue=null,De=0;De<je.length;De++)(je[De].match(/[\-0-9]/g)||je[De]==="."||je[De]===",")&&(ue=De);ue===null&&(ue=je.indexOf(" ")),v>=ue&&(v=ue+1)}if(v>je.length&&(v=je.length),v)if(this.tagName=="DIV"){var he=window.getSelection(),Z=document.createRange();this.childNodes[0]&&(Z.setStart(this.childNodes[0],v),he.removeAllRanges(),he.addRange(Z))}else this.selectionStart=v,this.selectionEnd=v}},ve=function(v,_,J){if(this.tagName=="DIV")if(v===void 0){var v=this.innerText;return this.value&&this.value.length>v.length&&(v=this.value),v}else this.innerText!==v&&(this.innerText=v,_&&oe.call(this,_,J));else{if(v===void 0)return this.value;this.value!==v&&(this.value=v,_&&oe.call(this,_,J))}},de=b.weekdays,fe=b.weekdaysShort,le=b.months,me=b.monthsShort,Ne={YEAR:function(v,_){var J=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<=10&&this.values[this.index].length<_&&(this.values[this.index]+=v),this.values[this.index].length==_){if(_==2)var J=J.substr(0,2)+this.values[this.index];else if(_==3)var J=J.substr(0,1)+this.values[this.index];else if(_==4)var J=this.values[this.index];this.date[0]=J,this.index++}},YYYY:function(v){Ne.YEAR.call(this,v,4)},YYY:function(v){Ne.YEAR.call(this,v,3)},YY:function(v){Ne.YEAR.call(this,v,2)},FIND:function(v,_){if(o(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=v;return}for(var J=0,he=0,Z=(this.values[this.index]+v).toLowerCase(),ue=0;ue<_.length;ue++)_[ue].toLowerCase().indexOf(Z)==0&&(J=ue,he++);if(he>1)this.values[this.index]+=v;else if(he==1){var je=_[J].length-this.values[this.index].length-1;return this.position+=je,this.values[this.index]=_[J],this.index++,J}},MMM:function(v){var _=Ne.FIND.call(this,v,me);_!==void 0&&(this.date[1]=_+1)},MON:function(v){Ne.MMM.call(this,v)},MMMM:function(v){var _=Ne.FIND.call(this,v,le);_!==void 0&&(this.date[1]=_+1)},MONTH:function(v){Ne.MMMM.call(this,v)},MMMMM:function(v){o(this.values[this.index])&&(this.values[this.index]="");for(var _=(this.values[this.index]+v).toLowerCase(),J=0;J<le.length;J++)if(le[J][0].toLowerCase().indexOf(_)==0){this.values[this.index]=le[J][0],this.date[1]=J+1,this.index++;break}},MM:function(v){o(this.values[this.index])?parseInt(v)>1&&parseInt(v)<10?(this.date[1]=this.values[this.index]="0"+v,this.index++):parseInt(v)<2&&(this.values[this.index]=v):this.values[this.index]==1&&parseInt(v)<3?(this.date[1]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[1]=this.values[this.index]+=v,this.index++)},M:function(v){var _=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(o(this.values[this.index]))this.values[this.index]=v,v>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(v)<3)this.date[1]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[1]=this.values[this.index]+=v,this.index++;else var _=!0;else var _=!0;if(_==!0){var J=parseInt(this.values[this.index]);J>0&&J<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(v){var _=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(o(this.values[this.index]))this.values[this.index]=v,parseInt(v)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(v)<2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[2]=this.values[this.index]+=v,this.index++;else var _=!0;else var _=!0;if(_==!0){var J=parseInt(this.values[this.index]);J>0&&J<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(v){o(this.values[this.index])?parseInt(v)>3&&parseInt(v)<10?(this.date[2]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==3&&parseInt(v)<2?(this.date[2]=this.values[this.index]+=v,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(v)<10?(this.date[2]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[2]=this.values[this.index]+=v,this.index++)},DDD:function(v){Ne.FIND.call(this,v,fe)},DY:function(v){Ne.DDD.call(this,v)},DDDD:function(v){Ne.FIND.call(this,v,de)},DAY:function(v){Ne.DDDD.call(this,v)},HH12:function(v,_){o(this.values[this.index])?parseInt(v)>1&&parseInt(v)<10?(_&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==1&&parseInt(v)<3?(this.date[3]=this.values[this.index]+=v,this.index++):this.values[this.index]<1&&parseInt(v)<10&&(this.date[3]=this.values[this.index]+=v,this.index++)},HH24:function(v,_){parseInt(v)>=0&&parseInt(v)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(v)>2&&parseInt(v)<10?(_&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==2&&parseInt(v)<4?(!_&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++):this.values[this.index]<2&&parseInt(v)<10&&(!_&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++))},HH:function(v){Ne.HH24.call(this,v,1)},H:function(v){Ne.HH24.call(this,v,0)},"\\[H\\]":function(v){this.values[this.index]==null&&(this.values[this.index]=""),v.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=v:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(v,_){this.values[this.index]==null||this.values[this.index]==""?parseInt(v)>5&&parseInt(v)<10?(this.date[_]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):parseInt(v)<10&&(this.date[_]=this.values[this.index]+=v,this.index++)},MI:function(v){Ne.N60.call(this,v,4)},SS:function(v){Ne.N60.call(this,v,5)},"AM/PM":function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?v.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":v.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<7&&(this.values[this.index]=v),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(v){var _=ee.call(this),J=!1;o(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(J=!0);var he=S.call(this,this.values[this.index],_);he&&(this.values[this.index]=he.join(_)),parseInt(v)>=0&&parseInt(v)<10?(this.values[this.index]=="0"&&v>0?this.values[this.index]="":this.values[this.index]=="-0"&&v>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||v==_)&&(this.values[this.index]+=v)):_&&v==_?this.values[this.index].indexOf(_)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=v):v=="-"&&(J=!0),J===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(v){Ne["0{1}(.{1}0+)?"].call(this,v),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(v){Ne["0{1}(.{1}0+)?"].call(this,v);var _=ee.call(this),J=this.tokens[this.index].substr(1,1),he=this.values[this.index][0]==="-",Z=S.call(this,this.values[this.index],_);if(Z!==""){var ue=Z[0].match(/[0-9]/g);if(ue){ue=ue.join("");for(var je=[],De=0,Ce=ue.length-1;Ce>=0;Ce--)je.push(ue[Ce]),De++,De%3||je.push(J);je=je.reverse(),Z[0]=je.join(""),Z[0].substr(0,1)==J&&(Z[0]=Z[0].substr(1))}else Z[0]="";this.values[this.index]=Z.join(_),he&&(this.values[this.index]="-"+this.values[this.index])}},0:function(v){v.match(/[0-9]/g)&&(this.values[this.index]=v,this.index++)},"[0-9a-zA-Z$]+":function(v){o(this.values[this.index])&&(this.values[this.index]="");var _=this.tokens[this.index],J=this.values[this.index],he=J.length;_[he]==v?(this.values[this.index]+=v,this.values[this.index]==_&&this.index++):(this.values[this.index]=_,this.index++,v.match(/[\-0-9]/g)&&this.position--)},A:function(v){v.match(/[a-zA-Z]/gi)&&(this.values[this.index]=v,this.index++)},".":function(v){Ne["[0-9a-zA-Z$]+"].call(this,v)},"@":function(v){o(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=v}},We=function(v){if(this.type=="general")var _=[].concat(w.general);else var _=[].concat(w.currency,w.datetime,w.percentage,w.numeric,w.text,w.general);var J=new RegExp(_.join("|"),"gi");return v.match(J)},Je=function(v){if(this.type)if(this.type=="text")var _=["text"];else if(this.type=="general")var _=["general"];else if(this.type=="datetime")var _=["numeric","datetime","general"];else var _=["currency","percentage","numeric","general"];else var _=Object.keys(w);for(var J=0;J<_.length;J++)for(var he=_[J],Z=0;Z<w[he].length;Z++){var ue=new RegExp(w[he][Z],"gi"),je=v.match(ue);if(je)return{type:he,method:w[he][Z]}}},ce=function(v){for(var _=[],J=0;J<v.length;J++){var he=Je.call(this,v[J]);he?_.push(he.method):_.push(null)}for(var J=0;J<_.length;J++)_[J]=="MM"&&(_[J-1]&&_[J-1].indexOf("H")>=0||_[J-2]&&_[J-2].indexOf("H")>=0||_[J+1]&&_[J+1].indexOf("S")>=0||_[J+2]&&_[J+2].indexOf("S")>=0)&&(_[J]="MI");return _},Ae=function(v){var _=Je.call(this,v);if(_)var J=_.type;if(J){for(var he=0,Z=We.call(this,v),ue=0;ue<Z.length;ue++)_=Je.call(this,Z[ue]),_&&Q(_.type)&&he++;he>1&&(J="general")}return J},X=function(){typeof Ne[this.methods[this.index]]=="function"?(Ne[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},W=function(v){return(""+ +v).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(_,J,he,Z,ue){return ue<0?J+"0."+Array(1-ue-he.length).join(0)+he+Z:J+he+Z+Array(ue-Z.length+1).join(0)})},ne=function(v,_,J){var he=null,Z={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof v=="object"){if(Z.input=v.target,Z.value=ve.call(v.target),Z.caret=oe.call(v.target),(he=v.target.getAttribute("data-mask"))&&(Z.mask=he),(he=v.target.getAttribute("data-type"))&&(Z.type=he),v.target.mask?(v.target.mask.options&&(Z.options=v.target.mask.options),v.target.mask.locale&&(Z.locale=v.target.mask.locale)):(he=v.target.getAttribute("data-locale"))&&(Z.locale=he,Z.mask&&(Z.options.style=Z.mask)),v.target.attributes&&v.target.attributes.length)for(var ue=0;ue<v.target.attributes.length;ue++){var je=v.target.attributes[ue].name,De=v.target.attributes[ue].value;je.substr(0,4)=="data"&&(Z.options[je.substr(5)]=De)}}else{if(typeof _=="string")Z.mask=_;else for(var je=Object.keys(_),ue=0;ue<je.length;ue++)Z[je[ue]]=_[je[ue]];typeof v=="number"&&(ee.call(Z,Z.mask),v=(""+v).replace(".",Z.options.decimal)),Z.value=v,Z.input&&(ve.call(Z.input,v),d.focus(Z.input),Z.caret=oe.call(Z.input))}if(!k(Z.value)&&(Z.mask||Z.locale)){if(Z.mask){if(Z.mask=Z.mask.replace(new RegExp(/\[h]/),"|h|"),Z.mask=Z.mask.replace(new RegExp(/\[.*?\]/),""),Z.mask=Z.mask.replace(new RegExp(/\|h\|/),"[h]"),Z.mask.indexOf(";")!==-1){var he=Z.mask.split(";");Z.mask=he[0]}if(Z.mask.indexOf("##")!==-1){var Ce=Z.mask.split(";");Ce[0]&&(typeof v=="object"&&(Ce[0]=Ce[0].replace(new RegExp(/_\)/g),""),Ce[0]=Ce[0].replace(new RegExp(/_\(/g),"")),Ce[0]=Ce[0].replace("*","	"),Ce[0]=Ce[0].replace(new RegExp(/_-/g),""),Ce[0]=Ce[0].replace(new RegExp(/_/g),""),Ce[0]=Ce[0].replace("##0.###","##0.000"),Ce[0]=Ce[0].replace("##0.##","##0.00"),Ce[0]=Ce[0].replace("##0.#","##0.0"),Ce[0]=Ce[0].replace("##0,###","##0,000"),Ce[0]=Ce[0].replace("##0,##","##0,00"),Ce[0]=Ce[0].replace("##0,#","##0,0")),Z.mask=Ce[0]}if(Z.mask.indexOf("\\")!==-1){var Ce=Z.mask.split(";");Ce[0]=Ce[0].replace(new RegExp(/\\/g),""),Z.mask=Ce[0]}Z.type||(Z.type=Ae.call(Z,Z.mask)),Z.tokens=We.call(Z,Z.mask)}if(typeof v!="object"||!v.inputType||!v.inputType.indexOf("insert")||!v.inputType.indexOf("delete"))if(Z.locale)if(Z.input)V.call(Z,Z.input,v);else var Fe=M.call(Z,Z.value);else{for(Z.methods=ce.call(Z,Z.tokens),Z.event=v;Z.position<Z.value.length&&typeof Z.tokens[Z.index]<"u";)X.call(Z);var Fe=Z.values.join("");if(Q(Z.type)&&Fe!==""){for(;typeof Z.tokens[Z.index]<"u";){var he=Je.call(Z,Z.tokens[Z.index]);he&&he.type=="general"&&(Z.values[Z.index]=Z.tokens[Z.index]),Z.index++}var Ve=!0}else var Ve=!1;if(Fe=Z.values.join(""),Z.input){if(he=Fe.length-Z.value.length,he>0)var Ze=Z.caret+he;else var Ze=Z.caret;ve.call(Z.input,Fe,Ze,Ve)}}if(Z.input){var te=null;if(Q(Z.type)){let be=ve.call(Z.input);Z.number=K.call(Z,be),Z.type=="percentage"&&be.indexOf("%")!==-1?te=ne.adjustPrecision(Z.number/100):te=Z.number}else Z.type=="datetime"&&(te=A.call(Z),Z.date[0]&&Z.date[1]&&Z.date[2]&&Z.input.setAttribute("data-completed",!0));te&&Z.input.setAttribute("data-value",te)}if(Fe!==void 0)return J?Z:Fe}};return ne.adjustPrecision=function(v){if(typeof v=="number"&&!Number.isInteger(v)){const _=v.toString().split(".");if(_[1]&&_[1].length>10){let J=0;const he=_[1][_[1].length-2];if(he==0||he==9){for(let Z=_[1].length-2;Z>0;Z--)if(J>=0&&_[1][Z]==he){if(J++,J>6)break}else{J=0;break}if(J)return parseFloat(parseFloat(v).toFixed(_[1].length-1))}}}return v},ne.getType=Ae,ne.prepare=function(v,_){return _||(_={}),We.call(_,v)},ne.apply=function(v){var _=ve.call(v.target);v.key.length==1&&(_+=v.key),ve.call(v.target,ne(_,v.target.getAttribute("data-mask")))},ne.run=function(v,_,J){return ne(v,{mask:_,decimal:J})},ne.extract=function(v,_,J){if(o(v)||typeof _!="object")return v;if(_=Object.assign({},_),_.options||(_.options={}),!_.mask&&_.format&&(_.mask=_.format),_.mask){if(_.mask.indexOf(";")!==-1){var he=_.mask.split(";");_.mask=he[0]}_.mask=_.mask.replace(new RegExp(/\[h]/),"|h|"),_.mask=_.mask.replace(new RegExp(/\[.*?\]/),""),_.mask=_.mask.replace(new RegExp(/\|h\|/),"[h]")}ee.call(_,_.mask);var Z=null,ue=null;if(_.type=="percent"||_.options.style=="percent"?Z="percentage":_.mask&&(Z=Ae.call(_,_.mask)),Z==="general"){var je=ne(v,_,!0);ue=v}else if(Z==="datetime"){v instanceof Date&&(v=ne.getDateString(v,_.mask));var je=ne(v,_,!0);d.isNumeric(v)?ue=v:ue=l.call(je)}else{ue=K.call(_,v),Z==="percentage"&&v.indexOf("%")!==-1&&(ue/=100);var je=_}return je.value=ue,!je.type&&Z&&(je.type=Z),J?je:ue},ne.render=function(v,_,J){if(o(v)||typeof _!="object")return v;if(_=Object.assign({},_),_.options||(_.options={}),!_.mask&&_.format&&(_.mask=_.format),_.mask){if(_.mask.indexOf(";")!==-1){var he=_.mask.split(";");J||(he[0]=he[0].replace(new RegExp(/_\)/g),""),he[0]=he[0].replace(new RegExp(/_\(/g),"")),_.mask=he[0]}_.mask=_.mask.replace(new RegExp(/\[h]/),"|h|"),_.mask=_.mask.replace(new RegExp(/\[.*?\]/),""),_.mask=_.mask.replace(new RegExp(/\|h\|/),"[h]")}var Z=null;_.type=="percent"||_.options.style=="percent"?Z="percentage":_.mask?Z=Ae.call(_,_.mask):v instanceof Date&&(Z="datetime");var ue=!1;if(Z=="datetime"||_.type=="calendar"){var he=ne.getDateString(v,_.mask);he&&(v=he),_.mask&&J&&(ue=!0)}else if(Z==="percentage"&&(v=ne.adjustPrecision(v*100)),typeof v=="number"){var he=null;if(_.mask&&J&&(""+v).indexOf("e")===-1){var je=ee.call(_,_.mask);if(_.mask.indexOf(je)!==-1){je=_.mask.split(je),je=""+je[1].match(/[0-9]+/g),je=je.length,he=v.toFixed(je);let be=v.toString().split("."),we=be[1];we&&we.length>je&&we[we.length-1]==="5"?he=parseFloat(be[0]+"."+we+"1").toFixed(je):he=v.toFixed(je)}else he=v.toFixed(0)}else if(_.locale&&J){var je=(""+v).split(".");if(_.options){typeof je[1]>"u"&&(je[1]="");var Ce=je[1].length;if(_.options.minimumFractionDigits>Ce)for(var De=0;De<_.options.minimumFractionDigits-Ce;De++)je[1]+="0"}je[1].length?he=je.join("."):he=je[0];var Ce=je[1].length;_.options&&_.options.maximumFractionDigits<Ce&&(he=parseFloat(he).toFixed(_.options.maximumFractionDigits))}else he=W(v);he!==null&&(v=he,ee.call(_,_.mask),_.options.decimal&&(v=v.replace(".",_.options.decimal)))}else _.mask&&J&&(ue=!0);if(ue){var Fe=_.mask.length-v.length;if(Fe>0)for(var De=0;De<Fe;De++)v+=" "}if(v=ne(v,_),J&&Z==="numeric"){var Ve=_.mask.match(new RegExp(/^[0]+$/gm));if(Ve&&Ve.length===1){var Ze=Ve[0].length;if(Ze>3)for(v=""+v;v.length<Ze;)v="0"+v}}return v},ne.set=function(v,_){if(_){v.setAttribute("data-mask",_);var J=new Event("input",{bubbles:!0,cancelable:!0});v.dispatchEvent(J)}},ne.extractDateFromString=function(v,_){var J=ne(v,{mask:_},!0);if(v>0&&Number(v)==v&&(J.values.join("")!==J.value||J.type=="numeric")){var he=new Date(Math.round((v-25569)*86400*1e3));return he.getFullYear()+"-"+d.two(he.getMonth())+"-"+d.two(he.getDate())+" 00:00:00"}var Z=!1;return J.values.length===J.tokens.length&&J.values[J.values.length-1].length>=J.tokens[J.tokens.length-1].length&&(Z=!0),J.date[0]&&J.date[1]&&(J.date[2]||Z)?(J.date[2]||(J.date[2]=1),J.date[0]+"-"+d.two(J.date[1])+"-"+d.two(J.date[2])+" "+d.two(J.date[3])+":"+d.two(J.date[4])+":"+d.two(J.date[5])):""},ne.getDateString=function(v,_){if(!_)var _={};if(_&&typeof _=="object")var J=_.format;else var J=_;if(J||(J="YYYY-MM-DD"),J.indexOf("[h]")>=0){var he=0;if(v&&d.isNumeric(v)&&(he=parseFloat(24*Number(v)),J.indexOf("mm")>=0)){var Z=(""+he).split(".");if(Z[1]){var ue=60*parseFloat("0."+Z[1]);ue=parseFloat(ue.toFixed(2))}else var ue=0;he=parseInt(Z[0])+":"+d.two(ue)}return he}v instanceof Date?v=b.now(v):v&&d.isNumeric(v)&&(v=b.numToDate(v));for(var je=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],De=new RegExp(je.join("|"),"gi"),Ce=J.match(De),Fe=0;Fe<Ce.length;Fe++)Ce[Fe].toUpperCase()=="MM"&&(Ce[Fe-1]&&Ce[Fe-1].toUpperCase().indexOf("H")>=0||Ce[Fe-2]&&Ce[Fe-2].toUpperCase().indexOf("H")>=0||Ce[Fe+1]&&Ce[Fe+1].toUpperCase().indexOf("S")>=0||Ce[Fe+2]&&Ce[Fe+2].toUpperCase().indexOf("S")>=0)&&(Ce[Fe]="mi");var Ve={tokens:Ce};if(v){var ue=""+v,Ze=ue.indexOf("T")!==-1?"T":" ";ue=ue.split(Ze);var Z=0,te=0,be=0;if(ue[1]&&(Z=ue[1].split(":"),te=Z[1]?Z[1]:0,be=Z[2]?Z[2]:0,Z=Z[0]?Z[0]:0),ue=ue[0].split("-"),ue[0]&&ue[1]&&ue[2]&&ue[0]>0&&ue[1]>0&&ue[1]<13&&ue[2]>0&&ue[2]<32){Ve.data=[ue[0],ue[1],ue[2],Z,te,be],Ve.value=[];for(var we=new Date(Ve.data[0],Ve.data[1]-1,Ve.data[2],Ve.data[3],Ve.data[4],Ve.data[5]),He=function(ot){var st=this.tokens[ot],Pe=st.toUpperCase(),Ye=null;Pe==="YYYY"?Ye=this.data[0]:Pe==="YYY"?Ye=this.data[0].substring(1,4):Pe==="YY"?Ye=this.data[0].substring(2,4):Pe==="Y"?Ye=this.data[0].substring(3,4):st==="MON"?Ye=b.months[we.getMonth()].substr(0,3).toUpperCase():st==="mon"?Ye=b.months[we.getMonth()].substr(0,3).toLowerCase():st==="MONTH"?Ye=b.months[we.getMonth()].toUpperCase():st==="month"?Ye=b.months[we.getMonth()].toLowerCase():Pe==="MMMMM"?Ye=b.months[we.getMonth()].substr(0,1):Pe==="MMMM"||st==="Month"?Ye=b.months[we.getMonth()]:Pe==="MMM"||st=="Mon"?Ye=b.months[we.getMonth()].substr(0,3):Pe==="MM"?Ye=d.two(this.data[1]):Pe==="M"?Ye=we.getMonth()+1:st==="DAY"?Ye=b.weekdays[we.getDay()].toUpperCase():st==="day"?Ye=b.weekdays[we.getDay()].toLowerCase():Pe==="DDDD"||st=="Day"?Ye=b.weekdays[we.getDay()]:Pe==="DDD"?Ye=b.weekdays[we.getDay()].substr(0,3):Pe==="DD"?Ye=d.two(this.data[2]):Pe==="D"?Ye=parseInt(this.data[2]):Pe==="Q"?Ye=Math.floor((we.getMonth()+3)/3):Pe==="HH24"||Pe==="HH"?(Ye=this.data[3],Ye>12&&this.tokens.indexOf("am/pm")!==-1&&(Ye-=12),Ye=d.two(Ye)):Pe==="HH12"?this.data[3]>12?Ye=d.two(this.data[3]-12):Ye=d.two(this.data[3]):Pe==="H"?(Ye=this.data[3],Ye>12&&this.tokens.indexOf("am/pm")!==-1&&(Ye-=12,Ye=d.two(Ye))):Pe==="MI"?Ye=d.two(this.data[4]):Pe==="SS"?Ye=d.two(this.data[5]):Pe==="MS"?Ye=we.getMilliseconds():Pe==="AM/PM"?this.data[3]>=12?Ye="PM":Ye="AM":Pe==="WD"&&(Ye=b.weekdays[we.getDay()]),Ye===null?this.value[ot]=this.tokens[ot]:this.value[ot]=Ye},Fe=0;Fe<Ve.tokens.length;Fe++)He.call(Ve,Fe);v=Ve.value.join("")}else v=""}return v},ne}var N=F();function O(){var w=function(A,l){if(A.calendar)return A.calendar.setOptions(l,!0);var o={type:"calendar"};o.options={},o.date=null,o.setOptions=function(W,ne){var v={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:b.monthsShort,monthsFull:b.months,weekdays:b.weekdays,textDone:g.translate("Done"),textReset:g.translate("Reset"),textUpdate:g.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var _ in v)W&&W.hasOwnProperty(_)?o.options[_]=W[_]:(typeof o.options[_]>"u"||ne===!0)&&(o.options[_]=v[_]);if(o.options.resetButton==!1?M.style.display="none":M.style.display="",o.options.readonly?A.setAttribute("readonly","readonly"):A.removeAttribute("readonly"),o.options.placeholder?A.setAttribute("placeholder",o.options.placeholder):A.removeAttribute("placeholder"),d.isNumeric(o.options.value)&&o.options.value>0&&(o.options.value=w.numToDate(o.options.value),o.options.dataType="numeric"),M.innerHTML=o.options.textReset,V.innerHTML=o.options.textDone,Je.innerHTML=o.options.textUpdate,A.setAttribute("data-mask",o.options.format.toLowerCase()),!o.options.value&&o.options.today)var J=w.now();else var J=o.options.value;return J&&(o.options.value=null,o.setValue(J)),o},o.open=function(W){if(!S.classList.contains("jcalendar-focus")&&!S.classList.contains("jcalendar-inline")){if(w.current=o,u(o,!0),o.getDays(),o.options.type=="year-month-picker"&&o.getMonths(),o.options.time&&(ce.value=o.date[3],Ae.value=o.date[4]),S.classList.add("jcalendar-focus"),d.getWindowWidth()<800||o.options.fullscreen)S.classList.add("jcalendar-fullsize"),B.slideBottom(oe,1);else{S.classList.remove("jcalendar-fullsize");var ne=A.getBoundingClientRect(),v=oe.getBoundingClientRect();if(o.options.position)K.style.position="fixed",window.innerHeight<ne.bottom+v.height?K.style.top=ne.top-(v.height+2)+"px":K.style.top=ne.top+ne.height+2+"px",K.style.left=ne.left+"px";else{if(window.innerHeight<ne.bottom+v.height){var _=-1*(ne.height+v.height+2);_+ne.top<0&&(_=-1*(ne.top+ne.height)),K.style.top=_+"px"}else K.style.top="2px";if(window.innerWidth<ne.left+v.width){var _=window.innerWidth-(ne.left+v.width+20);K.style.left=_+"px"}else K.style.left="0px"}}typeof o.options.onopen=="function"&&o.options.onopen(A)}},o.close=function(W,ne){if(o.options.autoSelect!==!0&&typeof ne>"u"&&(ne=!1),S.classList.contains("jcalendar-focus")){if(ne!==!1){var v=S.querySelector(".jcalendar-selected");if(typeof ne=="string")var _=ne;else if(!v||v.classList.contains("jcalendar-disabled"))var _=o.options.value;else var _=o.getValue();o.setValue(_)}else if(o.options.value){let J=o.options.value;o.options.value="",o.setValue(J)}!W&&typeof o.options.onclose=="function"&&o.options.onclose(A),S.classList.remove("jcalendar-focus"),u(o,!1),w.current=null}return o.options.value},o.prev=function(){o.options.mode=="years"?(o.date[0]=o.date[0]-12,o.getYears()):o.options.mode=="months"?(o.date[0]=parseInt(o.date[0])-1,o.getMonths()):(o.date[1]<2?(o.date[0]=o.date[0]-1,o.date[1]=12):o.date[1]=o.date[1]-1,o.getDays())},o.next=function(){o.options.mode=="years"?(o.date[0]=parseInt(o.date[0])+12,o.getYears()):o.options.mode=="months"?(o.date[0]=parseInt(o.date[0])+1,o.getMonths()):(o.date[1]>11?(o.date[0]=parseInt(o.date[0])+1,o.date[1]=1):o.date[1]=parseInt(o.date[1])+1,o.getDays())},o.setToday=function(){var W=new Date().toISOString().substr(0,10);return o.setValue(W),W},o.setValue=function(W){W||(W=""+W);var ne=W,v=o.options.value;if(v!=ne){if(ne){o.setLabel(ne,o.options);var J=ne.split(" ");J[1]||(J[1]="00:00:00");var _=J[1].split(":"),J=J[0].split("-"),he=parseInt(J[0]),Z=parseInt(J[1]),ue=parseInt(J[2]),je=parseInt(_[0]),De=parseInt(_[1]);o.date=[he,Z,ue,je,De,0];var W=o.setLabel(ne,o.options),Ce=w.now(new Date(he,Z-1,ue),!0);if(o.options.validRange){if(!o.options.validRange[0]||Ce>=o.options.validRange[0])var Fe=!0;else var Fe=!1;if(!o.options.validRange[1]||Ce<=o.options.validRange[1])var Ve=!0;else var Ve=!1;Fe&&Ve?(A.classList.remove("jcalendar_warning"),A.title=""):(A.classList.add("jcalendar_warning"),A.title=g.translate("Date outside the valid range"))}else A.classList.remove("jcalendar_warning"),A.title=""}else{o.date=null;var W="";A.classList.remove("jcalendar_warning"),A.title=""}o.options.value=ne,typeof o.options.onchange=="function"&&o.options.onchange(A,ne,v),A.value!=W&&(A.value=W,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))}o.getDays(),o.options.type=="year-month-picker"&&o.getMonths()},o.getValue=function(){return o.date?o.options.time?d.two(o.date[0])+"-"+d.two(o.date[1])+"-"+d.two(o.date[2])+" "+d.two(o.date[3])+":"+d.two(o.date[4])+":"+d.two(0):d.two(o.date[0])+"-"+d.two(o.date[1])+"-"+d.two(o.date[2])+" "+d.two(0)+":"+d.two(0)+":"+d.two(0):""},o.update=function(W,ne){if(!W.classList.contains("jcalendar-disabled")){var v=S.querySelector(".jcalendar-selected");v&&v.classList.remove("jcalendar-selected"),W.classList.add("jcalendar-selected"),W.classList.contains("jcalendar-set-month")?(o.date[1]=ne,o.date[2]=1):o.date[2]=W.innerText,o.options.time?(o.date[3]=ce.value,o.date[4]=Ae.value):o.close(null,!0)}ee()},o.reset=function(){o.setValue(""),o.date=null,o.close(!1,!1)},o.getDays=function(){o.options.mode="days";var je=new Date,W=o.date&&d.isNumeric(o.date[0])?o.date[0]:parseInt(je.getFullYear()),ne=o.date&&d.isNumeric(o.date[1])?o.date[1]:parseInt(je.getMonth())+1,v=o.date&&d.isNumeric(o.date[2])?o.date[2]:parseInt(je.getDate()),_=o.date&&d.isNumeric(o.date[3])?o.date[3]:parseInt(je.getHours()),J=o.date&&d.isNumeric(o.date[4])?o.date[4]:parseInt(je.getMinutes());o.date=[W,ne,v,_,J,0],ve.innerHTML=W,de.innerHTML=o.options.months[ne-1];var he=je.getMonth()==ne-1&&je.getFullYear()==W,Z=je.getDate(),je=new Date(W,ne,0,0,0),ue=je.getDate(),je=new Date(W,ne-1,0,0,0),De=je.getDay()+1,Ze=o.options.startingDay||0;De=De-Ze,le.innerHTML="";var Ce=document.createElement("tr");Ce.setAttribute("align","center"),le.appendChild(Ce);for(var Fe=0;Fe<7;Fe++){var Ve=document.createElement("td");Ve.classList.add("jcalendar-weekday"),Ve.innerHTML=o.options.weekdays[Ze].substr(0,1),Ce.appendChild(Ve),Ze++,Ze>6&&(Ze=0)}for(var Ze=0,te=0,be=0;be<6;be++){var Ce=document.createElement("tr");Ce.setAttribute("align","center"),Ce.style.height="34px";for(var Fe=0;Fe<7;Fe++){var Ve=document.createElement("td");if(Ve.classList.add("jcalendar-set-day"),Ze>=De&&Ze<De+ue){te++,Ve.innerHTML=te,te==v&&Ve.classList.add("jcalendar-selected"),he&&Z==te&&(Ve.style.fontWeight="bold");var we=w.now(new Date(W,ne-1,te),!0);if(o.options.validRange){if(!o.options.validRange[0]||we>=o.options.validRange[0])var He=!0;else var He=!1;if(!o.options.validRange[1]||we<=o.options.validRange[1])var tt=!0;else var tt=!1;He&&tt||Ve.classList.add("jcalendar-disabled")}}Ce.appendChild(Ve),Ze++}le.appendChild(Ce)}o.options.time?Ne.style.display="":Ne.style.display="none",ee()},o.getMonths=function(){o.options.mode="months";var W=o.options.months;o.options.value;var ne=new Date,v=parseInt(ne.getFullYear()),_=parseInt(ne.getMonth())+1,J=o.date&&d.isNumeric(o.date[0])?o.date[0]:v,he=o.date&&d.isNumeric(o.date[1])?o.date[1]:_;ve.innerHTML=o.date[0],de.innerHTML=W[he-1];var Z=document.createElement("table");Z.setAttribute("width","100%");for(var ue=null,je=0;je<12;je++){if(!(je%4)){var ue=document.createElement("tr");ue.setAttribute("align","center"),Z.appendChild(ue)}var De=document.createElement("td");if(De.classList.add("jcalendar-set-month"),De.setAttribute("data-value",je+1),De.innerText=W[je],o.options.validRange){var Ce=J+"-"+d.two(je+1);if(!o.options.validRange[0]||Ce>=o.options.validRange[0].substr(0,7))var Fe=!0;else var Fe=!1;if(!o.options.validRange[1]||Ce<=o.options.validRange[1].substr(0,7))var Ve=!0;else var Ve=!1;Fe&&Ve||De.classList.add("jcalendar-disabled")}je+1==he&&De.classList.add("jcalendar-selected"),v==J&&je+1==_&&(De.style.fontWeight="bold"),ue.appendChild(De)}le.innerHTML='<tr><td colspan="7"></td></tr>',le.children[0].children[0].appendChild(Z),ee()},o.getYears=function(){o.options.mode="years";for(var W=new Date,ne=W.getFullYear(),v=o.date&&d.isNumeric(o.date[0])?o.date[0]:parseInt(W.getFullYear()),_=[],J=0;J<25;J++)_[J]=parseInt(o.date[0])+(J-12);var he=document.createElement("table");he.setAttribute("width","100%");for(var J=0;J<25;J++){if(!(J%5)){var Z=document.createElement("tr");Z.setAttribute("align","center"),he.appendChild(Z)}var ue=document.createElement("td");ue.classList.add("jcalendar-set-year"),ue.innerText=_[J],v==_[J]&&ue.classList.add("jcalendar-selected"),ne==_[J]&&(ue.style.fontWeight="bold"),Z.appendChild(ue)}le.innerHTML='<tr><td colspan="7"></td></tr>',le.firstChild.firstChild.appendChild(he),ee()},o.setLabel=function(W,ne){return w.getDateString(W,ne)},o.fromFormatted=function(W,ne){return w.extractDateFromString(W,ne)};var k=function(W){var ne=d.findElement(W.target,"jcalendar-container");if(ne){var v=W.target.className;if(v=="jcalendar-prev")o.prev();else if(v=="jcalendar-next")o.next();else if(v=="jcalendar-month")o.getMonths();else if(v=="jcalendar-year")o.getYears();else if(v=="jcalendar-set-year")o.date[0]=W.target.innerText,o.options.type=="year-month-picker"?o.getMonths():o.getDays();else if(W.target.classList.contains("jcalendar-set-month")){var _=parseInt(W.target.getAttribute("data-value"));o.options.type=="year-month-picker"?o.update(W.target,_):(o.date[1]=_,o.getDays())}else v=="jcalendar-confirm"||v=="jcalendar-update"||v=="jcalendar-close"?o.close(null,!0):v=="jcalendar-backdrop"?o.close(!1,!1):v=="jcalendar-reset"?o.reset():W.target.classList.contains("jcalendar-set-day")&&W.target.innerText&&o.update(W.target)}else o.close(!1,!1)},Q=function(W){if(W.target.value&&W.target.value.length>3){var ne=w.extractDateFromString(W.target.value,o.options.format);ne&&o.setValue(ne)}},ee=function(){var W=S.querySelector(".jcalendar-selected");W&&W.classList.contains("jcalendar-disabled")?(Je.setAttribute("disabled","disabled"),ce.setAttribute("disabled","disabled"),Ae.setAttribute("disabled","disabled")):(Je.removeAttribute("disabled"),ce.removeAttribute("disabled"),Ae.removeAttribute("disabled")),typeof o.options.onupdate=="function"&&o.options.onupdate(A,o.getValue())},S=null,M=null,V=null,K=null,oe=null,ve=null,de=null,fe=null,le=null,me=null,Ne=null,We=null,Je=null,ce=null,Ae=null,X=function(){A.tagName=="INPUT"&&A.value&&(l.value=A.value),M=document.createElement("div"),M.className="jcalendar-reset",V=document.createElement("div"),V.className="jcalendar-confirm",me=document.createElement("div"),me.className="jcalendar-controls",me.style.borderBottom="1px solid #ddd",me.appendChild(M),me.appendChild(V),K=document.createElement("div"),K.className="jcalendar-container",oe=document.createElement("div"),oe.className="jcalendar-content",K.appendChild(oe),A.tagName=="DIV"?(S=A,S.classList.add("jcalendar-inline")):(oe.appendChild(me),S=document.createElement("div"),S.className="jcalendar"),S.classList.add("jcalendar-container"),S.appendChild(K);var W=document.createElement("div");W.className="jcalendar-table",oe.appendChild(W);var ne=document.createElement("td");ne.setAttribute("colspan","2"),ne.className="jcalendar-prev",ve=document.createElement("span"),ve.className="jcalendar-year",de=document.createElement("span"),de.className="jcalendar-month";var v=document.createElement("td");v.className="jcalendar-header",v.setAttribute("colspan","3"),v.appendChild(de),v.appendChild(ve);var _=document.createElement("td");_.setAttribute("colspan","2"),_.className="jcalendar-next";var J=document.createElement("thead"),he=document.createElement("tr");he.appendChild(ne),he.appendChild(v),he.appendChild(_),J.appendChild(he),fe=document.createElement("table"),le=document.createElement("tbody"),fe.setAttribute("cellpadding","0"),fe.setAttribute("cellspacing","0"),fe.appendChild(J),fe.appendChild(le),W.appendChild(fe),ce=document.createElement("select"),ce.className="jcalendar-select",ce.onchange=function(){o.date[3]=this.value,typeof o.options.onupdate=="function"&&o.options.onupdate(A,o.getValue())};for(var Z=0;Z<24;Z++){var ue=document.createElement("option");ue.value=Z,ue.innerHTML=d.two(Z),ce.appendChild(ue)}Ae=document.createElement("select"),Ae.className="jcalendar-select",Ae.onchange=function(){o.date[4]=this.value,typeof o.options.onupdate=="function"&&o.options.onupdate(A,o.getValue())};for(var Z=0;Z<60;Z++){var ue=document.createElement("option");ue.value=Z,ue.innerHTML=d.two(Z),Ae.appendChild(ue)}var je=document.createElement("div");je.className="jcalendar-controls",Ne=document.createElement("div"),Ne.className="jcalendar-time",Ne.style.maxWidth="140px",Ne.appendChild(ce),Ne.appendChild(Ae),Je=document.createElement("button"),Je.setAttribute("type","button"),Je.className="jcalendar-update",We=document.createElement("div"),We.style.flexGrow="10",We.appendChild(Je),je.appendChild(Ne),A.tagName=="INPUT"&&je.appendChild(We),oe.appendChild(je);var De=document.createElement("div");De.className="jcalendar-backdrop",S.appendChild(De),A.addEventListener("keyup",Q),S.addEventListener("swipeleft",function(Ce){B.slideLeft(fe,0,function(){o.next(),B.slideRight(fe,1)}),Ce.preventDefault(),Ce.stopPropagation()}),S.addEventListener("swiperight",function(Ce){B.slideRight(fe,0,function(){o.prev(),B.slideLeft(fe,1)}),Ce.preventDefault(),Ce.stopPropagation()}),"ontouchend"in document.documentElement?(S.addEventListener("touchend",k),A.addEventListener("touchend",o.open)):(S.addEventListener("mouseup",k),A.addEventListener("mouseup",o.open)),w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),o.setOptions(l),A.tagName=="INPUT"?(A.parentNode.insertBefore(S,A.nextSibling),A.setAttribute("autocomplete","off"),A.classList.add("jcalendar-input"),A.value=o.setLabel(o.getValue(),o.options)):(o.getDays(),o.options.time&&(ce.value=o.date[3],Ae.value=o.date[4])),o.options.opened==!0&&o.open(),o.options.controls==!1&&K.classList.add("jcalendar-hide-controls"),A.change=o.setValue,A.val=function(Ce){if(Ce===void 0)return o.getValue();o.setValue(Ce)},A.calendar=S.calendar=o};return X(),o};return w.keydown=function(A){var l=null;(l=w.current)&&(A.which==13?l.close(!1,!0):A.which==27&&l.close(!1,!1))},w.prettify=function(A,l){if(!l)var l={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};A.indexOf("GMT")===-1&&A.indexOf("Z")===-1&&(A+=" GMT");var o=new Date,k=new Date(A),Q=parseInt((o-k)/1e3/60);if(String.prototype.format=function(S){return this.replace("{0}",S)},Q==0)var ee=l.justNow;else if(Q<90)var ee=l.xMinutesAgo.format(Q);else if(Q<1440)var ee=l.xHoursAgo.format(Math.round(Q/60));else if(Q<20160)var ee=l.xDaysAgo.format(Math.round(Q/1440));else if(Q<43200)var ee=l.xWeeksAgo.format(Math.round(Q/10080));else if(Q<1036800)var ee=l.xMonthsAgo.format(Math.round(Q/43200));else var ee=l.xYearsAgo.format(Math.round(Q/525600));return ee},w.prettifyAll=function(){for(var A=document.querySelectorAll(".prettydate"),l=0;l<A.length;l++)A[l].getAttribute("data-date")?A[l].innerHTML=w.prettify(A[l].getAttribute("data-date")):A[l].innerHTML&&(A[l].setAttribute("title",A[l].innerHTML),A[l].setAttribute("data-date",A[l].innerHTML),A[l].innerHTML=w.prettify(A[l].innerHTML))},w.now=b.now,w.toArray=b.toArray,w.dateToNum=b.dateToNum,w.numToDate=b.numToDate,w.weekdays=b.weekdays,w.months=b.months,w.weekdaysShort=b.weekdaysShort,w.monthsShort=b.monthsShort,w.extractDateFromString=N.extractDateFromString,w.getDateString=N.getDateString,w}var G=O();function q(){var w={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},A=function(l){return w[l]?w[l]:w.material};return A.get=function(l){return w[l]?w[l]:w},A.set=function(l,o){w[l]=o},A}var se=q();function ge(w,A){var l={};l.options={};var o={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var k in o)A&&A.hasOwnProperty(k)?l.options[k]=A[k]:l.options[k]=o[k];w.classList.add("jtabs");var Q=null,ee=null,S=null,M=function(de){if(l.options.animation){var fe=l.headers.children[de].getBoundingClientRect();l.options.palette==="modern"?(S.style.width=fe.width-4+"px",S.style.left=l.headers.children[de].offsetLeft+2+"px"):(S.style.width=fe.width+"px",S.style.left=l.headers.children[de].offsetLeft+"px"),l.options.position==="bottom"?S.style.top="0px":S.style.bottom="0px"}},V=function(de){typeof l.headers.scrollTo=="function"?l.headers.scrollTo({left:de,behavior:"smooth"}):l.headers.scrollLeft=de,de<=1?Q.classList.add("disabled"):Q.classList.remove("disabled"),de>=l.headers.scrollWidth-l.headers.offsetWidth?ee.classList.add("disabled"):ee.classList.remove("disabled"),l.headers.scrollWidth<=l.headers.offsetWidth?(Q.style.display="none",ee.style.display="none"):(Q.style.display="",ee.style.display="")};if(l.setBorder=M,l.open=function(de){for(var fe=null,le=0;le<l.headers.children.length;le++)l.headers.children[le].classList.contains("jtabs-selected")&&(fe=le),l.headers.children[le].classList.remove("jtabs-selected"),l.content.children[le]&&l.content.children[le].classList.remove("jtabs-selected");if(l.headers.children[de].classList.add("jtabs-selected"),l.content.children[de]&&l.content.children[de].classList.add("jtabs-selected"),fe!=de&&typeof l.options.onchange=="function"&&l.content.children[de]&&l.options.onchange(w,l,de,l.headers.children[de],l.content.children[de]),l.options.hideHeaders==!0&&l.headers.children.length<3&&l.options.allowCreate==!1)l.headers.parentNode.style.display="none";else{M(de),l.headers.parentNode.style.display="";var me=l.headers.children[de].offsetLeft,Ne=me+l.headers.children[de].offsetWidth,We=l.headers.scrollLeft,Je=We+l.headers.offsetWidth;We<=me&&Je>=Ne||V(me-1)}},l.selectIndex=function(de){var fe=Array.prototype.indexOf.call(l.headers.children,de);return fe>=0&&l.open(fe),fe},l.rename=function(de,fe){fe||(fe=prompt("New title",l.headers.children[de].innerText)),l.headers.children[de].innerText=fe,l.open(de)},l.create=function(de,fe){if(typeof l.options.onbeforecreate=="function"){var le=l.options.onbeforecreate(w);if(le===!1)return!1;de=le}var me=l.appendElement(de);return typeof l.options.oncreate=="function"&&l.options.oncreate(w,me),M(),me},l.remove=function(de){return l.deleteElement(de)},l.nextNumber=function(){for(var de=0,fe=0;fe<l.headers.children.length;fe++){var le=l.headers.children[fe].innerText.match(/[0-9].*/);le>de&&(de=parseInt(le))}return de?de++:de=1,de},l.deleteElement=function(de){if(l.headers.children[de])l.headers.removeChild(l.headers.children[de]),l.content.removeChild(l.content.children[de]);else return!1;l.open(0),typeof l.options.ondelete=="function"&&l.options.ondelete(w,de)},l.appendElement=function(de,fe,le){if(!de)var de=prompt("Title?","");if(de){var me=document.createElement("div");l.content.appendChild(me);var Ne=document.createElement("div");return Ne.innerHTML=de,Ne.content=me,l.headers.insertBefore(Ne,l.headers.lastChild),l.options.allowChangePosition&&Ne.setAttribute("draggable","true"),le!==!1&&l.selectIndex(Ne),typeof fe=="function"&&fe(me,Ne),me}},l.getActive=function(){for(var de=0;de<l.headers.children.length;de++)if(l.headers.children[de].classList.contains("jtabs-selected"))return de;return 0},l.updateContent=function(de,fe){if(typeof fe!="string")var le=fe;else{var le=document.createElement("div");le.innerHTML=fe}l.content.children[de].classList.contains("jtabs-selected")&&fe.classList.add("jtabs-selected"),l.content.replaceChild(fe,l.content.children[de]),M()},l.updatePosition=function(de,fe,le,me){if(de>fe?l.content.insertBefore(l.content.children[de],l.content.children[fe]):l.content.insertBefore(l.content.children[de],l.content.children[fe].nextSibling),me!==!1)l.open(fe);else{const Ne=l.getActive();fe<Ne&&l.setBorder(Ne)}!le&&typeof l.options.onchangeposition=="function"&&l.options.onchangeposition(l.headers,de,fe)},l.move=function(de,fe,le,me){de>fe?l.headers.insertBefore(l.headers.children[de],l.headers.children[fe]):l.headers.insertBefore(l.headers.children[de],l.headers.children[fe].nextSibling),l.updatePosition(de,fe,le,me)},l.setBorder=M,l.init=function(){w.innerHTML="",l.headers=document.createElement("div"),l.content=document.createElement("div"),l.headers.classList.add("jtabs-headers"),l.content.classList.add("jtabs-content"),l.options.palette?w.classList.add("jtabs-modern"):w.classList.remove("jtabs-modern"),l.options.padding&&(l.content.style.padding=parseInt(l.options.padding)+"px");var de=document.createElement("div");de.className="jtabs-headers-container",de.appendChild(l.headers),l.options.maxWidth&&(de.style.maxWidth=parseInt(l.options.maxWidth)+"px");var fe=document.createElement("div");if(fe.className="jtabs-controls",fe.setAttribute("draggable","false"),de.appendChild(fe),l.options.position=="bottom"?(w.appendChild(l.content),w.appendChild(de)):(w.appendChild(de),w.appendChild(l.content)),l.options.allowCreate==!0){var le=document.createElement("div");le.className="jtabs-add",le.onclick=function(){l.create()},fe.appendChild(le)}Q=document.createElement("div"),Q.className="jtabs-prev",Q.onclick=function(){V(l.headers.scrollLeft-l.headers.offsetWidth)},fe.appendChild(Q),ee=document.createElement("div"),ee.className="jtabs-next",ee.onclick=function(){V(l.headers.scrollLeft+l.headers.offsetWidth)},fe.appendChild(ee);for(var me=0;me<l.options.data.length;me++){if(l.options.data[me].titleElement)var Ne=l.options.data[me].titleElement;else var Ne=document.createElement("div");if(l.options.data[me].icon){var We=document.createElement("div"),Je=document.createElement("i");Je.classList.add("material-icons"),Je.innerHTML=l.options.data[me].icon,We.appendChild(Je),Ne.appendChild(We)}if(l.options.data[me].title){var ce=document.createTextNode(l.options.data[me].title);Ne.appendChild(ce)}if(l.options.data[me].width&&(Ne.style.width=l.options.data[me].width),l.options.data[me].contentElement)var Ae=l.options.data[me].contentElement;else{var Ae=document.createElement("div");Ae.innerHTML=l.options.data[me].content}l.headers.appendChild(Ne),l.content.appendChild(Ae)}S=document.createElement("div"),S.className="jtabs-border",l.headers.appendChild(S),l.options.animation&&w.classList.add("jtabs-animation"),l.headers.addEventListener("click",function(X){if(X.target.parentNode.classList.contains("jtabs-headers"))var W=X.target;else if(X.target.tagName=="I")var W=X.target.parentNode.parentNode;else var W=X.target.parentNode;var ne=l.selectIndex(W);typeof l.options.onclick=="function"&&l.options.onclick(w,l,ne,l.headers.children[ne],l.content.children[ne])}),l.headers.addEventListener("contextmenu",function(X){l.selectIndex(X.target)}),l.headers.children.length&&l.open(0),V(0),l.options.allowChangePosition==!0&&j(l.headers,{direction:1,ondrop:function(X,W,ne){l.updatePosition(W,ne)}}),typeof l.options.onload=="function"&&l.options.onload(w,l)},w.children[0]&&w.children[0].children.length)for(var K=0;K<w.children[0].children.length;K++){var oe=l.options.data&&l.options.data[K]?l.options.data[K]:{};w.children[1]&&w.children[1].children[K]?(oe.titleElement=w.children[0].children[K],oe.contentElement=w.children[1].children[K]):oe.contentElement=w.children[0].children[K],l.options.data[K]=oe}var ve=!1;if(l.options.data)for(var K=0;K<l.options.data.length;K++)l.options.data[K].url&&(T({url:l.options.data[K].url,type:"GET",dataType:"text/html",index:K,success:function(fe){l.options.data[this.index].content=fe},complete:function(){l.init()}}),ve=!0);return ve||l.init(),w.tabs=l,l}function ie(w,A){if(w.color)return w.color.setOptions(A,!0);var l={type:"color"};l.options={};var o=null,k=null,Q=null,ee=null,S=null,M=null,V=null;l.setOptions=function(v,_){var J={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};v||(v={}),v&&!v.palette&&(v.palette=se());for(var he in J)v&&v.hasOwnProperty(he)?l.options[he]=v[he]:(typeof l.options[he]>"u"||_===!0)&&(l.options[he]=J[he]);return ee&&(ee.innerHTML=l.options.resetLabel),S&&(S.innerHTML=l.options.doneLabel),l.options.palette&&V&&V.updateContent(0,fe()),typeof l.options.value=="string"&&(w.value=l.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value)),l.options.placeholder?w.setAttribute("placeholder",l.options.placeholder):w.getAttribute("placeholder")&&w.removeAttribute("placeholder"),l},l.select=function(v){var _=o.querySelector(".jcolor-selected");_&&_.classList.remove("jcolor-selected"),l.values[v]&&l.values[v].classList.add("jcolor-selected"),l.options.value=v},l.open=function(){if(!o.classList.contains("jcolor-focus")){u(l,!0),o.classList.add("jcolor-focus"),l.options.value&&l.select(l.options.value),Q.style.marginTop="",Q.style.marginLeft="";var v=Q.getBoundingClientRect(),_=d.getWindowWidth(),J=d.getWindowHeight();if(_<800||l.options.fullscreen==!0?(Q.classList.add("jcolor-fullscreen"),B.slideBottom(Q,1),k.style.display="block"):(Q.classList.contains("jcolor-fullscreen")&&(Q.classList.remove("jcolor-fullscreen"),k.style.display=""),l.options.position?Q.style.position="fixed":Q.style.position="",v.left+v.width>_&&(Q.style.marginLeft=-1*(v.left+v.width-(_-20))+"px"),v.top+v.height>J&&(Q.style.marginTop=-1*(v.top+v.height-(J-20))+"px")),typeof l.options.onopen=="function"&&l.options.onopen(w,l),V.setBorder(V.getActive()),l.options.value){var he=de(l.options.value);Ae.forEach(function(Z,ue){Z.value=he[ue],Z.dispatchEvent(new Event("input"))})}}},l.close=function(v){return o.classList.contains("jcolor-focus")&&(o.classList.remove("jcolor-focus"),k.style.display="",!v&&typeof l.options.onclose=="function"&&l.options.onclose(w,l),u(l,!1)),l.options.value},l.setValue=function(v){v||(v=""),v!=l.options.value&&(l.options.value=v,ce=v,l.select(v),typeof l.options.onchange=="function"&&l.options.onchange(w,v,l),w.value!=l.options.value&&(w.value=l.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value),typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),l.options.closeOnChange==!0&&l.close())},l.getValue=function(){return l.options.value};var K=function(v){var _=v.toString(16);return _.length===1?"0"+_:_},oe=function(v,_,J){return"#"+K(v)+K(_)+K(J)},ve=function(v){return parseInt("0x"+v)},de=function(v){return[ve(v.substr(1,2)),ve(v.substr(3,2)),ve(v.substr(5,2))]},fe=function(){var v=document.createElement("div");v.className="jcolor-grid",l.values=[];var _=document.createElement("table");_.setAttribute("cellpadding","7"),_.setAttribute("cellspacing","0");for(var J=0;J<l.options.palette.length;J++){for(var he=document.createElement("tr"),Z=0;Z<l.options.palette[J].length;Z++){var ue=document.createElement("td"),je=l.options.palette[J][Z];je.length<7&&je.substr(0,1)!=="#"&&(je="#"+je),ue.style.backgroundColor=je,ue.setAttribute("data-value",je),ue.innerHTML="",he.appendChild(ue),l.options.value==je&&ue.classList.add("jcolor-selected"),l.values[je]=ue}_.appendChild(he)}return v.appendChild(_),v},le=document.createElement("canvas");le.width=200,le.height=160;var me=le.getContext("2d"),Ne=function(){var v=M.firstChild.getBoundingClientRect();le.width=v.width-14,We()},We=function(){var v=me.createLinearGradient(0,0,le.width,0);v.addColorStop(0,"rgb(255,0,0)"),v.addColorStop(.15,"rgb(255,0,255)"),v.addColorStop(.33,"rgb(0,0,255)"),v.addColorStop(.49,"rgb(0,255,255)"),v.addColorStop(.67,"rgb(0,255,0)"),v.addColorStop(.84,"rgb(255,255,0)"),v.addColorStop(1,"rgb(255,0,0)"),me.fillStyle=v,me.fillRect(0,0,le.width,le.height),v=me.createLinearGradient(0,0,0,le.height),v.addColorStop(0,"rgba(255,255,255,1)"),v.addColorStop(.5,"rgba(255,255,255,0)"),v.addColorStop(.5,"rgba(0,0,0,0)"),v.addColorStop(1,"rgba(0,0,0,1)"),me.fillStyle=v,me.fillRect(0,0,le.width,le.height)},Je=function(){var v=document.createElement("div");v.className="jcolor-hsl";var _=document.createElement("div");_.className="jcolor-point";var J=document.createElement("div");J.appendChild(le),J.appendChild(_),v.appendChild(J);var he=function(Z,ue,je){if(Z===1){var De=v.getBoundingClientRect(),Ce=ue-De.left,Fe=je-De.top;Ce<0&&(Ce=0),Fe<0&&(Fe=0),Ce>De.width&&(Ce=De.width),Fe>De.height&&(Fe=De.height),_.style.left=Ce+"px",_.style.top=Fe+"px";var Ve=me.getImageData(Ce,Fe,1,1).data;ce=oe(Ve[0],Ve[1],Ve[2])}};return v.addEventListener("mousedown",function(Z){he(Z.buttons,Z.clientX,Z.clientY)}),v.addEventListener("mousemove",function(Z){he(Z.buttons,Z.clientX,Z.clientY)}),v.addEventListener("touchmove",function(Z){he(1,Z.changedTouches[0].clientX,Z.changedTouches[0].clientY)}),v},ce="",Ae=[],X=function(){if(ce!=="")for(var v=0;v<Ae.length;v++){var _=de(ce);_[v]=0;var J="linear-gradient(90deg, rgb(";J+=_.join(", "),J+="), rgb(",_[v]=255,J+=_.join(", "),J+="))",Ae[v].style.backgroundImage=J}},W=function(){var v=document.createElement("div");v.className="jcolor-sliders";var _=document.createElement("div"),J=function(je){var De=document.createElement("div");De.className="jcolor-sliders-input-container";var Ce=document.createElement("label");Ce.innerText=je;var Fe=document.createElement("div");Fe.className="jcolor-sliders-input-subcontainer";var Ve=document.createElement("input");Ve.type="range",Ve.min=0,Ve.max=255,Ve.value=0,De.appendChild(Ce),Fe.appendChild(Ve);var Ze=document.createElement("div");return Ze.innerText=Ve.value,Ve.addEventListener("input",function(){Ze.innerText=Ve.value}),Fe.appendChild(Ze),De.appendChild(Fe),_.appendChild(De),Ve};Ae=[J("Red"),J("Green"),J("Blue")],v.appendChild(_);var he=document.createElement("div");he.className="jcolor-sliders-final-color";var Z=document.createElement("div");Z.style.visibility="hidden",Z.innerText="a",he.appendChild(Z);var ue=function(){var je=oe(parseInt(Ae[0].value),parseInt(Ae[1].value),parseInt(Ae[2].value));Z.innerText=je,Z.style.color=je,Z.style.removeProperty("visibility"),ce=je};return Ae.forEach(function(je){je.addEventListener("input",function(){ue(),X()})}),v.appendChild(he),v},ne=function(){l.setOptions(A),w.tagName=="INPUT"&&(w.classList.add("jcolor-input"),w.readOnly=!0),o=document.createElement("div"),o.className="jcolor",k=document.createElement("div"),k.className="jcolor-backdrop",o.appendChild(k),Q=document.createElement("div"),Q.className="jcolor-content";var v=document.createElement("div");v.className="jcolor-controls",Q.appendChild(v),ee=document.createElement("div"),ee.className="jcolor-reset",ee.innerHTML=l.options.resetLabel,v.appendChild(ee),S=document.createElement("div"),S.className="jcolor-close",S.innerHTML=l.options.doneLabel,v.appendChild(S),M=document.createElement("div"),Q.appendChild(M),V=ge(M,{animation:!0,data:[{title:"Grid",contentElement:fe()},{title:"Spectrum",contentElement:Je()},{title:"Sliders",contentElement:W()}],onchange:function(_,J,he){if(he===1)Ne();else{var Z=ce!==""?ce:l.getValue();if(he===2&&Z){var ue=de(Z);Ae.forEach(function(je,De){je.value=ue[De],je.dispatchEvent(new Event("input"))})}}},palette:"modern"}),o.appendChild(Q),w.tagName=="INPUT"?w.parentNode.insertBefore(o,w.nextSibling):w.appendChild(o),o.addEventListener("click",function(_){if(_.target.tagName=="TD"){var J=_.target.getAttribute("data-value");J&&l.setValue(J)}else _.target.classList.contains("jcolor-reset")?(l.setValue(""),l.close()):_.target.classList.contains("jcolor-close")?(V.getActive()>0&&l.setValue(ce),l.close()):_.target.classList.contains("jcolor-backdrop")?l.close():l.open()}),w.addEventListener("mouseup",function(_){l.open()}),window.addEventListener("resize",function(){o.classList.contains("jcolor-focus")&&V.getActive()==1&&Ne()}),l.options.opened==!0&&l.open(),w.change=l.setValue,w.val=function(_){if(_===void 0)return l.getValue();l.setValue(_)},w.color=l,o.color=l};return l.toHex=function(v){var _=function(J){return("0"+parseInt(J).toString(16)).slice(-2)};if(v)return/^#[0-9A-F]{6}$/i.test(v)?v:(v=v.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),v&&v.length?"#"+_(v[1])+_(v[2])+_(v[3]):"")},ne(),l}function xe(){var w=function(A,l){var o={type:"contextmenu"};o.options={};var k={items:null,onclick:null};for(var Q in k)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=k[Q];A.classList.add("jcontextmenu"),o.open=function(M,V){if(V&&(o.options.items=V,o.create(V)),w.current&&w.current.close(),u(o,!0),A.classList.add("jcontextmenu-focus"),w.current=o,o.options.items&&o.options.items.length>0||A.children.length){if(M.target)if(M.changedTouches&&M.changedTouches[0])K=M.changedTouches[0].clientX,oe=M.changedTouches[0].clientY;else var K=M.clientX,oe=M.clientY;else var K=M.x,oe=M.y;var ve=A.getBoundingClientRect();if(window.innerHeight<oe+ve.height){var de=oe-ve.height;de<0&&(de=0),A.style.top=de+"px"}else A.style.top=oe+"px";window.innerWidth<K+ve.width?K-ve.width>0?A.style.left=K-ve.width+"px":A.style.left="10px":A.style.left=K+"px"}},o.isOpened=function(){return!!A.classList.contains("jcontextmenu-focus")},o.close=function(){A.classList.contains("jcontextmenu-focus")&&A.classList.remove("jcontextmenu-focus"),u(o,!1)},o.create=function(M){A.innerHTML="";var V=ee();A.appendChild(V);for(var K=0;K<M.length;K++){var oe=S(M[K]);A.appendChild(oe)}};function ee(){var M=document.createElement("div");M.classList.add("header"),M.addEventListener("click",function(oe){oe.preventDefault(),oe.stopPropagation()});var V=document.createElement("a");V.classList.add("title"),V.innerHTML=g.translate("Menu"),M.appendChild(V);var K=document.createElement("a");return K.classList.add("close"),K.innerHTML=g.translate("close"),K.addEventListener("click",function(oe){o.close()}),M.appendChild(K),M}function S(M){if(M.type&&(M.type=="line"||M.type=="divisor"))var V=document.createElement("hr");else{var V=document.createElement("div"),K=document.createElement("a");if(K.innerHTML=M.title,M.tooltip&&V.setAttribute("title",M.tooltip),M.icon&&V.setAttribute("data-icon",M.icon),M.id&&(V.id=M.id),M.disabled?V.className="jcontextmenu-disabled":M.onclick&&(V.method=M.onclick,V.addEventListener("mousedown",function(We){We.preventDefault()}),V.addEventListener("mouseup",function(We){this.method(this,We)})),V.appendChild(K),M.submenu){var oe=document.createElement("span");oe.innerHTML="&#9658;",V.appendChild(oe),V.classList.add("jcontexthassubmenu");var ve=document.createElement("div");ve.classList.add("jcontextmenu"),ve.setAttribute("tabindex","900");for(var de=M.submenu,fe=0;fe<de.length;fe++){var le=S(de[fe]);ve.appendChild(le)}V.appendChild(ve)}else if(M.shortcut){var me=document.createElement("span");me.innerHTML=M.shortcut,V.appendChild(me)}}return V}return typeof o.options.onclick=="function"&&A.addEventListener("click",function(M){o.options.onclick(o,M)}),o.options.items&&o.create(o.options.items),window.addEventListener("mousewheel",function(){o.close()}),A.contextmenu=o,o};return w}var Te=xe();function ye(){var w=function(A,l){if(A.dropdown)return A.dropdown.setOptions(l,!0);var o={type:"dropdown"};o.options={};var k=function(X,W){X&&X.length&&(o.options.sortResults!==!1&&(typeof o.options.sortResults=="function"?X.sort(o.options.sortResults):X.sort(Q)),o.setData(X)),typeof o.options.onload=="function"&&o.options.onload(A,o,X,W),W&&S(W),W==null&&(o.options.value=""),A.value=o.options.value,o.options.opened==!0&&o.open()},Q=function(X,W){var ne,v;return typeof X=="string"?ne=X:X.text?ne=X.text:X.name&&(ne=X.name),typeof W=="string"?v=W:W.text?v=W.text:W.name&&(v=W.name),typeof ne=="string"||typeof v=="string"?(typeof ne!="string"&&(ne=""+ne),typeof v!="string"&&(v=""+v),ne.localeCompare(v)):ne-v},ee=function(){o.value={};for(var X=0;X<o.items.length;X++)o.items[X].selected==!0&&(o.items[X].element&&o.items[X].element.classList.remove("jdropdown-selected"),o.items[X].selected=null);o.options.value="",A.value=""},S=function(X){if(ee(),X!==null)if(!X)typeof o.value[""]<"u"&&(o.value[""]="");else{Array.isArray(X)||(X=(""+X).split(";"));for(var W=0;W<X.length;W++)o.value[X[W]]=""}for(var W=0;W<o.items.length;W++)typeof o.value[M(W)]<"u"&&(o.items[W].element&&o.items[W].element.classList.add("jdropdown-selected"),o.items[W].selected=!0,o.value[M(W)]=V(W));o.options.value=Object.keys(o.value).join(";"),o.header.value=o.getText()},M=function(X,W){if(o.options.format)var ne="id";else var ne="value";return o.items[X]?W!==void 0?o.items[X].data[ne]=W:o.items[X].data[ne]:""},V=function(X,W){if(o.options.format)var ne="name";else var ne="text";return o.items[X]?W!==void 0?o.items[X].data[ne]=W:o.items[X].data[ne]:""},K=function(){return Object.keys(o.value)},oe=function(){for(var X=[],W=Object.keys(o.value),ne=0;ne<W.length;ne++)X.push(o.value[W[ne]]);return X};o.setOptions=function(X,W){X||(X={});var ne={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1};for(var v in ne)X&&X.hasOwnProperty(v)?o.options[v]=X[v]:(typeof o.options[v]>"u"||W===!0)&&(o.options[v]=ne[v]);return(o.options.remoteSearch==!0||o.options.type==="searchbar")&&(o.options.autocomplete=!0),o.options.newOptions==!0?o.header.classList.add("jdropdown-add"):o.header.classList.remove("jdropdown-add"),o.options.autocomplete==!0?o.header.removeAttribute("readonly"):o.header.setAttribute("readonly","readonly"),o.options.placeholder?o.header.setAttribute("placeholder",o.options.placeholder):o.header.removeAttribute("placeholder"),A.classList.remove("jdropdown-searchbar"),A.classList.remove("jdropdown-picker"),A.classList.remove("jdropdown-list"),o.options.type=="searchbar"?A.classList.add("jdropdown-searchbar"):o.options.type=="list"?A.classList.add("jdropdown-list"):o.options.type=="picker"?A.classList.add("jdropdown-picker"):d.getWindowWidth()<800?o.options.autocomplete?(A.classList.add("jdropdown-searchbar"),o.options.type="searchbar"):(A.classList.add("jdropdown-picker"),o.options.type="picker"):(o.options.width?(A.style.width=o.options.width,A.style.minWidth=o.options.width):(A.style.removeProperty("width"),A.style.removeProperty("min-width")),A.classList.add("jdropdown-default"),o.options.type="default"),o.options.type=="searchbar"?ve.appendChild(le):de.insertBefore(le,de.firstChild),o.options.url&&!X.data?T({url:o.options.url,method:"GET",dataType:"json",success:function(_){_&&k(_,o.options.value)}}):k(o.options.data,o.options.value),o};var ve=null,de=null,fe=null,le=null,me=null,Ne=null,We=null,Je=function(){if(l||(l={}),A.tagName=="SELECT"){var X=w.extractFromDom(A,l);A=X.el,l=X.options}!l.placeholder&&A.getAttribute("placeholder")&&(l.placeholder=A.getAttribute("placeholder")),o.value={},o.items=[],o.groups=[],o.search="",o.results=null,A.classList.add("jdropdown"),ve=document.createElement("div"),ve.className="jdropdown-container-header",o.header=document.createElement("input"),o.header.className="jdropdown-header jss_object",o.header.type="text",o.header.setAttribute("autocomplete","off"),o.header.onfocus=function(){typeof o.options.onfocus=="function"&&o.options.onfocus(A)},o.header.onblur=function(){typeof o.options.onblur=="function"&&o.options.onblur(A)},o.header.onkeyup=function(W){o.options.autocomplete==!0&&!We?(o.search!=o.header.value.trim()&&(We=setTimeout(function(){o.find(o.header.value.trim()),We=null},400)),A.classList.contains("jdropdown-focus")||o.open()):o.options.autocomplete||o.next(W.key)},w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),de=document.createElement("div"),de.className="jdropdown-container",fe=document.createElement("div"),fe.className="jdropdown-content",le=document.createElement("div"),le.className="jdropdown-close",le.textContent="Done",me=document.createElement("div"),me.className="jdropdown-reset",me.textContent="x",me.onclick=function(){o.reset(),o.close()},Ne=document.createElement("div"),Ne.className="jdropdown-backdrop",ve.appendChild(o.header),de.appendChild(fe),A.appendChild(ve),A.appendChild(de),A.appendChild(Ne),o.setOptions(l),"ontouchsend"in document.documentElement?A.addEventListener("touchsend",w.mouseup):A.addEventListener("mouseup",w.mouseup),o.options.lazyLoading==!0&&h(fe,{loadUp:o.loadUp,loadDown:o.loadDown}),fe.onwheel=function(W){W.stopPropagation()},A.change=o.setValue,A.val=function(W){if(W===void 0)return o.getValue(!!o.options.multiple);o.setValue(W)},A.dropdown=o};o.getUrl=function(){return o.options.url},o.setUrl=function(X,W){o.options.url=X,T({url:o.options.url,method:"GET",dataType:"json",success:function(ne){o.setData(ne),typeof W=="function"&&W(o)}})},o.setId=function(X,W){if(o.options.format)var ne="id";else var ne="value";typeof X=="object"?X[ne]=W:o.items[X].data[ne]=W},o.add=function(X,W){if(!X){var ne=o.options.autocomplete==!0?o.header.value:"",X=prompt(g.translate("Add A New Option"),ne);if(!X)return!1}if(W||(W=d.guid()),o.options.format)var v={id:W,name:X};else var v={value:W,text:X};if(typeof o.options.onbeforeinsert=="function"){var _=o.options.onbeforeinsert(o,v);if(_===!1)return!1;_&&(v=_)}o.options.data.push(v);var J=o.createItem(v);return fe.appendChild(J.element),typeof o.options.oninsert=="function"&&o.options.oninsert(o,v,J),fe.style.display=="none"&&(fe.style.display=""),o.results&&o.results.push(J),v},o.createItem=function(X,W,ne){o.options.format?(!X.id&&X.value!==void 0&&(X.id=X.value),!X.name&&X.text!==void 0&&(X.name=X.text)):(!X.value&&X.id!==void 0&&(X.value=X.id),!X.text&&X.name!==void 0&&(X.text=X.name));var v={};if(v.element=document.createElement("div"),v.element.className="jdropdown-item",v.element.indexValue=o.items.length,v.data=X,W&&(v.group=W),X.id&&v.element.setAttribute("id",X.id),X.disabled==!0&&v.element.setAttribute("data-disabled",!0),X.tooltip&&v.element.setAttribute("title",X.tooltip),X.image){var _=document.createElement("img");_.className="jdropdown-image",_.src=X.image,X.title||_.classList.add("jdropdown-image-small"),v.element.appendChild(_)}else if(X.icon){var J=document.createElement("span");J.className="jdropdown-icon material-icons",J.innerText=X.icon,X.title||J.classList.add("jdropdown-icon-small"),X.color&&(J.style.color=X.color),v.element.appendChild(J)}else if(X.color){var he=document.createElement("div");he.className="jdropdown-color",he.style.backgroundColor=X.color,v.element.appendChild(he)}if(o.options.format)var Z=X.name;else var Z=X.text;var ue=document.createElement("div");if(ue.className="jdropdown-description",ue.textContent=Z||"&nbsp;",X.title){var je=document.createElement("div");je.className="jdropdown-title",je.innerText=X.title,ue.appendChild(je)}if(o.options.format)var De=X.id;else var De=X.value;return o.value[De]&&(v.element.classList.add("jdropdown-selected"),v.selected=!0),o.items.push(v),v.element.appendChild(ue),v},o.appendData=function(X){if(X.length){for(var W=[],ne=[],v=0;v<X.length;v++)X[v].group?(ne[X[v].group]||(ne[X[v].group]=[]),ne[X[v].group].push(v)):W.push(v);var _=0,J=Object.keys(ne);if(J.length>0)for(var v=0;v<J.length;v++){var he=document.createElement("div");he.className="jdropdown-group";var Z=document.createElement("div");Z.className="jdropdown-group-name",Z.textContent=J[v];var ue=document.createElement("i");ue.className="jdropdown-group-arrow jdropdown-group-arrow-down",Z.appendChild(ue);var je=document.createElement("div");je.className="jdropdown-group-items";for(var De=0;De<ne[J[v]].length;De++){var Ce=o.createItem(X[ne[J[v]][De]],he,J[v]);(o.options.lazyLoading==!1||_<200)&&(je.appendChild(Ce.element),_++)}he.appendChild(Z),he.appendChild(je),o.groups.push(he),je.children.length>0&&fe.appendChild(he)}if(W.length)for(var v=0;v<W.length;v++){var Ce=o.createItem(X[W[v]]);(o.options.lazyLoading==!1||_<200)&&(fe.appendChild(Ce.element),_++)}}},o.setData=function(X){if(ee(),fe.textContent="",o.header.value="",o.items=[],X&&X.length){for(var W=0;W<X.length;W++)typeof X[W]!="object"&&(o.options.format?X[W]={id:X[W],name:X[W]}:X[W]={value:X[W],text:X[W]});o.appendData(X),o.options.data=X}else o.options.data=[];o.close()},o.getData=function(){return o.options.data},o.getPosition=function(X){for(var W=0;W<o.items.length;W++)if(M(W)==X)return W;return!1},o.getText=function(X){var W=oe();return X?W:W.join("; ")},o.getValue=function(X){var W=K();return X?W:W.join(";")};var ce=function(X){A.value!=o.options.value&&(A.value=o.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value})),typeof o.options.onchange=="function"&&o.options.onchange(A,o,X,o.options.value)};o.setValue=function(X){var W=o.getValue();Array.isArray(X)&&(X=X.join(";")),W!==X&&(S(X),ce(W))},o.resetSelected=function(){o.setValue(null)},o.selectIndex=function(ne,W){var ne=parseInt(ne);if(o.items&&o.items[ne]&&(W===!0||o.items[ne].data.disabled!==!0))if(o.setCursor(ne,!1),!o.options.multiple)o.items[ne].selected?o.setValue(null):o.setValue(M(ne)),o.close();else{var v=o.options.value;o.items[ne].selected?(o.items[ne].element.classList.remove("jdropdown-selected"),o.items[ne].selected=!1,delete o.value[M(ne)]):(o.items[ne].element.classList.add("jdropdown-selected"),o.items[ne].selected=!0,o.value[M(ne)]=V(ne)),o.options.value=Object.keys(o.value).join(";"),o.options.autocomplete==!1&&(o.header.value=oe().join("; ")),ce(v)}},o.selectItem=function(X){o.selectIndex(X.indexValue)};var Ae=function(X,W){for(var ne=0;ne<W.length;ne++)if(o.options.format){if(W[ne].id==X)return!0}else if(W[ne].value==X)return!0;return!1};return o.find=function(X){if(o.search==X.trim())return!1;if(o.search=X,o.setCursor(),o.groups.length)for(var W=0;W<o.groups.length;W++)o.groups[W].lastChild.textContent="";if(fe.textContent="",o.options.remoteSearch==!0){o.results=null;var ne=o.options.url;let je={url:ne,method:"GET",data:{q:X},dataType:"json",success:function(De){o.items=[];var Ce=Object.keys(o.value);if(Ce.length)for(var Fe=0;Fe<Ce.length;Fe++)Ae(Ce[Fe],De)||(o.options.format?De.unshift({id:Ce[Fe],name:o.value[Ce[Fe]]}):De.unshift({value:Ce[Fe],text:o.value[Ce[Fe]]}));o.appendData(De),De.length?fe.style.display="":fe.style.display="none",typeof o.options.onsearch=="function"&&o.options.onsearch(o,De)}};if(typeof o.options.onbeforesearch=="function"){let De=o.options.onbeforesearch(o,je);if(De===!1)return;typeof De=="object"&&(je=De)}T(je)}else{X=new RegExp(X,"gi");for(var v=[],W=0;W<o.items.length;W++){var _=V(W),J=o.items[W].data.title||"",he=o.items[W].data.group||"",Z=o.items[W].data.synonym||"";Z&&(Z=Z.join(" ")),(X==null||o.items[W].selected==!0||_.match(X)||J.match(X)||he.match(X)||Z.match(X))&&v.push(o.items[W])}if(!v.length)fe.style.display="none",o.results=null;else{fe.style.display="",o.results=v;var ue=v.length||0;o.options.lazyLoading==!0&&ue>200&&(ue=200);for(var W=0;W<ue;W++)o.results[W].group?(o.results[W].group.parentNode||fe.appendChild(o.results[W].group),o.results[W].group.lastChild.appendChild(o.results[W].element)):fe.appendChild(o.results[W].element)}}o.options.autofocus==!0&&o.first()},o.open=function(){if(!A.classList.contains("jdropdown-focus")){w.current=o,u(o,!0),A.classList.add("jdropdown-focus"),d.getWindowWidth()<800&&(o.options.type==null||o.options.type=="picker")&&B.slideBottom(de,1),o.options.autocomplete==!0&&(o.header.value=o.search,o.header.focus());var X=K();if(X[0]){var W=o.getPosition(X[0]);W!==!1&&o.setCursor(W)}if(!o.options.type||o.options.type=="default"){var ne=A.getBoundingClientRect(),v=de.getBoundingClientRect();o.options.position?(de.style.position="fixed",window.innerHeight<ne.bottom+v.height?(de.style.top="",de.style.bottom=window.innerHeight-ne.top+1+"px"):(de.style.top=ne.bottom+"px",de.style.bottom=""),de.style.left=ne.left+"px"):window.innerHeight<ne.bottom+v.height?(de.style.top="",de.style.bottom=ne.height+1+"px"):(de.style.top="",de.style.bottom=""),de.style.minWidth=ne.width+"px",o.options.maxWidth&&(de.style.maxWidth=o.options.maxWidth),!o.items.length&&o.options.autocomplete==!0?fe.style.display="none":fe.style.display=""}}typeof o.options.onopen=="function"&&o.options.onopen(A)},o.close=function(X){return A.classList.contains("jdropdown-focus")&&(o.header.value=o.getText(),o.setCursor(),!X&&typeof o.options.onclose=="function"&&o.options.onclose(A),o.header.blur&&o.header.blur(),A.classList.remove("jdropdown-focus"),u(o,!1),w.current=null),o.getValue()},o.setCursor=function(X,W){if(o.currentIndex!=null&&o.items&&o.items[o.currentIndex]&&o.items[o.currentIndex].element.classList.remove("jdropdown-cursor"),X==null)o.currentIndex=null;else if(X=parseInt(X),o.items[X].element.parentNode&&(o.items[X].element.classList.add("jdropdown-cursor"),o.currentIndex=X,W!==!1&&o.items[o.currentIndex].element)){fe.scrollTop;var ne=o.items[o.currentIndex].element;fe.scrollTop=ne.offsetTop-ne.scrollTop+ne.clientTop-95}},o.resetCursor=o.setCursor,o.updateCursor=o.setCursor,o.reset=function(){o.setCursor(),o.setValue(null)},o.first=function(){o.options.lazyLoading===!0&&o.loadFirst();var X=fe.querySelectorAll(".jdropdown-item");if(X.length){var W=X[0].indexValue;o.setCursor(W)}},o.last=function(){o.options.lazyLoading===!0&&o.loadLast();var X=fe.querySelectorAll(".jdropdown-item");if(X.length){var W=X[X.length-1].indexValue;o.setCursor(W)}},o.next=function(X){var W=null;if(X){if(X.length==1){var ne=o.currentIndex||-1;X=X.toLowerCase();var v=null,_=null,J=fe.querySelectorAll(".jdropdown-item");if(J.length){for(var he=0;he<J.length;he++)if(J[he].indexValue>ne&&(v=o.items[J[he].indexValue])&&(_=v.element.innerText[0])&&(_=_.toLowerCase(),X==_)){W=J[he].indexValue;break}o.setCursor(W)}}}else if(o.currentIndex==null||o.currentIndex==null)o.first();else{var Z=o.items[o.currentIndex].element,ue=Z.nextElementSibling;ue?(ue.classList.contains("jdropdown-group")&&(ue=ue.lastChild.firstChild),W=ue.indexValue):Z.parentNode.classList.contains("jdropdown-group-items")&&((ue=Z.parentNode.parentNode.nextElementSibling)&&(ue.classList.contains("jdropdown-group")?ue=ue.lastChild.firstChild:ue.classList.contains("jdropdown-item")?W=ue.indexValue:ue=null),ue&&(W=ue.indexValue)),W!==null&&o.setCursor(W)}},o.prev=function(){var X=null;if(o.currentIndex===null)o.first();else{var W=o.items[o.currentIndex].element,ne=W.previousElementSibling;ne?(ne.classList.contains("jdropdown-group")&&(ne=ne.lastChild.lastChild),X=ne.indexValue):W.parentNode.classList.contains("jdropdown-group-items")&&((ne=W.parentNode.parentNode.previousElementSibling)&&(ne.classList.contains("jdropdown-group")?ne=ne.lastChild.lastChild:ne.classList.contains("jdropdown-item")?X=ne.indexValue:ne=null),ne&&(X=ne.indexValue))}X!==null&&o.setCursor(X)},o.loadFirst=function(){if(o.results)var X=o.results;else var X=o.items;var W=X.length||0;o.options.lazyLoading==!0&&W>200&&(W=200),fe.textContent="";for(var ne=0;ne<W;ne++)X[ne].group?(X[ne].group.parentNode||fe.appendChild(X[ne].group),X[ne].group.lastChild.appendChild(X[ne].element)):fe.appendChild(X[ne].element);fe.scrollTop=0},o.loadLast=function(){if(o.results)var X=o.results;else var X=o.items;var W=X.length;if(W>200){W=W-200,fe.textContent="";for(var ne=W;ne<X.length;ne++)X[ne].group?(X[ne].group.parentNode||fe.appendChild(X[ne].group),X[ne].group.lastChild.appendChild(X[ne].element)):fe.appendChild(X[ne].element);fe.scrollTop=fe.scrollHeight}},o.loadUp=function(){var X=!1;if(o.results)var W=o.results;else var W=o.items;var ne=fe.querySelectorAll(".jdropdown-item"),v=ne[0].indexValue;v=o.items[v];var _=W.indexOf(v)-1;if(_>0){for(var J=0;_>0&&W[_]&&J<200;)W[_].group?(W[_].group.parentNode||fe.insertBefore(W[_].group,fe.firstChild),W[_].group.lastChild.insertBefore(W[_].element,W[_].group.lastChild.firstChild)):fe.insertBefore(W[_].element,fe.firstChild),_--,J++;X=!0}return X},o.loadDown=function(){var X=!1;if(o.results)var W=o.results;else var W=o.items;var ne=fe.querySelectorAll(".jdropdown-item"),v=ne[ne.length-1].indexValue;v=o.items[v];var _=W.indexOf(v)+1;if(_<W.length){for(var J=0;_<W.length&&W[_]&&J<200;)W[_].group?(W[_].group.parentNode||fe.appendChild(W[_].group),W[_].group.lastChild.appendChild(W[_].element)):fe.appendChild(W[_].element),_++,J++;X=!0}return X},Je(),o};return w.keydown=function(A){var l=null;if(l=w.current){if(A.which==13||A.which==9)l.header.value&&l.currentIndex==null&&l.options.newOptions?l.add():(l.currentIndex==null&&l.options.autocomplete==!0&&l.header.value!=""&&l.find(l.header.value),l.selectIndex(l.currentIndex));else if(A.which==38)l.currentIndex==null?l.first():l.currentIndex>0&&l.prev(),A.preventDefault();else if(A.which==40)l.currentIndex==null?l.first():l.currentIndex+1<l.items.length&&l.next(),A.preventDefault();else if(A.which==36)l.first(),A.target.classList.contains("jdropdown-header")||A.preventDefault();else if(A.which==35)l.last(),A.target.classList.contains("jdropdown-header")||A.preventDefault();else if(A.which==27)l.close();else if(A.which==33){if(l.currentIndex==null)l.first();else if(l.currentIndex>0)for(var o=0;o<7;o++)l.prev();A.preventDefault()}else if(A.which==34){if(l.currentIndex==null)l.first();else if(l.currentIndex+1<l.items.length)for(var o=0;o<7;o++)l.next();A.preventDefault()}}},w.mouseup=function(A){var l=d.findElement(A.target,"jdropdown");if(l){var o=l.dropdown;if(A.target.classList.contains("jdropdown-header"))if(l.classList.contains("jdropdown-focus")&&l.classList.contains("jdropdown-default")){var k=l.getBoundingClientRect();if(A.changedTouches&&A.changedTouches[0]){var Q=A.changedTouches[0].clientX;A.changedTouches[0].clientY}else{var Q=A.clientX;A.clientY}k.width-(Q-k.left)<30?A.target.classList.contains("jdropdown-add")?o.add():o.close():o.options.autocomplete==!1&&o.close()}else o.open();else if(A.target.classList.contains("jdropdown-group-name")){var ee=A.target.nextSibling.children;if(A.target.nextSibling.style.display!="none")for(var S=0;S<ee.length;S++)ee[S].style.display!="none"&&o.selectItem(ee[S])}else A.target.classList.contains("jdropdown-group-arrow")?A.target.classList.contains("jdropdown-group-arrow-down")?(A.target.classList.remove("jdropdown-group-arrow-down"),A.target.classList.add("jdropdown-group-arrow-up"),A.target.parentNode.nextSibling.style.display="none"):(A.target.classList.remove("jdropdown-group-arrow-up"),A.target.classList.add("jdropdown-group-arrow-down"),A.target.parentNode.nextSibling.style.display=""):A.target.classList.contains("jdropdown-item")?o.selectItem(A.target):A.target.classList.contains("jdropdown-image")||A.target.classList.contains("jdropdown-description")?o.selectItem(A.target.parentNode):A.target.classList.contains("jdropdown-title")?o.selectItem(A.target.parentNode.parentNode):(A.target.classList.contains("jdropdown-close")||A.target.classList.contains("jdropdown-backdrop"))&&o.close()}},w.extractFromDom=function(A,l){var o=A;if(l||(l={}),A.getAttribute("multiple")&&(!l||l.multiple==null)&&(l.multiple=!0),A.getAttribute("placeholder")&&(!l||l.placeholder==null)&&(l.placeholder=A.getAttribute("placeholder")),A.getAttribute("data-autocomplete")&&(!l||l.autocomplete==null)&&(l.autocomplete=!0),(!l||l.width==null)&&(l.width=A.offsetWidth),A.value&&(!l||l.value==null)&&(l.value=A.value),!l||l.data==null){l.data=[];for(var k=0;k<A.children.length;k++)if(A.children[k].tagName=="OPTGROUP")for(var Q=0;Q<A.children[k].children.length;Q++)l.data.push({value:A.children[k].children[Q].value,text:A.children[k].children[Q].textContent,group:A.children[k].getAttribute("label")});else l.data.push({value:A.children[k].value,text:A.children[k].textContent})}(!l||l.onchange==null)&&(l.onchange=function(S,M,V,K){l.multiple==!0?obj.items[M].classList.contains("jdropdown-selected")?o.options[M].setAttribute("selected","selected"):o.options[M].removeAttribute("selected"):o.value=K});var ee=document.createElement("div");return A.parentNode.insertBefore(ee,A),A.style.display="none",A=ee,{el:A,options:l}},w}var ae=ye();function ke(w,A){if(w.picker)return w.picker.setOptions(A,!0);var l={type:"picker"};l.options={};var o=null,k=null,Q=function(M){return M instanceof Element||M instanceof HTMLDocument},ee=function(){k.innerHTML="";for(var M=Object.keys(l.options.data),V=0;V<M.length;V++){var K=document.createElement("div");K.classList.add("jpicker-item"),K.k=M[V],K.v=l.options.data[M[V]];var oe=l.getLabel(M[V],K);Q(oe)?K.appendChild(oe):K.innerHTML=oe,k.appendChild(K)}};l.setOptions=function(M,V){var K={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};M&&M.options&&(M.data=M.options);for(var oe in K)M&&M.hasOwnProperty(oe)?l.options[oe]=M[oe]:(typeof l.options[oe]>"u"||V===!0)&&(l.options[oe]=K[oe]);return l.options.header===!1?o.style.display="none":o.style.display="",l.options.width?o.style.width=parseInt(l.options.width)+"px":o.style.width="",l.options.height?(k.style.maxHeight=l.options.height+"px",k.style.overflow="scroll"):k.style.overflow="",l.options.columns>0&&(l.options.grid?(k.classList.add("jpicker-grid"),k.style.gridTemplateColumns="repeat("+l.options.grid+", 1fr)"):(k.classList.add("jpicker-columns"),k.style.width=l.options.width?l.options.width:36*l.options.columns+"px")),isNaN(parseInt(l.options.value))&&(l.options.value=0),ee(),l.setValue(l.options.value),l},l.getValue=function(){return l.options.value},l.setValue=function(M,V){if(l.setLabel(M),l.options.value=String(M),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),k.children[M]&&k.children[M].getAttribute("type")!=="generic"&&l.close(),V&&typeof l.options.onchange=="function"){var K=l.options.data[M];l.options.onchange(w,l,K,K,M,V)}},l.getLabel=function(M,V){var K=l.options.data[M]||null;return typeof l.options.render=="function"&&(K=l.options.render(K,V)),K},l.setLabel=function(M){var V;l.options.content?V='<i class="material-icons">'+l.options.content+"</i>":V=l.getLabel(M,null),Q(V)?(o.innerHTML="",o.appendChild(V)):o.innerHTML=V},l.open=function(){if(!w.classList.contains("jpicker-focus")){u(l,!0),w.classList.add("jpicker-focus"),w.focus();var M=0,V=0;k.style.marginLeft="";var K=o.getBoundingClientRect(),oe=k.getBoundingClientRect();window.innerHeight<K.bottom+oe.height||l.options.bottom?M=-1*(oe.height+4):M=K.height+4,l.options.right===!0&&(V=-1*oe.width+K.width),oe.left+V<0&&(V=V+oe.left+10),oe.left+oe.width>window.innerWidth&&(V=-1*(10+oe.left+oe.width-window.innerWidth)),k.style.marginTop=parseInt(M)+"px",k.style.marginLeft=parseInt(V)+"px",typeof l.options.onopen=="function"&&l.options.onopen(w,l)}},l.close=function(){w.classList.contains("jpicker-focus")&&(w.classList.remove("jpicker-focus"),u(l,!1),typeof l.options.onclose=="function"&&l.options.onclose(w,l))};var S=function(){w.classList.add("jpicker"),w.setAttribute("tabindex","900"),w.onmousedown=function(M){w.classList.contains("jpicker-focus")||l.open()},o=document.createElement("div"),o.classList.add("jpicker-header"),k=document.createElement("div"),k.classList.add("jpicker-content"),k.onclick=function(M){var V=d.findElement(M.target,"jpicker-item");V&&V.parentNode===k&&l.setValue(V.k,M)},w.appendChild(o),w.appendChild(k),w.value=A.value||0,l.setOptions(A),typeof l.options.onload=="function"&&l.options.onload(w,l),w.change=l.setValue,w.val=function(M){if(M===void 0)return l.getValue();l.setValue(M)},w.picker=l};return S(),l}function Ke(w,A){var l={type:"toolbar"};l.options={};var o={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var k in o)A&&A.hasOwnProperty(k)?l.options[k]=A[k]:l.options[k]=o[k];!w&&A.app&&A.app.el&&(w=document.createElement("div"),A.app.el.appendChild(w));var Q=document.createElement("div");Q.classList.add("jtoolbar-item"),Q.classList.add("jtoolbar-arrow");var ee=document.createElement("div");ee.classList.add("jtoolbar-floating"),Q.appendChild(ee),l.selectItem=function(M){for(var V=S.children,K=0;K<V.length;K++)M!=V[K]&&V[K].classList.remove("jtoolbar-selected");M.classList.add("jtoolbar-selected")},l.hide=function(){B.slideBottom(w,0,function(){w.style.display="none"})},l.show=function(){w.style.display="",B.slideBottom(w,1)},l.get=function(){return w},l.setBadge=function(M,V){S.children[M].children[1].firstChild.innerHTML=V},l.destroy=function(){toolbar.remove(),w.innerHTML=""},l.update=function(M,V){for(var K=0;K<S.children.length;K++){var oe=S.children[K];typeof oe.updateState=="function"&&oe.updateState(w,l,oe,M,V)}for(var K=0;K<ee.children.length;K++){var oe=ee.children[K];typeof oe.updateState=="function"&&oe.updateState(w,l,oe,M,V)}},l.create=function(M){S.innerHTML="";for(var V=0;V<M.length;V++){var K=document.createElement("div");if(K.classList.add("jtoolbar-item"),M[V].width&&(K.style.width=parseInt(M[V].width)+"px"),M[V].k&&(K.k=M[V].k),M[V].tooltip&&K.setAttribute("title",M[V].tooltip),M[V].id&&K.setAttribute("id",M[V].id),M[V].updateState&&(K.updateState=M[V].updateState),M[V].active&&K.classList.add("jtoolbar-active"),M[V].disabled&&K.classList.add("jtoolbar-disabled"),M[V].type=="select"||M[V].type=="dropdown")ke(K,M[V]);else if(M[V].type=="divisor")K.classList.add("jtoolbar-divisor");else if(M[V].type=="label")K.classList.add("jtoolbar-label"),K.innerHTML=M[V].content;else{var oe=document.createElement("i");if(typeof M[V].class>"u")oe.classList.add("material-icons");else for(var ve=M[V].class.split(" "),de=0;de<ve.length;de++)oe.classList.add(ve[de]);if(oe.innerHTML=M[V].content?M[V].content:"",K.appendChild(oe),l.options.badge==!0){var fe=document.createElement("div");fe.classList.add("jbadge");var le=document.createElement("div");le.innerHTML=M[V].badge?M[V].badge:"",fe.appendChild(le),K.appendChild(fe)}if(M[V].title)if(l.options.title==!0){var me=document.createElement("span");me.innerHTML=M[V].title,K.appendChild(me)}else K.setAttribute("title",M[V].title);l.options.app&&M[V].route&&(K.route=M[V].route,K.onclick=function(){l.options.app.pages(this.route)},l.options.app.pages(M[V].route,{toolbarItem:K,closed:!0})),typeof M[V].render=="function"&&M[V].render(K,M[V])}M[V].onclick&&(K.onclick=M[V].onclick.bind(M[V],w,l,K)),S.appendChild(K)}setTimeout(function(){l.refresh()},0)},l.open=function(){Q.classList.add("jtoolbar-arrow-selected"),w.getBoundingClientRect();var M=ee.getBoundingClientRect();M.bottom>window.innerHeight||l.options.bottom?ee.style.bottom="0":ee.style.removeProperty("bottom"),ee.style.right="0",Q.children[0].focus(),u(l,!0)},l.close=function(){Q.classList.remove("jtoolbar-arrow-selected"),u(l,!1)},l.refresh=function(){if(l.options.responsive==!0){var M=w.parentNode.getBoundingClientRect();l.options.maxWidth||(l.options.maxWidth=M.width);var V=parseInt(l.options.maxWidth);for(Q.parentNode&&Q.parentNode.removeChild(Q);ee.firstChild;)S.appendChild(ee.firstChild);if(V<S.offsetWidth)for(V-=50;S.lastChild&&V<S.offsetWidth;)ee.insertBefore(S.lastChild,ee.firstChild);ee.children.length>0&&S.appendChild(Q)}},l.setReadonly=function(M){M=M?"add":"remove",w.classList[M]("jtoolbar-disabled")},w.onclick=function(M){var V=d.findElement(M.target,"jtoolbar-item");V&&l.selectItem(V),M.target.classList.contains("jtoolbar-arrow")&&l.open()},window.addEventListener("resize",function(){l.refresh()}),w.classList.add("jtoolbar"),w.innerHTML="",l.options.container==!0&&w.classList.add("jtoolbar-container");var S=document.createElement("div");return w.appendChild(S),l.options.app&&w.classList.add("jtoolbar-mobile"),l.create(l.options.items),w.toolbar=l,l}function qe(){var w=function(A,l){var o={type:"editor"};o.options={};var k={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var Q in k)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=k[Q];var ee=null,S=null,M=[];o.el=A,typeof o.options.onclick=="function"&&(A.onclick=function(te){o.options.onclick(A,o,te)}),A.classList.add("jeditor-container");var V=document.createElement("div");V.className="jsnippet",V.setAttribute("contenteditable",!1);var K=document.createElement("div");if(K.className="jeditor-toolbar",o.editor=document.createElement("div"),o.editor.setAttribute("contenteditable",!0),o.editor.setAttribute("spellcheck",!1),o.editor.classList.add("jeditor"),o.options.placeholder&&o.editor.setAttribute("data-placeholder",o.options.placeholder),(o.options.maxHeight||o.options.height)&&(o.editor.style.overflowY="auto",o.options.maxHeight&&(o.editor.style.maxHeight=o.options.maxHeight),o.options.height&&(o.editor.style.height=o.options.height)),o.options.url)T({url:o.options.url,dataType:"html",success:function(te){o.editor.innerHTML=te,w.setCursor(o.editor,o.options.focus=="initial")}});else if(o.options.value)o.editor.innerHTML=o.options.value;else for(var oe=0;oe<A.children.length;oe++)o.editor.appendChild(A.children[oe]);A.innerHTML="";var ve=function(te){typeof o.options.onchange=="function"&&o.options.onchange(A,o,te),o.options.value=o.getData(),A.value!=o.options.value&&(A.value=o.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))},de=function(te){var be=document.createElement("div");be.innerHTML=te;var we=be.querySelectorAll("img");if(we.length)for(var He=0;He<we.length;He++)o.addImage(we[He].src)},fe=function(){var te=null;if(te=V.children[0]){te.classList.contains("jslider-grid")||te.classList.add("jslider-grid");var be=te.children.length;te.setAttribute("data-number",be>4?4:be),be>4?te.setAttribute("data-total",be-4):te.removeAttribute("data-total")}},le=function(te){V.innerHTML||o.appendSnippet({}),V.children[0].appendChild(te),fe()};o.appendSnippet=function(te){V.innerHTML="";for(var be=["image","title","description","host","url"],we=0;we<be.length;we++){var He=document.createElement("div");if(He.className="jsnippet-"+be[we],He.setAttribute("data-k",be[we]),V.appendChild(He),te[be[we]])if(be[we]=="image"){Array.isArray(te.image)||(te.image=[te.image]);for(var tt=0;tt<te.image.length;tt++){var $e=document.createElement("img");$e.src=te.image[tt],He.appendChild($e)}}else He.innerHTML=te[be[we]]}o.editor.appendChild(document.createElement("br")),o.editor.appendChild(V)},o.setData=function(te){typeof te=="object"?o.editor.innerHTML=te.content:o.editor.innerHTML=te,o.options.focus&&w.setCursor(o.editor,!0),M=[]},o.getFiles=function(){for(var te=o.editor.querySelectorAll(".jfile"),be=[],we=0;we<te.length;we++)M[te[we].src]&&be.push(M[te[we].src]);return be},o.getText=function(){return o.editor.innerText},o.getData=function(te){if(te){var be={content:""};if(V.innerHTML){be.snippet={};for(var we=0;we<V.children.length;we++){var He=V.children[we].getAttribute("data-k");if(He)if(He=="image"){be.snippet.image||(be.snippet.image=[]);for(var tt=0;tt<V.children[we].children.length;tt++)be.snippet.image.push(V.children[we].children[tt].getAttribute("src"))}else be.snippet[He]=V.children[we].innerHTML}}var $e=Object.keys(M);if($e.length){be.files=[];for(var we=0;we<$e.length;we++)be.files.push(M[$e[we]])}var ot=document.createElement("div");ot.innerHTML=o.editor.innerHTML;var st=ot.querySelector(".jsnippet");st&&st.remove();var Pe=ot.innerHTML;Pe=Pe.replace(/<br>/g,`
`),Pe=Pe.replace(/<\/div>/g,`</div>
`),Pe=Pe.replace(/<(?:.|\n)*?>/gm,""),be.content=Pe.trim(),Fe("getData",be)}else var be=o.editor.innerHTML;return be},o.reset=function(){o.editor.innerHTML="",V.innerHTML="",M=[]},o.addPdf=function(te){if(te.result.substr(0,4)!="data")console.error("Invalid source");else{var be=document.createElement("canvas");be.width=60,be.height=60;var we=new Image,He=be.getContext("2d");He.drawImage(we,0,0,be.width,be.height),be.toBlob(function(tt){var $e=document.createElement("img");$e.src=window.URL.createObjectURL(tt),$e.title=te.name,$e.className="jfile pdf",M[$e.src]={file:$e.src,extension:"pdf",content:te.result},document.execCommand("insertHtml",!1,$e.outerHTML)})}},o.addImage=function(te,be){if(te||(te=""),te.substr(0,4)!="data"&&!o.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(te.substr(0,4)=="data"){var we=te.split(";");we=we[0].split("/"),we=we[1]}else{var we=te.substr(te.lastIndexOf(".")+1);te=o.options.remoteParser+te}var He=new Image;He.onload=function(){var $e=document.createElement("canvas");$e.width=He.width,$e.height=He.height;var ot=$e.getContext("2d");ot.drawImage(He,0,0,$e.width,$e.height),$e.toBlob(function(st){var Pe=document.createElement("img");Pe.src=window.URL.createObjectURL(st),Pe.classList.add("jfile"),Pe.setAttribute("tabindex","900"),Pe.setAttribute("width",He.width),Pe.setAttribute("height",He.height),M[Pe.src]={file:Pe.src,extension:we,content:$e.toDataURL()},o.options.dropAsSnippet||be?(le(Pe),M[Pe.src].snippet=!0):document.execCommand("insertHtml",!1,Pe.outerHTML),ve()})},He.src=te}},o.addFile=function(te){for(var be=[],we=0;we<te.length;we++)if(te[we].size>o.options.maxFileSize)alert("The file is too big");else{var He=te[we].type.split("/");He[0]=="image"?He=1:He[1]=="pdf"?He=2:He=0,He?(be[we]=new FileReader,be[we].index=we,be[we].type=He,be[we].name=te[we].name,be[we].date=te[we].lastModified,be[we].size=te[we].size,be[we].addEventListener("load",function(tt){tt.target.type==2?o.options.acceptFiles==!0&&o.addPdf(tt.target):o.addImage(tt.target.result)},!1),be[we].readAsDataURL(te[we])):alert("The extension is not allowed")}},o.destroy=function(){o.editor.removeEventListener("mouseup",je),o.editor.removeEventListener("mousedown",De),o.editor.removeEventListener("mousemove",Ce),o.editor.removeEventListener("keyup",Z),o.editor.removeEventListener("keydown",ue),o.editor.removeEventListener("dragstart",W),o.editor.removeEventListener("dragenter",ne),o.editor.removeEventListener("dragover",v),o.editor.removeEventListener("drop",_),o.editor.removeEventListener("paste",X),o.editor.removeEventListener("blur",J),o.editor.removeEventListener("focus",he),A.editor=null,A.classList.remove("jeditor-container"),K.remove(),V.remove(),o.editor.remove()},o.upload=function(){d.click(o.file)};var me=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],Ne=["width","height","align","border","src","tabindex"],We=["color","font-weight","font-size","background","background-color","margin"],Je=function(te){if(te.attributes&&te.attributes.length){var be=null,we=te.getAttribute("style");if(we){be=[];for(var He=we.split(";"),tt=0;tt<He.length;tt++){var $e=He[tt].trim().split(":");if(We.indexOf($e[0].trim())>=0){var ot=$e.shift(),$e=$e.join(":");be.push(ot+":"+$e)}}}te.tagName.toUpperCase()=="IMG"&&(!o.options.acceptImages||!te.src?te.parentNode.removeChild(te):(te.setAttribute("tabindex","900"),o.addImage(te.src)));for(var st=[],Pe=0;Pe<te.attributes.length;Pe++)st.push(te.attributes[Pe].name);st.length&&st.forEach(function(Ye){Ne.indexOf(Ye)==-1?te.removeAttribute(Ye):te.attributes[Pe].value.indexOf("<")!==-1&&te.attributes[Pe].value.replace("<","&#60;")}),te.style="",be&&be.length&&te.setAttribute("style",be.join(";"))}if(te.children.length)for(var Pe=0;Pe<te.children.length;Pe++)Je(te.children[Pe]);me.indexOf(te.constructor)>=0&&te.remove()},ce=function(te){var be=window.getSelection(),we=document.createRange();we.selectNode(te),be.addRange(we)},Ae=function(te){te&&(te=te.replace(new RegExp("<!--(.*?)-->","gsi"),""));var be=new DOMParser,we=be.parseFromString(te,"text/html");Je(we);var He=document.createElement("span");return He.innerHTML=we.firstChild.innerHTML,He},X=function(te){if(o.options.filterPaste==!0){if(te.clipboardData||te.originalEvent.clipboardData)var be=(te.originalEvent||te).clipboardData.getData("text/html"),we=(te.originalEvent||te).clipboardData.getData("text/plain"),He=(te.originalEvent||te).clipboardData.files;else if(window.clipboardData)var be=window.clipboardData.getData("Html"),we=window.clipboardData.getData("Text"),He=window.clipboardData.files;if(He.length)o.addFile(He);else if(!be)be=we.split(`\r
`),te.target.innerText?(be=be.map(function($e){return"<div>"+$e+"</div>"}),document.execCommand("insertHtml",!1,be.join(""))):be.map(function($e){var ot=document.createElement("div");ot.innerText=$e,o.editor.appendChild(ot)});else{var tt=Ae(be);document.execCommand("insertHtml",!1,tt.innerHTML)}te.preventDefault()}},W=function(te){S&&S.e&&te.preventDefault()},ne=function(te){S||o.options.dropZone==!1||(A.classList.add("jeditor-dragging"),te.preventDefault())},v=function(te){S||o.options.dropZone==!1||(ee&&clearTimeout(ee),ee=setTimeout(function(){A.classList.remove("jeditor-dragging")},100),te.preventDefault())},_=function(te){if(!(S||o.options.dropZone==!1)){var be=null;document.caretRangeFromPoint?be=document.caretRangeFromPoint(te.clientX,te.clientY):te.rangeParent&&(be=document.createRange(),be.setStart(te.rangeParent,te.rangeOffset));var we=window.getSelection();we.removeAllRanges(),we.addRange(be),we.anchorNode.parentNode.focus();var He=(te.originalEvent||te).dataTransfer.getData("text/html"),tt=(te.originalEvent||te).dataTransfer.getData("text/plain"),$e=(te.originalEvent||te).dataTransfer.files;$e.length?o.addFile($e):tt&&de(He),A.classList.remove("jeditor-dragging"),te.preventDefault()}},J=function(te){Fe("onevent",te),ve(te),typeof o.options.onblur=="function"&&o.options.onblur(A,o,te)},he=function(te){typeof o.options.onfocus=="function"&&o.options.onfocus(A,o,te)},Z=function(te){o.editor.innerHTML||(o.editor.innerHTML="<div><br></div>"),typeof o.options.onkeyup=="function"&&o.options.onkeyup(A,o,te)},ue=function(te){if(Fe("onevent",te),te.key=="Delete"&&te.target.tagName=="IMG"){var be=te.target.parentNode;ce(te.target),be.classList.contains("jsnippet-image")&&fe()}typeof o.options.onkeydown=="function"&&o.options.onkeydown(A,o,te)},je=function(te){if(S&&S.e&&(S.e.classList.remove("resizing"),S.e.changed==!0)){var be=S.e.cloneNode();be.width=parseInt(S.e.style.width)||S.e.getAttribute("width"),be.height=parseInt(S.e.style.height)||S.e.getAttribute("height"),S.e.style.width="",S.e.style.height="",ce(S.e),document.execCommand("insertHtml",!1,be.outerHTML)}S=!1},De=function(te){var be=function($e){var ot=$e.getBoundingClientRect();ot.width-(te.clientX-ot.left)<40&&te.clientY-ot.top<40&&($e.innerHTML="",$e.remove())};if(te.target.tagName=="IMG")if(te.target.style.cursor){var we=te.target.getBoundingClientRect();S={e:te.target,x:te.clientX,y:te.clientY,w:we.width,h:we.height,d:te.target.style.cursor},te.target.getAttribute("width")||te.target.setAttribute("width",we.width),te.target.getAttribute("height")||te.target.setAttribute("height",we.height);var He=window.getSelection();if(He.rangeCount)for(var tt=0;tt<He.rangeCount;tt++)He.removeRange(He.getRangeAt(tt));te.target.classList.add("resizing")}else S=!0;else te.target.classList.contains("jsnippet")?be(te.target):te.target.parentNode.classList.contains("jsnippet")&&be(te.target.parentNode),S=!0},Ce=function(te){if(te.target.tagName=="IMG"&&!te.target.parentNode.classList.contains("jsnippet-image")&&o.options.allowImageResize==!0&&te.target.getAttribute("tabindex")){var be=te.target.getBoundingClientRect();te.clientY-be.top<5?be.width-(te.clientX-be.left)<5?te.target.style.cursor="ne-resize":te.clientX-be.left<5?te.target.style.cursor="nw-resize":te.target.style.cursor="n-resize":be.height-(te.clientY-be.top)<5?be.width-(te.clientX-be.left)<5?te.target.style.cursor="se-resize":te.clientX-be.left<5?te.target.style.cursor="sw-resize":te.target.style.cursor="s-resize":be.width-(te.clientX-be.left)<5?te.target.style.cursor="e-resize":te.clientX-be.left<5?te.target.style.cursor="w-resize":te.target.style.cursor=""}if(te.which==1&&S&&S.d){if(S.d=="e-resize"||S.d=="ne-resize"||S.d=="se-resize")if(S.e.style.width=S.w+(te.clientX-S.x),te.shiftKey){var we=(te.clientX-S.x)*(S.h/S.w);S.e.style.height=S.h+we}else var we=null;we||(S.d=="s-resize"||S.d=="se-resize"||S.d=="sw-resize")&&(te.shiftKey||(S.e.style.height=S.h+(te.clientY-S.y))),S.e.changed=!0}},Fe=function(te,be){if(o.options.extensions){var we=Object.keys(o.options.extensions);if(we.length)for(var He=0;He<we.length;He++)o.options.extensions[we[He]]&&typeof o.options.extensions[we[He]][te]=="function"&&o.options.extensions[we[He]][te].call(o,be)}},Ve=function(){if(o.options.extensions){var te=Object.keys(o.options.extensions);if(te.length)for(var be=0;be<te.length;be++)o.options.extensions[te[be]]&&typeof o.options.extensions[te[be]]=="function"&&(o.options.extensions[te[be]]=o.options.extensions[te[be]](A,o))}};if(document.addEventListener("mouseup",je),document.addEventListener("mousemove",Ce),o.editor.addEventListener("mousedown",De),o.editor.addEventListener("keyup",Z),o.editor.addEventListener("keydown",ue),o.editor.addEventListener("dragstart",W),o.editor.addEventListener("dragenter",ne),o.editor.addEventListener("dragover",v),o.editor.addEventListener("drop",_),o.editor.addEventListener("paste",X),o.editor.addEventListener("focus",he),o.editor.addEventListener("blur",J),A.appendChild(o.editor),o.options.snippet&&o.appendSnippet(o.options.snippet),o.options.toolbar){if(Array.isArray(o.options.toolbar))var Ze={container:!0,responsive:!0,items:o.options.toolbar};else if(o.options.toolbar===!0)var Ze={container:!0,responsive:!0,items:[]};else var Ze=o.options.toolbar;Ze.items&&Ze.items.length||(Ze.items=w.getDefaultToolbar(o)),o.options.toolbarOnTop?(A.classList.add("toolbar-on-top"),A.insertBefore(K,A.firstChild)):(o.editor.style.padding="15px",A.appendChild(K)),Ke(K,Ze),K.addEventListener("click",function(){o.editor.focus()})}return o.file=document.createElement("input"),o.file.style.display="none",o.file.type="file",o.file.setAttribute("accept","image/*"),o.file.onchange=function(){o.addFile(this.files)},A.appendChild(o.file),o.options.focus&&w.setCursor(o.editor,o.options.focus=="initial"),A.change=o.setData,A.val=function(te){if(te===void 0){var be=A.getAttribute("data-html")!=="true";return o.getData(be)}else o.setData(te)},Ve(),A.editor=o,typeof o.options.onload=="function"&&o.options.onload(A,o,o.editor),o};return w.setCursor=function(A,l){A.focus(),document.execCommand("selectAll");var o=window.getSelection(),k=o.getRangeAt(0);if(l==!0)var Q=k.startContainer,ee=0;else var Q=k.endContainer,ee=Q.length;k.setStart(Q,ee),k.setEnd(Q,ee),o.removeAllRanges(),o.addRange(k)},w.getDefaultToolbar=function(A){var l=function(k,Q,ee){ee.color||(ie(ee,{onchange:function(S,M){ee.k==="color"?document.execCommand("foreColor",!1,M):document.execCommand("backColor",!1,M)}}),ee.color.open())},o=[];return o.push({content:"undo",onclick:function(){document.execCommand("undo")}}),o.push({content:"redo",onclick:function(){document.execCommand("redo")}}),o.push({type:"divisor"}),A.options.toolbarOnTop&&(o.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(k){return'<span style="font-family:'+k+'">'+k+"</span>"},onchange:function(k,Q,ee,S,M){document.execCommand("fontName",!1,S)}}),o.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(k){return'<span style="font-size:'+k+'">'+k+"</span>"},onchange:function(k,Q,ee,S,M){document.execCommand("fontSize",!1,parseInt(M)+1)}}),o.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(k){return'<i class="material-icons">'+k+"</i>"},onchange:function(k,Q,ee,S,M){var V=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(V[M])}}),o.push({type:"divisor"}),o.push({content:"format_color_text",k:"color",onclick:l}),o.push({content:"format_color_fill",k:"background-color",onclick:l})),o.push({content:"format_bold",onclick:function(k,Q,ee){document.execCommand("bold"),document.queryCommandState("bold")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({content:"format_italic",onclick:function(k,Q,ee){document.execCommand("italic"),document.queryCommandState("italic")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({content:"format_underline",onclick:function(k,Q,ee){document.execCommand("underline"),document.queryCommandState("underline")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({type:"divisor"}),o.push({content:"format_list_bulleted",onclick:function(k,Q,ee){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({content:"format_list_numbered",onclick:function(k,Q,ee){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({content:"format_indent_increase",onclick:function(k,Q,ee){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),A.options.toolbarOnTop&&(o.push({type:"divisor"}),o.push({content:"photo",onclick:function(){A.upload()}}),o.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(k,Q){Q&&(Q.onmouseover=this.onmouseover,k=k.split("x"),Q.setAttribute("data-x",k[0]),Q.setAttribute("data-y",k[1]));var ee=document.createElement("div");return Q.style.margin="1px",Q.style.border="1px solid #ddd",ee},onmouseover:function(k){for(var Q=parseInt(k.target.getAttribute("data-x")),ee=parseInt(k.target.getAttribute("data-y")),S=0;S<k.target.parentNode.children.length;S++){var M=k.target.parentNode.children[S],V=parseInt(M.getAttribute("data-x")),K=parseInt(M.getAttribute("data-y"));V<=Q&&K<=ee?(M.style.backgroundColor="#cae1fc",M.style.borderColor="#2977ff"):(M.style.backgroundColor="",M.style.borderColor="#ddd")}},onchange:function(k,Q,ee){ee=ee.split("x");for(var S=document.createElement("table"),M=document.createElement("tbody"),V=0;V<=ee[1];V++){for(var K=document.createElement("tr"),oe=0;oe<=ee[0];oe++){var ve=document.createElement("td");ve.innerHTML="",K.appendChild(ve)}M.appendChild(K)}S.appendChild(M),S.setAttribute("width","100%"),S.setAttribute("cellpadding","6"),S.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,S.outerHTML)}})),o},w}var Be=qe();function lt(){var w=function(A,l){var o={};o.options={};var k={type:"big",title:"Untitled",width:510,height:472};for(var Q in k)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=k[Q];var ee=function(){for(var V=document.createElement("div");A.children[0];)V.appendChild(A.children[0]);for(o.content=document.createElement("div"),o.content.className="jfloating_content",o.content.innerHTML=A.innerHTML;V.children[0];)o.content.appendChild(V.children[0]);o.container=document.createElement("div"),o.container.className="jfloating",o.container.appendChild(o.content),o.options.title?o.container.setAttribute("title",o.options.title):o.container.classList.add("no-title"),o.options.width&&(o.container.style.width=parseInt(o.options.width)+"px"),o.options.height&&(o.container.style.height=parseInt(o.options.height)+"px"),A.innerHTML="",A.appendChild(o.container)},S=function(){o.container&&o.container.addEventListener("click",function(V){var K=V.target.getBoundingClientRect();if(V.target.classList.contains("jfloating")){if(V.changedTouches&&V.changedTouches[0])var oe=V.changedTouches[0].clientX,ve=V.changedTouches[0].clientY;else var oe=V.clientX,ve=V.clientY;K.width-(oe-K.left)<50&&ve-K.top<50?setTimeout(function(){o.close()},100):o.setState()}})},M=function(){o.container.classList.add("jfloating-"+o.options.type)};return o.state={isMinized:!1},o.setState=function(){o.state.isMinized?o.container.classList.remove("jfloating-minimized"):o.container.classList.add("jfloating-minimized"),o.state.isMinized=!o.state.isMinized},o.close=function(){Components.elements.splice(w.elements.indexOf(o.container),1),o.updatePosition(),A.remove()},o.updatePosition=function(){for(var V=0;V<w.elements.length;V++){var K=w.elements[V],oe=w.elements[V-1];K.style.right=V*(oe?oe.offsetWidth:K.offsetWidth)*1.01+"px"}},o.init=function(){ee(),S(),M(),w.elements.push(o.container),o.updatePosition(),A.floating=o},o.init(),o};return w.elements=[],w}var Y=lt();function Le(){const w=function(S){return!isNaN(S)&&S!==null&&S!==""},A={between:function(S,M){return S>=M[0]&&S<=M[1]},"not between":function(S,M){return S<M[0]||S>M[1]},"<":function(S,M){return S<M[0]},"<=":function(S,M){return S<=M[0]},">":function(S,M){return S>M[0]},">=":function(S,M){return S>=M[0]},"=":function(S,M){return S==M[0]},"!=":function(S,M){return S!=M[0]}},l={"valid date":function(){return!0},"=":function(S,M){return S===M[0]},"!=":function(S,M){return S!==M[0]},"<":function(S,M){return S<M[0]},"<=":function(S,M){return S<=M[0]},">":function(S,M){return S>M[0]},">=":function(S,M){return S>=M[0]},between:function(S,M){return S>=M[0]&&S<=M[1]},"not between":function(S,M){return S<M[0]||S>M[1]}},o={contains:function(S,M){return S.includes(M[0])},"not contains":function(S,M){return!S.includes(M[0])},"begins with":function(S,M){return S.startsWith(M[0])},"ends with":function(S,M){return S.endsWith(M[0])},"=":function(S,M){return S===M[0]},"!=":function(S,M){return S!==M[0]},"valid email":function(S){var M=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return M.test(S)},"valid url":function(S){var M=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return M.test(S)}},k=function(S,M){return typeof k[M.type]=="function"?M.allowBlank&&S===""?!0:k[M.type](S,M):null};k.url=function(S){var M=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!M.test(S)},k.email=function(S){var M=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(S&&M.test(S))},k.required=function(S){return!!(S&&S.trim())},k.exist=function(S,M){return!!S.toString().trim()},k["not exist"]=function(S,M){return!S.toString().trim()},k.empty=function(S){return!S.toString().trim()},k.notEmpty=function(S){return!!S.toString().trim()},k.number=function(S,M){if(!w(S))return!1;if(!M||!M.criteria)return!0;if(!A[M.criteria])return!1;let V=M.value.map(function(K){return parseFloat(K)});return A[M.criteria](S,V)},k.login=function(S){let M=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(S&&M.test(S))},k.list=function(S,M){let V=typeof S;if(V!=="string"&&V!=="number")return!1;let K;return typeof M.value[0]=="string"?K=M.value[0].split(","):K=M.value[0],Array.isArray(K)?K.findIndex(function(ve){return ve==S})>-1:!1};const Q=function(){let S=new Date;return S.setHours(0,0,0,0),S},ee={"one year ago":function(){let S=Q();return S.setFullYear(S.getFullYear()-1),S},"one month ago":function(){let S=Q();return S.setMonth(S.getMonth()-1),S},"one week ago":function(){let S=Q();return S.setDate(S.getDate()-7),S},yesterday:function(){let S=Q();return S.setDate(S.getDate()-1),S},today:Q,tomorrow:function(){let S=Q();return S.setDate(S.getDate()+1),S}};return k.date=function(S,M){if(w(S)&&S>0&&S<1e6&&(S=b.numToDate(S)),new Date(S)=="Invalid Date")return!1;if(!M||!M.criteria)return!0;if(!l[M.criteria])return!1;let V=M.value.map(function(K){return typeof K=="string"&&ee[K]?ee[K]().getTime():new Date(K).getTime()});return l[M.criteria](new Date(S).getTime(),V)},k.text=function(S,M){return typeof S!="string"?!1:!M||!M.criteria?!0:o[M.criteria]?o[M.criteria](S,M.value):!1},k.textLength=function(S,M){return S=S.toString(),k.number(S.length,M)},k}var Ue=Le();function mt(){var w=function(A,l){var o={};o.options={};var k={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(M,V){alert(V)}};for(var Q in k)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=k[Q];o.options.validations||(o.options.validations={}),o.options.submitButton||(o.options.submitButton=A.querySelector("input[type=submit]")),o.options.submitButton&&o.options.url&&(o.options.submitButton.onclick=function(){o.save()}),o.options.validations.email||(o.options.validations.email=Ue.email),o.options.validations.length||(o.options.validations.length=Ue.length),o.options.validations.required||(o.options.validations.required=Ue.required),o.setUrl=function(M){o.options.url=M},o.load=function(){T({url:o.options.url,method:"GET",dataType:"json",queue:!0,success:function(M){if(typeof o.options.onbeforeload=="function"){var V=o.options.onbeforeload(A,M);V&&(M=V)}w.setElements(A,M),typeof o.options.onload=="function"&&o.options.onload(A,M)}})},o.save=function(){var M=o.validate();if(M)o.options.onerror(A,M);else{var V=w.getElements(A,!0);if(typeof o.options.onbeforesave=="function"){var V=o.options.onbeforesave(A,V);if(V===!1)return}T({url:o.options.url,method:"POST",dataType:"json",data:V,success:function(K){typeof o.options.onsave=="function"&&o.options.onsave(A,V,K)}})}},o.remove=function(){if(typeof o.options.onbeforeremove=="function"){var M=o.options.onbeforeremove(A,o);if(M===!1)return!1}T({url:o.options.url,method:"DELETE",dataType:"json",success:function(V){typeof o.options.onremove=="function"&&o.options.onremove(A,o,V),o.reset()}})};var ee=function(M){M.classList.add("error"),o.options.submitButton&&o.options.submitButton.setAttribute("disabled",!0);var V=M.getAttribute("data-error")||"There is an error in the form";return M.setAttribute("title",V),V},S=function(M){var V=!1;M.classList.remove("error"),M.removeAttribute("title");for(var K=A.querySelectorAll("input, select, textarea, div[name]"),oe=0;oe<K.length;oe++)K[oe].getAttribute("data-validation")&&K[oe].classList.contains("error")&&(V=!0);o.options.submitButton&&(V?o.options.submitButton.setAttribute("disabled",!0):o.options.submitButton.removeAttribute("disabled"))};return o.validateElement=function(M){var V=!1,K=w.getValue(M),oe=M.getAttribute("data-validation");return typeof o.options.validations[oe]=="function"&&!o.options.validations[oe](K,M)?V=ee(M):M.classList.contains("error")&&S(M),V},o.reset=function(){for(var M=A.querySelectorAll("input, select, textarea, div[name]"),V=0;V<M.length;V++)M[V].getAttribute("name")&&(M[V].type=="checkbox"||M[V].type=="radio"?M[V].checked=!1:typeof M[V].val=="function"?M[V].val(""):M[V].value="")},o.validate=function(){for(var M=[],V=A.querySelectorAll("input, select, textarea, div[name]"),K=0;K<V.length;K++)if(V[K].getAttribute("data-validation")){var oe=o.validateElement(V[K]);oe&&M.push(oe)}return M.length>0?M.join("<br>"):!1},o.getError=function(){return!!o.validation()},o.setHash=function(){return o.getHash(w.getElements(A))},o.getHash=function(M){var V=0,K,oe;if(M.length===0)return V;for(K=0;K<M.length;K++)oe=M.charCodeAt(K),V=(V<<5)-V+oe,V|=0;return V},o.isChanged=function(){var M=o.setHash();return o.options.currentHash!=M},o.resetTracker=function(){o.options.currentHash=o.setHash(),o.options.ignore=!1},o.setIgnore=function(M){o.options.ignore=!!M},setTimeout(function(){o.options.currentHash=o.setHash()},1e3),A.addEventListener("keyup",function(M){M.target.getAttribute("data-validation")&&o.validateElement(M.target)}),w.hasEvents||(window.addEventListener("beforeunload",function(M){if(o.isChanged()&&o.options.ignore==!1){var V=o.options.message?o.options.message:"o/";return V?(typeof M>"u"&&(M=window.event),M&&(M.returnValue=V),V):void 0}}),w.hasEvents=!0),A.form=o,o};return w.getValue=function(A){var l=null;if(A.type=="checkbox")A.checked==!0&&(l=A.value||!0);else if(A.type=="radio")A.checked==!0&&(l=A.value);else if(A.type=="file")l=A.files;else if(A.tagName=="select"&&A.multiple==!0){l=[];for(var o=A.querySelectorAll("options[selected]"),k=0;k<o.length;k++)l.push(o[k].value)}else typeof A.val=="function"?l=A.val():l=A.value||"";return l},w.getElements=function(A,l){for(var o={},k=null,Q=A.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<Q.length;ee++)(k=Q[ee].getAttribute("name"))&&(o[k]=w.getValue(Q[ee])||"");return l==!0?o:JSON.stringify(o)},w.setElements=function(A,l){for(var o=null,k=null,Q=A.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<Q.length;ee++){var S=Q[ee].getAttribute("type");if(o=Q[ee].getAttribute("name")){if(o=o.replace(new RegExp(/\[(.*?)\]/ig),".$1"),k=null,o.match(/\./)){var M=m.call(l,o)||"";typeof M<"u"&&(k=M)}else typeof l[o]<"u"&&(k=l[o]);k!==null&&(S=="checkbox"||S=="radio"?Q[ee].checked=!!k:S=="file"||(typeof Q[ee].val=="function"?Q[ee].val(k):Q[ee].value=k))}}},w}var Me=mt();function Ie(){var w=function(){var l=null,o=function(S){if(S.which==27)for(var M=document.querySelectorAll(".jmodal"),V=0;V<M.length;V++)M[V].parentNode.modal.close()},k=function(S){let M=S.composedPath();var V=d.findElement(M[0],"jmodal");if(V){var K=V.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0])var oe=S.changedTouches[0].clientX,ve=S.changedTouches[0].clientY;else var oe=S.clientX,ve=S.clientY;K.width-(oe-K.left)<50&&ve-K.top<50&&V.parentNode.modal.close()}l&&(l.element.style.cursor="auto",l=null)},Q=function(S){let M=S.composedPath();var V=d.findElement(M[0],"jmodal");if(V){var K=V.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0])var oe=S.changedTouches[0].clientX,ve=S.changedTouches[0].clientY;else var oe=S.clientX,ve=S.clientY;K.width-(oe-K.left)<50&&ve-K.top<50||ve-K.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),l={left:K.left,top:K.top,x:S.clientX,y:S.clientY,width:K.width,height:K.height,element:V})}},ee=function(S){if(l){if(S=S||window.event,S.buttons)var M=S.buttons;else if(S.button)var M=S.button;else var M=S.which;M?(l.element.style.top=l.top+(S.clientY-l.y)+l.height/2+"px",l.element.style.left=l.left+(S.clientX-l.x)+l.width/2+"px",l.element.style.cursor="move"):l.element.style.cursor="auto"}};document.addEventListener("keydown",o),document.addEventListener("mouseup",k),document.addEventListener("mousedown",Q),document.addEventListener("mousemove",ee)},A=function(l,o){var k={};k.options={};var Q={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ee in Q)o&&o.hasOwnProperty(ee)?k.options[ee]=o[ee]:k.options[ee]=Q[ee];!k.options.title&&l.getAttribute("title")&&(k.options.title=l.getAttribute("title"));for(var S=document.createElement("div");l.children[0];)S.appendChild(l.children[0]);for(k.title=document.createElement("div"),k.title.className="jmodal_title",k.options.icon&&k.title.setAttribute("data-icon",k.options.icon),k.content=document.createElement("div"),k.content.className="jmodal_content",k.content.innerHTML=l.innerHTML;S.children[0];)k.content.appendChild(S.children[0]);if(k.container=document.createElement("div"),k.container.className="jmodal",k.container.appendChild(k.title),k.container.appendChild(k.content),k.options.padding&&(k.content.style.padding=k.options.padding),k.options.width&&(k.container.style.width=k.options.width),k.options.height&&(k.container.style.height=k.options.height),k.options.title){var M=document.createElement("h4");M.innerText=k.options.title,k.title.appendChild(M)}if(l.innerHTML="",l.style.display="none",l.appendChild(k.container),k.options.backdrop){var V=document.createElement("div");V.className="jmodal_backdrop",V.onclick=function(){k.close()},l.appendChild(V)}return k.open=function(){l.style.display="block";var K=k.container.getBoundingClientRect();d.getWindowWidth()<K.width?(k.container.style.top="",k.container.style.left="",k.container.classList.add("jmodal_fullscreen"),B.slideBottom(k.container,1)):k.options.backdrop&&(V.style.display="block"),typeof k.options.onopen=="function"&&k.options.onopen(l,k)},k.resetPosition=function(){k.container.style.top="",k.container.style.left=""},k.isOpen=function(){return l.style.display!="none"},k.close=function(){k.isOpen()&&(l.style.display="none",k.options.backdrop&&(V.style.display=""),k.container.classList.remove("jmodal_fullscreen"),typeof k.options.onclose=="function"&&k.options.onclose(l,k))},k.options.url?T({url:k.options.url,method:"GET",dataType:"text/html",success:function(K){k.content.innerHTML=K,k.options.closed||k.open(),typeof k.options.onload=="function"&&k.options.onload(k)}}):(k.options.closed||k.open(),typeof k.options.onload=="function"&&k.options.onload(k)),l.modal=k,w(),w=function(){},k};return A}var Oe=Ie();function ze(){var w=function(A){var l={};l.options={};var o={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var k in o)A&&A.hasOwnProperty(k)?l.options[k]=A[k]:l.options[k]=o[k];var Q=document.createElement("div");Q.className="jnotification",l.options.error&&Q.classList.add("jnotification-error");var ee=document.createElement("div");ee.className="jnotification-container",Q.appendChild(ee);var S=document.createElement("div");S.className="jnotification-header",ee.appendChild(S);var M=document.createElement("div");if(M.className="jnotification-image",S.appendChild(M),l.options.icon){var V=document.createElement("img");V.src=l.options.icon,M.appendChild(V)}var K=document.createElement("div");if(K.className="jnotification-name",K.innerHTML=l.options.name,S.appendChild(K),l.options.closeable==!0){var oe=document.createElement("div");oe.className="jnotification-close",oe.onclick=function(){l.hide()},S.appendChild(oe)}var ve=document.createElement("div");ve.className="jnotification-date",S.appendChild(ve);var de=document.createElement("div");if(de.className="jnotification-content",ee.appendChild(de),l.options.title){var fe=document.createElement("div");fe.className="jnotification-title",fe.innerHTML=l.options.title,de.appendChild(fe)}var le=document.createElement("div");if(le.className="jnotification-message",le.innerHTML=l.options.message,de.appendChild(le),l.show=function(){document.body.appendChild(Q),d.getWindowWidth()>800?B.fadeIn(Q):B.slideTop(Q,1)},l.hide=function(){d.getWindowWidth()>800?B.fadeOut(Q,function(){Q.parentNode&&(Q.parentNode.removeChild(Q),me&&clearTimeout(me))}):B.slideTop(Q,0,function(){Q.parentNode&&(Q.parentNode.removeChild(Q),me&&clearTimeout(me))})},l.show(),l.options.autoHide==!0)var me=setTimeout(function(){l.hide()},l.options.timeout);return d.getWindowWidth()<800&&Q.addEventListener("swipeup",function(Ne){l.hide(),Ne.preventDefault(),Ne.stopPropagation()}),l};return w.isVisible=function(){var A=document.querySelector(".jnotification");return!!(A&&A.parentNode)},w}var Ge=ze();function Qe(w,A){var l={};l.options={};var o={value:0,onchange:null,width:null};for(var k in o)A&&A.hasOwnProperty(k)?l.options[k]=A[k]:l.options[k]=o[k];w.classList.add("jprogressbar"),w.setAttribute("tabindex",1),w.setAttribute("data-value",l.options.value);var Q=document.createElement("div");Q.style.width=l.options.value+"%",Q.style.color="#fff",w.appendChild(Q),l.options.width&&(w.style.width=l.options.width),l.setValue=function(S){S=parseInt(S),l.options.value=S,Q.style.width=S+"%",w.setAttribute("data-value",S+"%"),S<6?w.style.color="#000":w.style.color="#fff",l.options.value=S,typeof l.options.onchange=="function"&&l.options.onchange(w,S),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},l.getValue=function(){return l.options.value};var ee=function(S){if(S.which){var M=w.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0]){var V=S.changedTouches[0].clientX;S.changedTouches[0].clientY}else{var V=S.clientX;S.clientY}l.setValue(Math.round((V-M.left)/M.width*100))}};return"touchstart"in document.documentElement?(w.addEventListener("touchstart",ee),w.addEventListener("touchend",ee)):(w.addEventListener("mousedown",ee),w.addEventListener("mousemove",ee)),w.change=l.setValue,w.val=function(S){if(S===void 0)return l.getValue();l.setValue(S)},w.progressbar=l,l}function ct(w,A){if(w.rating)return w.rating.setOptions(A,!0);var l={};l.options={},l.setOptions=function(k,Q){var ee={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var S in ee)k&&k.hasOwnProperty(S)?l.options[S]=k[S]:(typeof l.options[S]>"u"||Q===!0)&&(l.options[S]=ee[S]);w.innerHTML="";for(var M=0;M<l.options.number;M++){var V=document.createElement("div");V.setAttribute("data-index",M+1),V.setAttribute("title",l.options.tooltip[M]),w.appendChild(V)}if(l.options.value)for(var M=0;M<l.options.number;M++)M<l.options.value&&w.children[M].classList.add("jrating-selected");return l},l.setValue=function(k){for(var Q=0;Q<l.options.number;Q++)Q<k?w.children[Q].classList.add("jrating-selected"):(w.children[Q].classList.remove("jrating-over"),w.children[Q].classList.remove("jrating-selected"));l.options.value=k,typeof l.options.onchange=="function"&&l.options.onchange(w,k),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},l.getValue=function(){return l.options.value};var o=function(){l.setOptions(A),w.classList.add("jrating"),w.addEventListener("click",function(k){var Q=k.target.getAttribute("data-index");Q!=null&&(Q==l.options.value?l.setValue(0):l.setValue(Q))}),w.addEventListener("mouseover",function(k){for(var Q=k.target.getAttribute("data-index"),ee=0;ee<l.options.number;ee++)ee<Q?w.children[ee].classList.add("jrating-over"):w.children[ee].classList.remove("jrating-over")}),w.addEventListener("mouseout",function(k){for(var Q=0;Q<l.options.number;Q++)w.children[Q].classList.remove("jrating-over")}),w.change=l.setValue,w.val=function(k){if(k===void 0)return l.getValue();l.setValue(k)},w.rating=l};return o(),l}function at(w,A){if(w.search)return w.search;var l=null,o=function(V){if(V.target.classList.contains("jsearch_item"))var K=V.target;else var K=V.target.parentNode;S.selectIndex(K),V.preventDefault()},k=function(V){if(typeof S.options.onsearch=="function"){var K=S.options.onsearch(S,V);K&&(V=K)}if(M.innerHTML="",!V.length)w.style.display="";else{w.style.display="block";for(var oe=V.length<11?V.length:10,ve=0;ve<oe;ve++){if(typeof V[ve]=="string")var de=V[ve],fe=V[ve];else{var de=V[ve].text;!de&&V[ve].name&&(de=V[ve].name);var fe=V[ve].value;!fe&&V[ve].id&&(fe=V[ve].id)}var le=document.createElement("div");le.setAttribute("data-value",fe),le.setAttribute("data-text",de),le.className="jsearch_item",V[ve].id&&le.setAttribute("id",V[ve].id),S.options.forceSelect&&ve==0&&le.classList.add("selected");var me=document.createElement("img");V[ve].image?me.src=V[ve].image:me.style.display="none",le.appendChild(me);var Ne=document.createElement("div");Ne.innerHTML=de,le.appendChild(Ne),M.appendChild(le)}}},Q=function(V){if(V!=S.terms)if(S.terms=V,S.options.forceSelect?l=0:l=null,Array.isArray(S.options.data)){var K=function(ve){if(typeof ve=="string"){if((""+ve).toLowerCase().search(V.toLowerCase())>=0)return!0}else for(var de in ve){var fe=ve[de];if((""+fe).toLowerCase().search(V.toLowerCase())>=0)return!0}return!1},oe=S.options.data.filter(function(ve){return K(ve)});k(oe)}else T({url:S.options.data+V,method:"GET",dataType:"json",success:function(ve){k(ve)}})},ee=null,S=function(V){ee&&clearTimeout(ee),ee=setTimeout(function(){Q(V)},500)};A.forceSelect===null&&(A.forceSelect=!0),S.options={data:A.data||null,input:A.input||null,searchByNode:A.searchByNode||null,onselect:A.onselect||null,forceSelect:A.forceSelect,onsearch:A.onsearch||null,onbeforesearch:A.onbeforesearch||null},S.selectIndex=function(V){var K=V.getAttribute("id"),oe=V.getAttribute("data-text"),ve=V.getAttribute("data-value"),de=V.children[0].src||"";typeof S.options.onselect=="function"&&S.options.onselect(S,oe,ve,K,de),S.close()},S.open=function(){w.style.display="block"},S.close=function(){ee&&clearTimeout(ee),S.terms="",M.innerHTML="",w.style.display=""},S.isOpened=function(){return!!w.style.display},S.keydown=function(V){S.isOpened()&&(V.key=="Enter"?l!==null&&M.children[l]?(S.selectIndex(M.children[l]),V.preventDefault()):S.close():V.key==="ArrowUp"?(l!==null&&M.children[0]&&(M.children[l].classList.remove("selected"),!S.options.forceSelect&&l===0?l=null:(l=Math.max(0,l-1),M.children[l].classList.add("selected"))),V.preventDefault()):V.key==="ArrowDown"&&(l==null?l=-1:M.children[l].classList.remove("selected"),l<9&&M.children[l+1]&&l++,M.children[l].classList.add("selected"),V.preventDefault()))},S.keyup=function(V){if(!S.options.searchByNode&&S.options.input)if(S.options.input.tagName==="DIV")var K=S.options.input.innerText;else var K=S.options.input.value;else{var oe=d.getNode();if(oe)var K=oe.innerText}if(typeof S.options.onbeforesearch=="function"){var ve=S.options.onbeforesearch(S,K);if(ve)K=ve;else if(ve===!1)return}S(K)},S.blur=function(V){S.close()},S.options.input&&(S.options.input.addEventListener("keyup",S.keyup),S.options.input.addEventListener("keydown",S.keydown),S.options.input.addEventListener("blur",S.blur));var M=document.createElement("div");return M.classList.add("jsearch_container"),M.onmousedown=o,w.appendChild(M),w.classList.add("jsearch"),w.search=S,S}function dt(w,A){var l={};if(l.options={},l.currentImage=null,A&&(l.options=A),w.setAttribute("tabindex","900"),l.options.items=[],!w.classList.contains("jslider")){if(w.classList.add("jslider"),w.classList.add("unselectable"),l.options.height&&(w.style.minHeight=parseInt(l.options.height)+"px"),l.options.width&&(w.style.width=parseInt(l.options.width)+"px"),l.options.grid){w.classList.add("jslider-grid");var o=w.children.length;o>4&&w.setAttribute("data-total",o-4),w.setAttribute("data-number",o>4?4:o)}var k=document.createElement("div");if(k.classList.add("jslider-counter"),w.children.length>0)for(var Q=0;Q<w.children.length;Q++){l.options.items.push(w.children[Q]);var ee=document.createElement("div");ee.onclick=function(){var oe=Array.prototype.slice.call(k.children).indexOf(this);l.show(l.currentImage=l.options.items[oe])},k.appendChild(ee)}var S=document.createElement("div");S.className="jslider-caption";var M=document.createElement("div"),V=document.createElement("div");V.className="jslider-close",V.innerHTML="",V.onclick=function(){l.close()},M.appendChild(S),M.appendChild(V)}l.updateCounter=function(oe){for(var ve=0;ve<k.children.length;ve++)if(k.children[ve].classList.contains("jslider-counter-focus")){k.children[ve].classList.remove("jslider-counter-focus");break}k.children[oe].classList.add("jslider-counter-focus")},l.show=function(oe){if(!oe)var oe=w.children[0];w.classList.add("jslider-focus"),w.classList.remove("jslider-grid"),w.appendChild(M),w.appendChild(k);var ve=l.options.items.indexOf(oe);l.updateCounter(ve);for(var de=0;de<w.children.length;de++)w.children[de].style.display="";oe.style.display="block",oe.previousElementSibling?w.classList.add("jslider-left"):w.classList.remove("jslider-left"),oe.nextElementSibling&&oe.nextElementSibling.tagName=="IMG"?w.classList.add("jslider-right"):w.classList.remove("jslider-right"),l.currentImage=oe,l.currentImage.offsetHeight>l.currentImage.offsetWidth&&l.currentImage.classList.add("jslider-vertical"),M.children[0].innerText=l.currentImage.getAttribute("title")},l.open=function(){l.show(),typeof l.options.onopen=="function"&&l.options.onopen(w)},l.close=function(){w.classList.remove("jslider-focus"),w.classList.remove("jslider-left"),w.classList.remove("jslider-right"),l.options.grid&&w.classList.add("jslider-grid");for(var oe=0;oe<w.children.length;oe++)w.children[oe].style.display="";k.remove(),M.remove(),l.currentImage=null,typeof l.options.onclose=="function"&&l.options.onclose(w)},l.reset=function(){w.innerHTML=""},l.next=function(){var oe=l.currentImage.nextElementSibling;oe&&oe.tagName==="IMG"&&l.show(l.currentImage.nextElementSibling)},l.prev=function(){l.currentImage.previousElementSibling&&l.show(l.currentImage.previousElementSibling)};var K=function(oe){if(oe.target.tagName=="IMG")l.show(oe.target);else if(!oe.target.classList.contains("jslider-close")&&!(oe.target.parentNode.classList.contains("jslider-counter")||oe.target.classList.contains("jslider-counter"))){var ve=oe.offsetX||oe.changedTouches[0].clientX;oe.target.clientWidth-ve<40?l.next():ve<40&&l.prev()}};return"ontouchend"in document.documentElement?w.addEventListener("touchend",K):w.addEventListener("mouseup",K),w.addEventListener("swipeleft",function(oe){l.next(),oe.preventDefault(),oe.stopPropagation()}),w.addEventListener("swiperight",function(oe){l.prev(),oe.preventDefault(),oe.stopPropagation()}),w.addEventListener("keydown",function(oe){oe.which==27&&l.close()}),w.slider=l,l}function vt(w,A){if(w.tags)return w.tags.setOptions(A,!0);var l={type:"tags"};l.options={};var o=function(){return!!(l.options.limit&&w.children.length>=l.options.limit)},k=null,Q=null;l.setOptions=function(ce,Ae){var X={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var W in X)ce&&ce.hasOwnProperty(W)?l.options[W]=ce[W]:(typeof l.options[W]>"u"||Ae===!0)&&(l.options[W]=X[W]);return l.options.placeholder?w.setAttribute("data-placeholder",l.options.placeholder):w.removeAttribute("data-placeholder"),w.placeholder=l.options.placeholder,l.setValue(l.options.value),V(),l.options.search?Q||(Q=document.createElement("div"),w.parentNode.insertBefore(Q,w.nextSibling),k=at(Q,{data:l.options.search,onselect:function(ne,v,_){l.selectIndex(v,_)}})):Q&&(k=null,Q.remove(),Q=null),l},l.add=function(ce,Ae){if(typeof l.options.onbeforechange=="function"){var X=l.options.onbeforechange(w,l,l.options.value,ce);if(X===!1)return!1;X!=null&&(ce=X)}if(k&&k.close(),o())typeof l.options.onlimit=="function"?l.options.onlimit(l,l.options.limit):alert(g.translate("You reach the limit number of entries")+" "+l.options.limit);else{var W=d.getNode();if(W&&W.parentNode&&W.parentNode.classList.contains("jtags")&&W.nextSibling&&!(W.nextSibling.innerText&&W.nextSibling.innerText.trim()))ne=W.nextSibling;else{if(w.lastChild&&(w.lastChild.innerText.trim()||w.removeChild(w.lastChild)),!ce||typeof ce=="string")var ne=S(ce,ce,W);else for(var v=0;v<=ce.length;v++)if(!o()){if(!ce[v]||typeof ce[v]=="string")var _=ce[v]||"",J=null;else var _=ce[v].text,J=ce[v].value;var ne=S(_,J)}M()}Ae&&ee(ne)}},l.setLimit=function(ce){for(l.options.limit=ce,w.children.length-ce;w.children.length>ce;)w.removeChild(w.lastChild)},l.remove=function(ce){ce.parentNode.removeChild(ce),w.children.length?M():l.add("",!0)},l.getData=function(){for(var ce=[],Ae=0;Ae<w.children.length;Ae++){var X=w.children[Ae].innerText.replace(`
`,""),W=w.children[Ae].getAttribute("data-value");W||(W=X),(X||W)&&ce.push({text:X,value:W})}return ce},l.getValue=function(ce){var Ae=null;if(ce!=null)Ae=w.children[ce].getAttribute("data-value"),Ae||(Ae=w.children[ce].innerText.replace(`
`,""));else{for(var X=[],W=0;W<w.children.length;W++)Ae=w.children[W].innerText.replace(`
`,""),Ae&&X.push(l.getValue(W));Ae=X.join(",")}return Ae},l.setValue=function(ce){if(!ce)l.reset();else if(w.value!=ce)if(Array.isArray(ce))l.add(ce);else{var Ae=(""+ce).trim(),X=oe(Ae);w.innerHTML="",l.add(X)}},l.reset=function(){w.classList.add("jtags-empty"),w.innerHTML="<div></div>",M()},l.isValid=function(){for(var ce=0,Ae=0;Ae<w.children.length;Ae++)w.children[Ae].classList.contains("jtags_error")&&ce++;return ce==0},l.selectIndex=function(ce,Ae){var X=d.getNode();X&&(X.innerText=ce,Ae&&X.setAttribute("data-value",Ae),X.classList.remove("jtags_error"),o()||l.add("",!0))},l.search=function(ce){ce.innerText},l.destroy=function(){w.removeEventListener("mouseup",me),w.removeEventListener("keydown",de),w.removeEventListener("keyup",fe),w.removeEventListener("paste",le),w.removeEventListener("focus",Ne),w.removeEventListener("blur",We),w.parentNode.removeChild(w)};var ee=function(ce){if(w.children.length){var Ae=document.createRange(),X=window.getSelection();if(!ce)var ce=w.childNodes[w.childNodes.length-1];Ae.setStart(ce,ce.length),Ae.collapse(!0),X.removeAllRanges(),X.addRange(Ae),w.scrollLeft=w.scrollWidth}},S=function(ce,Ae,X){var W=document.createElement("div");return W.innerHTML=ce||"",Ae&&W.setAttribute("data-value",Ae),X&&X.parentNode.classList.contains("jtags")?w.insertBefore(W,X.nextSibling):w.appendChild(W),W},M=function(){var ce=l.getValue();ce!=l.options.value&&(l.options.value=ce,typeof l.options.onchange=="function"&&l.options.onchange(w,l,l.options.value),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))),V()},V=function(){for(var ce=0;ce<w.children.length;ce++)w.children[ce].tagName==="DIV"&&(l.getValue(ce)?(w.children[ce].classList.add("jtags_label"),typeof l.options.validation=="function"&&l.getValue(ce)?l.options.validation(w.children[ce],w.children[ce].innerText,w.children[ce].getAttribute("data-value"))?w.children[ce].classList.remove("jtags_error"):w.children[ce].classList.add("jtags_error"):w.children[ce].classList.remove("jtags_error")):w.children[ce].classList.remove("jtags_label"));K()},K=function(){w.innerText.trim()?w.classList.remove("jtags-empty"):(!w.children.length||w.children[0].tagName==="BR")&&(w.innerHTML="",ee(S()))},oe=function(ce){var Ae=[],X="";if(ce=ce.trim(),ce){for(var W=0;W<ce.length;W++)ce[W]==","||ce[W]==";"||ce[W]==`
`?X&&(Ae.push(X.trim()),X=""):X+=ce[W];X&&Ae.push(X)}return Ae},ve=0,de=function(ce){if(ve=window.getSelection().anchorOffset,K(),ce.key==="Tab"||ce.key===";"||ce.key===","){var Ae=window.getSelection().anchorOffset;Ae>1&&(o()?typeof l.options.onlimit=="function"&&l.options.onlimit(l,l.options.limit):l.add("",!0)),ce.preventDefault()}else if(ce.key=="Enter"){if(!k||!k.isOpened()){var Ae=window.getSelection().anchorOffset;Ae>1&&(o()||l.add("",!0)),ce.preventDefault()}}else ce.key=="Backspace"&&w.children.length==1&&window.getSelection().anchorOffset<1&&ce.preventDefault();k&&k.keydown(ce),K()},fe=function(ce){if(ce.which==39){var Ae=window.getSelection().anchorOffset;Ae>1&&Ae==ve&&l.add("",!0)}else ce.which==13||ce.which==38||ce.which==40?ce.preventDefault():k&&k.keyup(ce);V()},le=function(ce){if(ce.clipboardData||ce.originalEvent.clipboardData)var Ae=(ce.originalEvent||ce).clipboardData.getData("text/plain");else if(window.clipboardData)var Ae=window.clipboardData.getData("Text");var X=oe(Ae);if(typeof l.options.onbeforepaste=="function"){var W=l.options.onbeforepaste(w,l,X);if(W===!1)return ce.preventDefault(),!1;W&&(X=W)}X.length>1?(l.add(X,!0),ce.preventDefault()):X[0]&&(document.execCommand("insertText",!1,X[0]),ce.preventDefault())},me=function(ce){if(ce.target.parentNode&&ce.target.parentNode.classList.contains("jtags")&&(ce.target.classList.contains("jtags_label")||ce.target.classList.contains("jtags_error"))){var Ae=ce.target.getBoundingClientRect();Ae.width-(ce.clientX-Ae.left)<16&&l.remove(ce.target)}ce.target==w&&ee()},Ne=function(){w.classList.contains("jtags-focus")||((!w.children.length||l.getValue(w.children.length-1))&&(o()||S("")),typeof l.options.onfocus=="function"&&l.options.onfocus(w,l,l.getValue()),w.classList.add("jtags-focus"))},We=function(){if(w.classList.contains("jtags-focus")){k&&k.close();for(var ce=0;ce<w.children.length-1;ce++)l.getValue(ce)||w.removeChild(w.children[ce]);M(),w.classList.remove("jtags-focus"),typeof l.options.onblur=="function"&&l.options.onblur(w,l,l.getValue())}},Je=function(){"touchend"in document.documentElement?w.addEventListener("touchend",me):w.addEventListener("mouseup",me),w.addEventListener("keydown",de),w.addEventListener("keyup",fe),w.addEventListener("paste",le),w.addEventListener("focus",Ne),w.addEventListener("blur",We),w.setAttribute("contenteditable",!0),w.classList.add("jtags"),l.setOptions(A),typeof l.options.onload=="function"&&l.options.onload(w,l),w.change=l.setValue,w.val=function(ce){if(ce===void 0)return l.getValue();l.setValue(ce)},w.tags=l};return Je(),l}function ht(w,A){var l={};l.options={};var o={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var k in o)A&&A.hasOwnProperty(k)?l.options[k]=A[k]:l.options[k]=o[k];l.options.multiple==!0&&w.setAttribute("data-multiple",!0),w.content=[],w.classList.add("jupload"),l.options.input==!0&&w.classList.add("input"),l.add=function(M){if(l.options.multiple==!1&&(w.content=[],w.innerText=""),l.options.type=="image"){var V=document.createElement("img");V.setAttribute("src",M.file),V.setAttribute("tabindex",-1),w.getAttribute("name")||(V.className="jfile",V.content=M),w.appendChild(V)}else{if(M.name)var K=M.name;else var K=M.file;var oe=document.createElement("div");oe.innerText=K||l.options.type,oe.classList.add("jupload-item"),oe.setAttribute("tabindex",-1),w.appendChild(oe)}M.content&&(M.file=d.guid()),w.content.push(M),typeof l.options.onchange=="function"&&l.options.onchange(w,M)},l.addFromFile=function(M){var V=M.type.split("/");if(V[0]==l.options.type){var K=new FileReader;K.addEventListener("load",function(oe){var ve={file:oe.srcElement.result,extension:M.name.substr(M.name.lastIndexOf(".")+1),name:M.name,size:M.size,lastmodified:M.lastModified,content:oe.srcElement.result};l.add(ve)}),K.readAsDataURL(M)}else alert(g.translate("This extension is not allowed"))},l.addFromUrl=function(M){if(M.substr(0,4)!="data"&&!l.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(M.substr(0,4)=="data"){var V=M.split(";");V=V[0].split("/");var K=V[0].replace("data:","");if(K==l.options.type){var oe={file:M,name:"",extension:V[1],content:M};l.add(oe)}else alert(l.options.text.extensionNotAllowed)}else{var V=M.substr(M.lastIndexOf(".")+1);M=l.options.remoteParser+M,T({url:M,type:"GET",dataType:"blob",success:function(de){}})}};var Q=l.options.type+"/"+l.options.extension,ee=document.createElement("input");ee.type="file",ee.setAttribute("accept",Q),ee.onchange=function(){for(var M=0;M<this.files.length;M++)l.addFromFile(this.files[M])},l.options.multiple==!0&&ee.setAttribute("multiple",!0);var S=null;return w.addEventListener("click",function(M){S=null,!w.children.length||M.target===w?d.click(ee):M.target.parentNode==w&&(S=M.target)}),w.addEventListener("dblclick",function(M){d.click(ee)}),w.addEventListener("dragenter",function(M){w.style.border="1px dashed #000"}),w.addEventListener("dragleave",function(M){w.style.border="1px solid #eee"}),w.addEventListener("dragstop",function(M){w.style.border="1px solid #eee"}),w.addEventListener("dragover",function(M){M.preventDefault()}),w.addEventListener("keydown",function(M){if(S&&M.which==46){var V=Array.prototype.indexOf.call(w.children,S);V>=0&&(w.content.splice(V,1),S.remove(),S=null)}}),w.addEventListener("drop",function(M){M.preventDefault(),M.stopPropagation();var V=(M.originalEvent||M).dataTransfer.getData("text/html"),K=(M.originalEvent||M).dataTransfer.files;if(K.length)for(var oe=0;oe<M.dataTransfer.files.length;oe++)l.addFromFile(M.dataTransfer.files[oe]);else if(V){l.options.multiple==!1&&(w.innerText="");var ve=document.createElement("div");ve.innerHTML=V;var de=ve.querySelectorAll("img");if(de.length)for(var oe=0;oe<de.length;oe++)l.addFromUrl(de[oe].src)}return w.style.border="1px solid #eee",!1}),w.val=function(M){if(M===void 0)return w.content&&w.content.length?w.content:null;if(w.innerText="",w.content=[],M)if(Array.isArray(M))for(var V=0;V<M.length;V++)typeof M[V]=="string"?l.add({file:M[V]}):l.add(M[V]);else typeof M=="string"&&l.add({file:M})},w.upload=w.image=l,l}var St=E(195),Ft=E.n(St),ft={...g,...d,version:"5.1.0",setExtensions:function(w){if(typeof w=="object")for(var A=Object.keys(w),l=0;l<A.length;l++)ft[A[l]]=w[A[l]]},tracking:u,path:m,sorting:j,lazyLoading:h,ajax:T,animation:B,calendar:G,color:ie,contextmenu:Te,dropdown:ae,editor:Be,floating:Y,form:Me,mask:N,modal:Oe,notification:Ge,palette:se,picker:ke,progressbar:Qe,rating:ct,search:at,slider:dt,tabs:ge,tags:vt,toolbar:Ke,upload:ht,validations:Ue};ft.image=ht,ft.image.create=function(w){var A=document.createElement("img");return A.setAttribute("src",w.file),A.className="jfile",A.setAttribute("tabindex",-1),A.content=w,A},ft.tracker=Me,ft.loading=B.loading,ft.sha512=Ft();const Ot=function(){document.jsuitesComponents=[];const w=function(le,me){return le[me.type]&&le[me.type]==me||le.component&&le.component==me?!0:le.parentNode?w(le.parentNode,me):!1},A=function(le){if(document.jsuitesComponents&&document.jsuitesComponents.length>0)for(var me=0;me<document.jsuitesComponents.length;me++)document.jsuitesComponents[me]&&!w(le,document.jsuitesComponents[me])&&document.jsuitesComponents[me].close()};let l=15,o=null,k=!1,Q={x:null,y:null},ee=document.createElement("div");ee.classList.add("jtooltip");const S=function(le){var me=ft.findElement(le.target,"jpanel");if(me&&!me.classList.contains("readonly")){me.focus();var Ne=le.target.getBoundingClientRect();k={e:me,x:le.clientX,y:le.clientY,w:Ne.width,h:Ne.height,d:me.style.cursor,resizing:!!me.style.cursor,actioned:!1},me.style.width||(me.style.width=Ne.width+"px"),me.style.height||(me.style.height=Ne.height+"px");var We=window.getSelection();if(We.rangeCount)for(var Je=0;Je<We.rangeCount;Je++)We.removeRange(We.getRangeAt(Je));le.preventDefault(),le.stopPropagation()}else k=!1;if(le.changedTouches&&le.changedTouches[0])var ce=le.changedTouches[0].clientX,Ae=le.changedTouches[0].clientY;else var ce=le.clientX,Ae=le.clientY;var X=le.path||le.composedPath&&le.composedPath();if(X)o=X[0];else{if(le.target&&le.target.shadowRoot)var W=le.target.shadowRoot;else var W=document;o=W.elementFromPoint(ce,Ae)}A(o)},M=function(le){k&&k.e&&(typeof k.e.refresh=="function"&&Q.actioned&&k.e.refresh(),k.e.style.cursor=""),Q={x:null,y:null},k=!1},V=function(le){if(k){var me=le.clientX||le.pageX,Ne=le.clientY||le.pageY;if(k.resizing){var X=null,W=null;if(k.d=="e-resize"||k.d=="ne-resize"||k.d=="se-resize")if(X=k.w+(me-k.x),k.e.style.width=X+"px",le.shiftKey){var ne=(me-k.x)*(k.h/k.w);W=k.h+ne,k.e.style.height=W+"px"}else var ne=!1;ne||(k.d=="s-resize"||k.d=="se-resize"||k.d=="sw-resize")&&(W=k.h+(Ne-k.y),k.e.style.height=W+"px"),typeof k.e.refresh=="function"&&(Q.actioned=!0,k.e.refresh("dimensions",X,W))}else{Q.x==null&&Q.y==null&&(Q.x=me,Q.y=Ne);var We=me-Q.x,Je=Ne-Q.y,ce=k.e.offsetTop+Je,Ae=k.e.offsetLeft+We;k.e.style.top=ce+"px",k.e.style.left=Ae+"px",k.e.style.cursor="move",Q.x=me,Q.y=Ne,typeof k.e.refresh=="function"&&(Q.actioned=!0,k.e.refresh("position",ce,Ae))}}else{var v=ft.findElement(le.target,"jpanel");if(v&&v.getAttribute("tabindex")){var _=v.getBoundingClientRect();le.clientY-_.top<l?_.width-(le.clientX-_.left)<l?v.style.cursor="ne-resize":le.clientX-_.left<l?v.style.cursor="nw-resize":v.style.cursor="n-resize":_.height-(le.clientY-_.top)<l?_.width-(le.clientX-_.left)<l?v.style.cursor="se-resize":le.clientX-_.left<l?v.style.cursor="sw-resize":v.style.cursor="s-resize":_.width-(le.clientX-_.left)<l?v.style.cursor="e-resize":le.clientX-_.left<l?v.style.cursor="w-resize":v.style.cursor=""}}},K=function(le){var me=le.target.getAttribute("data-tooltip");if(me){if(ee.innerText=me,le.changedTouches&&le.changedTouches[0])var Ne=le.changedTouches[0].clientX,We=le.changedTouches[0].clientY;else var Ne=le.clientX,We=le.clientY;ee.style.top=We+"px",ee.style.left=Ne+"px",document.body.appendChild(ee)}else ee.innerText&&(ee.innerText="",document.body.removeChild(ee))},oe=function(le){var me=ft.findElement(le.target,"jpanel");me&&typeof me.dblclick=="function"&&me.dblclick(le)},ve=function(le){var me=document.activeElement;if(me&&typeof me.contextmenu=="function")me.contextmenu(le),le.preventDefault(),le.stopImmediatePropagation();else if(me=ft.findElement(le.target,function(We){return We.tagName&&We.getAttribute("aria-contextmenu-id")}),me){var Ne=document.querySelector("#"+me);Ne?(Ne.contextmenu.open(le),le.preventDefault(),le.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+me)}},de=function(le){let me=document.activeElement;me&&le.key==="Delete"&&typeof me.delete=="function"&&(me.delete(),le.preventDefault(),le.stopImmediatePropagation()),document.jsuitesComponents&&document.jsuitesComponents.length&&(me=document.jsuitesComponents[document.jsuitesComponents.length-1],me&&le.key==="Escape"&&typeof me.isOpened=="function"&&typeof me.close=="function"&&me.isOpened()&&(me.close(),le.preventDefault(),le.stopImmediatePropagation()))},fe=function(le){(le.target.getAttribute("data-mask")||le.target.mask)&&ft.mask(le)};document.addEventListener("mouseup",M),document.addEventListener("mousedown",S),document.addEventListener("mousemove",V),document.addEventListener("mouseover",K),document.addEventListener("dblclick",oe),document.addEventListener("keydown",de),document.addEventListener("contextmenu",ve),document.addEventListener("input",fe)};typeof document<"u"&&!document.jsuitesComponents&&Ot();var Nt=ft}(),D=D.default,D}()})}(jsuites)),jsuites.exports}(function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();(function(n,s){module.exports=s()})(self,function(){return function(){var __webpack_modules__={243:function(n){var s;n.exports=(function(){var c={765:function(U,d){var r;r=function(b){b.version="1.0.2";var H=Math;function P(ye,ae){for(var ke=0,Ke=0;ke<ye.length;++ke)Ke=ae*Ke+ye[ke];return Ke}function g(ye,ae,ke,Ke,qe){if(ae===0)return ke;if(ae===1)return Ke;for(var Be=2/ye,lt=Ke,Y=1;Y<ae;++Y)lt=Ke*Y*Be+qe*ke,ke=Ke,Ke=lt;return lt}function u(ye,ae,ke,Ke,qe){return function(Be,lt){if(Ke){if(Be===0)return Ke==1?-1/0:1/0;if(Be<0)return NaN}return lt===0?ye(Be):lt===1?ae(Be):lt<0?NaN:g(Be,lt|=0,ye(Be),ae(Be),qe)}}var m,j,h,C,T,I,B,F,N,O,G,q,se,ge=function(){var ye=.636619772,ae=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),ke=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),Ke=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),qe=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function Be(Me){var Ie=0,Oe=0,ze=0,Ge=Me*Me;if(Me<8)Ie=(Oe=P(ae,Ge))/(ze=P(ke,Ge));else{var Qe=Me-.785398164;Oe=P(Ke,Ge=64/Ge),ze=P(qe,Ge),Ie=H.sqrt(ye/Me)*(H.cos(Qe)*Oe-H.sin(Qe)*ze*8/Me)}return Ie}var lt=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),Y=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Le=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Ue=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function mt(Me){var Ie=0,Oe=0,ze=0,Ge=Me*Me,Qe=H.abs(Me)-2.356194491;return Math.abs(Me)<8?Ie=(Oe=Me*P(lt,Ge))/(ze=P(Y,Ge)):(Oe=P(Le,Ge=64/Ge),ze=P(Ue,Ge),Ie=H.sqrt(ye/H.abs(Me))*(H.cos(Qe)*Oe-H.sin(Qe)*ze*8/H.abs(Me)),Me<0&&(Ie=-Ie)),Ie}return function Me(Ie,Oe){if(Oe=Math.round(Oe),!isFinite(Ie))return isNaN(Ie)?Ie:0;if(Oe<0)return(Oe%2?-1:1)*Me(Ie,-Oe);if(Ie<0)return(Oe%2?-1:1)*Me(-Ie,Oe);if(Oe===0)return Be(Ie);if(Oe===1)return mt(Ie);if(Ie===0)return 0;var ze=0;if(Ie>Oe)ze=g(Ie,Oe,Be(Ie),mt(Ie),-1);else{for(var Ge=!1,Qe=0,ct=0,at=1,dt=0,vt=2/Ie,ht=2*H.floor((Oe+H.floor(H.sqrt(40*Oe)))/2);ht>0;ht--)dt=ht*vt*at-Qe,Qe=at,at=dt,H.abs(at)>1e10&&(at*=1e-10,Qe*=1e-10,ze*=1e-10,ct*=1e-10),Ge&&(ct+=at),Ge=!Ge,ht==Oe&&(ze=Qe);ze/=ct=2*ct-at}return ze}}(),ie=(m=.636619772,j=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),h=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),C=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),T=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),I=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),B=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),F=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),N=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),u(function(ye){var ae=0,ke=0,Ke=0,qe=ye*ye,Be=ye-.785398164;return ye<8?ae=(ke=P(j,qe))/(Ke=P(h,qe))+m*ge(ye,0)*H.log(ye):(ke=P(C,qe=64/qe),Ke=P(T,qe),ae=H.sqrt(m/ye)*(H.sin(Be)*ke+H.cos(Be)*Ke*8/ye)),ae},function(ye){var ae=0,ke=0,Ke=0,qe=ye*ye,Be=ye-2.356194491;return ye<8?ae=(ke=ye*P(I,qe))/(Ke=P(B,qe))+m*(ge(ye,1)*H.log(ye)-1/ye):(ke=P(F,qe=64/qe),Ke=P(N,qe),ae=H.sqrt(m/ye)*(H.sin(Be)*ke+H.cos(Be)*Ke*8/ye)),ae},0,1,-1)),xe=(O=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),G=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),q=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),se=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function ye(ae,ke){if((ke=Math.round(ke))===0)return function(Ue){return Ue<=3.75?P(O,Ue*Ue/14.0625):H.exp(H.abs(Ue))/H.sqrt(H.abs(Ue))*P(G,3.75/H.abs(Ue))}(ae);if(ke===1)return function(Ue){return Ue<3.75?Ue*P(q,Ue*Ue/14.0625):(Ue<0?-1:1)*H.exp(H.abs(Ue))/H.sqrt(H.abs(Ue))*P(se,3.75/H.abs(Ue))}(ae);if(ke<0)return NaN;if(H.abs(ae)===0)return 0;if(ae==1/0)return 1/0;var Ke,qe=0,Be=2/H.abs(ae),lt=0,Y=1,Le=0;for(Ke=2*H.round((ke+H.round(H.sqrt(40*ke)))/2);Ke>0;Ke--)Le=Ke*Be*Y+lt,lt=Y,Y=Le,H.abs(Y)>1e10&&(Y*=1e-10,lt*=1e-10,qe*=1e-10),Ke==ke&&(qe=lt);return qe*=ye(ae,0)/Y,ae<0&&ke%2?-qe:qe}),Te=function(){var ye=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),ae=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),ke=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),Ke=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return u(function(qe){return qe<=2?-H.log(qe/2)*xe(qe,0)+P(ye,qe*qe/4):H.exp(-qe)/H.sqrt(qe)*P(ae,2/qe)},function(qe){return qe<=2?H.log(qe/2)*xe(qe,1)+1/qe*P(ke,qe*qe/4):H.exp(-qe)/H.sqrt(qe)*P(Ke,2/qe)},0,2,1)}();b.besselj=ge,b.bessely=ie,b.besseli=xe,b.besselk=Te},r(typeof DO_NOT_EXPORT_BESSEL>"u"?d:{})},162:function(U){var d;U.exports=(d=function(r,b){var H=Array.prototype.concat,P=Array.prototype.slice,g=Object.prototype.toString;function u(N,O){var G=N>O?N:O;return r.pow(10,17-~~(r.log(G>0?G:-G)*r.LOG10E))}var m=Array.isArray||function(N){return g.call(N)==="[object Array]"};function j(N){return g.call(N)==="[object Function]"}function h(N){return typeof N=="number"&&N-N==0}function C(){return new C._init(arguments)}function T(){return 0}function I(){return 1}function B(N,O){return N===O?1:0}C.fn=C.prototype,C._init=function(N){if(m(N[0]))if(m(N[0][0])){j(N[1])&&(N[0]=C.map(N[0],N[1]));for(var O=0;O<N[0].length;O++)this[O]=N[0][O];this.length=N[0].length}else this[0]=j(N[1])?C.map(N[0],N[1]):N[0],this.length=1;else if(h(N[0]))this[0]=C.seq.apply(null,N),this.length=1;else{if(N[0]instanceof C)return C(N[0].toArray());this[0]=[],this.length=1}return this},C._init.prototype=C.prototype,C._init.constructor=C,C.utils={calcRdx:u,isArray:m,isFunction:j,isNumber:h,toVector:function(N){return H.apply([],N)}},C._random_fn=r.random,C.setRandom=function(N){if(typeof N!="function")throw new TypeError("fn is not a function");C._random_fn=N},C.extend=function(N){var O,G;if(arguments.length===1){for(G in N)C[G]=N[G];return this}for(O=1;O<arguments.length;O++)for(G in arguments[O])N[G]=arguments[O][G];return N},C.rows=function(N){return N.length||1},C.cols=function(N){return N[0].length||1},C.dimensions=function(N){return{rows:C.rows(N),cols:C.cols(N)}},C.row=function(N,O){return m(O)?O.map(function(G){return C.row(N,G)}):N[O]},C.rowa=function(N,O){return C.row(N,O)},C.col=function(N,O){if(m(O)){var G=C.arange(N.length).map(function(){return new Array(O.length)});return O.forEach(function(ge,ie){C.arange(N.length).forEach(function(xe){G[xe][ie]=N[xe][ge]})}),G}for(var q=new Array(N.length),se=0;se<N.length;se++)q[se]=[N[se][O]];return q},C.cola=function(N,O){return C.col(N,O).map(function(G){return G[0]})},C.diag=function(N){for(var O=C.rows(N),G=new Array(O),q=0;q<O;q++)G[q]=[N[q][q]];return G},C.antidiag=function(N){for(var O=C.rows(N)-1,G=new Array(O),q=0;O>=0;O--,q++)G[q]=[N[q][O]];return G},C.transpose=function(N){var O,G,q,se,ge,ie=[];for(m(N[0])||(N=[N]),G=N.length,q=N[0].length,ge=0;ge<q;ge++){for(O=new Array(G),se=0;se<G;se++)O[se]=N[se][ge];ie.push(O)}return ie.length===1?ie[0]:ie},C.map=function(N,O,G){var q,se,ge,ie,xe;for(m(N[0])||(N=[N]),se=N.length,ge=N[0].length,ie=G?N:new Array(se),q=0;q<se;q++)for(ie[q]||(ie[q]=new Array(ge)),xe=0;xe<ge;xe++)ie[q][xe]=O(N[q][xe],q,xe);return ie.length===1?ie[0]:ie},C.cumreduce=function(N,O,G){var q,se,ge,ie,xe;for(m(N[0])||(N=[N]),se=N.length,ge=N[0].length,ie=G?N:new Array(se),q=0;q<se;q++)for(ie[q]||(ie[q]=new Array(ge)),ge>0&&(ie[q][0]=N[q][0]),xe=1;xe<ge;xe++)ie[q][xe]=O(ie[q][xe-1],N[q][xe]);return ie.length===1?ie[0]:ie},C.alter=function(N,O){return C.map(N,O,!0)},C.create=function(N,O,G){var q,se,ge=new Array(N);for(j(O)&&(G=O,O=N),q=0;q<N;q++)for(ge[q]=new Array(O),se=0;se<O;se++)ge[q][se]=G(q,se);return ge},C.zeros=function(N,O){return h(O)||(O=N),C.create(N,O,T)},C.ones=function(N,O){return h(O)||(O=N),C.create(N,O,I)},C.rand=function(N,O){return h(O)||(O=N),C.create(N,O,C._random_fn)},C.identity=function(N,O){return h(O)||(O=N),C.create(N,O,B)},C.symmetric=function(N){var O,G,q=N.length;if(N.length!==N[0].length)return!1;for(O=0;O<q;O++)for(G=0;G<q;G++)if(N[G][O]!==N[O][G])return!1;return!0},C.clear=function(N){return C.alter(N,T)},C.seq=function(N,O,G,q){j(q)||(q=!1);var se,ge=[],ie=u(N,O),xe=(O*ie-N*ie)/((G-1)*ie),Te=N;for(se=0;Te<=O&&se<G;Te=(N*ie+xe*ie*++se)/ie)ge.push(q?q(Te,se):Te);return ge},C.arange=function(N,O,G){var q,se=[];if(G=G||1,O===b&&(O=N,N=0),N===O||G===0)return[];if(N<O&&G<0)return[];if(N>O&&G>0)return[];if(G>0)for(q=N;q<O;q+=G)se.push(q);else for(q=N;q>O;q+=G)se.push(q);return se},C.slice=function(){function N(O,G,q,se){var ge,ie=[],xe=O.length;if(G===b&&q===b&&se===b)return C.copy(O);if(se=se||1,(G=(G=G||0)>=0?G:xe+G)===(q=(q=q||O.length)>=0?q:xe+q)||se===0)return[];if(G<q&&se<0)return[];if(G>q&&se>0)return[];if(se>0)for(ge=G;ge<q;ge+=se)ie.push(O[ge]);else for(ge=G;ge>q;ge+=se)ie.push(O[ge]);return ie}return function(O,G){var q,se;return h((G=G||{}).row)?h(G.col)?O[G.row][G.col]:N(C.rowa(O,G.row),(q=G.col||{}).start,q.end,q.step):h(G.col)?N(C.cola(O,G.col),(se=G.row||{}).start,se.end,se.step):(se=G.row||{},q=G.col||{},N(O,se.start,se.end,se.step).map(function(ge){return N(ge,q.start,q.end,q.step)}))}}(),C.sliceAssign=function(N,O,G){var q,se;if(h(O.row)){if(h(O.col))return N[O.row][O.col]=G;O.col=O.col||{},O.col.start=O.col.start||0,O.col.end=O.col.end||N[0].length,O.col.step=O.col.step||1,q=C.arange(O.col.start,r.min(N.length,O.col.end),O.col.step);var ge=O.row;return q.forEach(function(xe,Te){N[ge][xe]=G[Te]}),N}if(h(O.col)){O.row=O.row||{},O.row.start=O.row.start||0,O.row.end=O.row.end||N.length,O.row.step=O.row.step||1,se=C.arange(O.row.start,r.min(N[0].length,O.row.end),O.row.step);var ie=O.col;return se.forEach(function(xe,Te){N[xe][ie]=G[Te]}),N}return G[0].length===b&&(G=[G]),O.row.start=O.row.start||0,O.row.end=O.row.end||N.length,O.row.step=O.row.step||1,O.col.start=O.col.start||0,O.col.end=O.col.end||N[0].length,O.col.step=O.col.step||1,se=C.arange(O.row.start,r.min(N.length,O.row.end),O.row.step),q=C.arange(O.col.start,r.min(N[0].length,O.col.end),O.col.step),se.forEach(function(xe,Te){q.forEach(function(ye,ae){N[xe][ye]=G[Te][ae]})}),N},C.diagonal=function(N){var O=C.zeros(N.length,N.length);return N.forEach(function(G,q){O[q][q]=G}),O},C.copy=function(N){return N.map(function(O){return h(O)?O:O.map(function(G){return G})})};var F=C.prototype;return F.length=0,F.push=Array.prototype.push,F.sort=Array.prototype.sort,F.splice=Array.prototype.splice,F.slice=Array.prototype.slice,F.toArray=function(){return this.length>1?P.call(this):P.call(this)[0]},F.map=function(N,O){return C(C.map(this,N,O))},F.cumreduce=function(N,O){return C(C.cumreduce(this,N,O))},F.alter=function(N){return C.alter(this,N),this},function(N){for(var O=0;O<N.length;O++)(function(G){F[G]=function(q){var se,ge=this;return q?(setTimeout(function(){q.call(ge,F[G].call(ge))}),this):(se=C[G](this),m(se)?C(se):se)}})(N[O])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(N){for(var O=0;O<N.length;O++)(function(G){F[G]=function(q,se){var ge=this;return se?(setTimeout(function(){se.call(ge,F[G].call(ge,q))}),this):C(C[G](this,q))}})(N[O])}("row col".split(" ")),function(N){for(var O=0;O<N.length;O++)(function(G){F[G]=function(){return C(C[G].apply(null,arguments))}})(N[O])}("create zeros ones rand identity".split(" ")),C}(Math),function(r,b){var H=r.utils.isFunction;function P(m,j){return m-j}function g(m,j,h){return b.max(j,b.min(m,h))}r.sum=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h];return j},r.sumsqrd=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h]*m[h];return j},r.sumsqerr=function(m){for(var j,h=r.mean(m),C=0,T=m.length;--T>=0;)C+=(j=m[T]-h)*j;return C},r.sumrow=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h];return j},r.product=function(m){for(var j=1,h=m.length;--h>=0;)j*=m[h];return j},r.min=function(m){for(var j=m[0],h=0;++h<m.length;)m[h]<j&&(j=m[h]);return j},r.max=function(m){for(var j=m[0],h=0;++h<m.length;)m[h]>j&&(j=m[h]);return j},r.unique=function(m){for(var j={},h=[],C=0;C<m.length;C++)j[m[C]]||(j[m[C]]=!0,h.push(m[C]));return h},r.mean=function(m){return r.sum(m)/m.length},r.meansqerr=function(m){return r.sumsqerr(m)/m.length},r.geomean=function(m){var j=m.map(b.log),h=r.mean(j);return b.exp(h)},r.median=function(m){var j=m.length,h=m.slice().sort(P);return 1&j?h[j/2|0]:(h[j/2-1]+h[j/2])/2},r.cumsum=function(m){return r.cumreduce(m,function(j,h){return j+h})},r.cumprod=function(m){return r.cumreduce(m,function(j,h){return j*h})},r.diff=function(m){var j,h=[],C=m.length;for(j=1;j<C;j++)h.push(m[j]-m[j-1]);return h},r.rank=function(m){var j,h=[],C={};for(j=0;j<m.length;j++)C[F=m[j]]?C[F]++:(C[F]=1,h.push(F));var T=h.sort(P),I={},B=1;for(j=0;j<T.length;j++){var F,N=C[F=T[j]],O=(B+(B+N-1))/2;I[F]=O,B+=N}return m.map(function(G){return I[G]})},r.mode=function(m){var j,h=m.length,C=m.slice().sort(P),T=1,I=0,B=0,F=[];for(j=0;j<h;j++)C[j]===C[j+1]?T++:(T>I?(F=[C[j]],I=T,B=0):T===I&&(F.push(C[j]),B++),T=1);return B===0?F[0]:F},r.range=function(m){return r.max(m)-r.min(m)},r.variance=function(m,j){return r.sumsqerr(m)/(m.length-(j?1:0))},r.pooledvariance=function(m){return m.reduce(function(j,h){return j+r.sumsqerr(h)},0)/(m.reduce(function(j,h){return j+h.length},0)-m.length)},r.deviation=function(m){for(var j=r.mean(m),h=m.length,C=new Array(h),T=0;T<h;T++)C[T]=m[T]-j;return C},r.stdev=function(m,j){return b.sqrt(r.variance(m,j))},r.pooledstdev=function(m){return b.sqrt(r.pooledvariance(m))},r.meandev=function(m){for(var j=r.mean(m),h=[],C=m.length-1;C>=0;C--)h.push(b.abs(m[C]-j));return r.mean(h)},r.meddev=function(m){for(var j=r.median(m),h=[],C=m.length-1;C>=0;C--)h.push(b.abs(m[C]-j));return r.median(h)},r.coeffvar=function(m){return r.stdev(m)/r.mean(m)},r.quartiles=function(m){var j=m.length,h=m.slice().sort(P);return[h[b.round(j/4)-1],h[b.round(j/2)-1],h[b.round(3*j/4)-1]]},r.quantiles=function(m,j,h,C){var T,I,B,F,N,O=m.slice().sort(P),G=[j.length],q=m.length;for(h===void 0&&(h=.375),C===void 0&&(C=.375),T=0;T<j.length;T++)B=q*(I=j[T])+(h+I*(1-h-C)),F=b.floor(g(B,1,q-1)),N=g(B-F,0,1),G[T]=(1-N)*O[F-1]+N*O[F];return G},r.percentile=function(m,j,h){var C=m.slice().sort(P),T=j*(C.length+(h?1:-1))+(h?0:1),I=parseInt(T),B=T-I;return I+1<C.length?C[I-1]+B*(C[I]-C[I-1]):C[I-1]},r.percentileOfScore=function(m,j,h){var C,T,I=0,B=m.length,F=!1;for(h==="strict"&&(F=!0),T=0;T<B;T++)C=m[T],(F&&C<j||!F&&C<=j)&&I++;return I/B},r.histogram=function(m,j){j=j||4;var h,C=r.min(m),T=(r.max(m)-C)/j,I=m.length,B=[];for(h=0;h<j;h++)B[h]=0;for(h=0;h<I;h++)B[b.min(b.floor((m[h]-C)/T),j-1)]+=1;return B},r.covariance=function(m,j){var h,C=r.mean(m),T=r.mean(j),I=m.length,B=new Array(I);for(h=0;h<I;h++)B[h]=(m[h]-C)*(j[h]-T);return r.sum(B)/(I-1)},r.corrcoeff=function(m,j){return r.covariance(m,j)/r.stdev(m,1)/r.stdev(j,1)},r.spearmancoeff=function(m,j){return m=r.rank(m),j=r.rank(j),r.corrcoeff(m,j)},r.stanMoment=function(m,j){for(var h=r.mean(m),C=r.stdev(m),T=m.length,I=0,B=0;B<T;B++)I+=b.pow((m[B]-h)/C,j);return I/m.length},r.skewness=function(m){return r.stanMoment(m,3)},r.kurtosis=function(m){return r.stanMoment(m,4)-3};var u=r.prototype;(function(m){for(var j=0;j<m.length;j++)(function(h){u[h]=function(C,T){var I=[],B=0,F=this;if(H(C)&&(T=C,C=!1),T)return setTimeout(function(){T.call(F,u[h].call(F,C))}),this;if(this.length>1){for(F=C===!0?this:this.transpose();B<F.length;B++)I[B]=r[h](F[B]);return I}return r[h](this[0],C)}})(m[j])})("cumsum cumprod".split(" ")),function(m){for(var j=0;j<m.length;j++)(function(h){u[h]=function(C,T){var I=[],B=0,F=this;if(H(C)&&(T=C,C=!1),T)return setTimeout(function(){T.call(F,u[h].call(F,C))}),this;if(this.length>1){for(h!=="sumrow"&&(F=C===!0?this:this.transpose());B<F.length;B++)I[B]=r[h](F[B]);return C===!0?r[h](r.utils.toVector(I)):I}return r[h](this[0],C)}})(m[j])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(m){for(var j=0;j<m.length;j++)(function(h){u[h]=function(){var C,T=[],I=0,B=this,F=Array.prototype.slice.call(arguments);if(H(F[F.length-1])){C=F[F.length-1];var N=F.slice(0,F.length-1);return setTimeout(function(){C.call(B,u[h].apply(B,N))}),this}C=void 0;var O=function(G){return r[h].apply(B,[G].concat(F))};if(this.length>1){for(B=B.transpose();I<B.length;I++)T[I]=O(B[I]);return T}return O(this[0])}})(m[j])}("quantiles percentileOfScore".split(" "))}(d,Math),function(r,b){r.gammaln=function(H){var P,g,u,m=0,j=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],h=1.000000000190015;for(u=(g=P=H)+5.5,u-=(P+.5)*b.log(u);m<6;m++)h+=j[m]/++g;return b.log(2.5066282746310007*h/P)-u},r.loggam=function(H){var P,g,u,m,j,h,C,T=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(P=H,C=0,H==1||H==2)return 0;for(H<=7&&(P=H+(C=b.floor(7-H))),g=1/(P*P),u=2*b.PI,j=T[9],h=8;h>=0;h--)j*=g,j+=T[h];if(m=j/P+.5*b.log(u)+(P-.5)*b.log(P)-P,H<=7)for(h=1;h<=C;h++)m-=b.log(P-1),P-=1;return m},r.gammafn=function(H){var P,g,u,m,j=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],C=!1,T=0,I=0,B=0,F=H;if(H>171.6243769536076)return 1/0;if(F<=0){if(!(m=F%1+36e-17))return 1/0;C=(1&F?-1:1)*b.PI/b.sin(b.PI*m),F=1-F}for(u=F,g=F<1?F++:(F-=T=(0|F)-1)-1,P=0;P<8;++P)B=(B+j[P])*g,I=I*g+h[P];if(m=B/I+1,u<F)m/=u;else if(u>F)for(P=0;P<T;++P)m*=F,F++;return C&&(m=C/m),m},r.gammap=function(H,P){return r.lowRegGamma(H,P)*r.gammafn(H)},r.lowRegGamma=function(H,P){var g,u=r.gammaln(H),m=H,j=1/H,h=j,C=P+1-H,T=1/1e-30,I=1/C,B=I,F=1,N=-~(8.5*b.log(H>=1?H:1/H)+.4*H+17);if(P<0||H<=0)return NaN;if(P<H+1){for(;F<=N;F++)j+=h*=P/++m;return j*b.exp(-P+H*b.log(P)-u)}for(;F<=N;F++)B*=(I=1/(I=(g=-F*(F-H))*I+(C+=2)))*(T=C+g/T);return 1-B*b.exp(-P+H*b.log(P)-u)},r.factorialln=function(H){return H<0?NaN:r.gammaln(H+1)},r.factorial=function(H){return H<0?NaN:r.gammafn(H+1)},r.combination=function(H,P){return H>170||P>170?b.exp(r.combinationln(H,P)):r.factorial(H)/r.factorial(P)/r.factorial(H-P)},r.combinationln=function(H,P){return r.factorialln(H)-r.factorialln(P)-r.factorialln(H-P)},r.permutation=function(H,P){return r.factorial(H)/r.factorial(H-P)},r.betafn=function(H,P){if(!(H<=0||P<=0))return H+P>170?b.exp(r.betaln(H,P)):r.gammafn(H)*r.gammafn(P)/r.gammafn(H+P)},r.betaln=function(H,P){return r.gammaln(H)+r.gammaln(P)-r.gammaln(H+P)},r.betacf=function(H,P,g){var u,m,j,h,C=1e-30,T=1,I=P+g,B=P+1,F=P-1,N=1,O=1-I*H/B;for(b.abs(O)<C&&(O=C),h=O=1/O;T<=100&&(O=1+(m=T*(g-T)*H/((F+(u=2*T))*(P+u)))*O,b.abs(O)<C&&(O=C),N=1+m/N,b.abs(N)<C&&(N=C),h*=(O=1/O)*N,O=1+(m=-(P+T)*(I+T)*H/((P+u)*(B+u)))*O,b.abs(O)<C&&(O=C),N=1+m/N,b.abs(N)<C&&(N=C),h*=j=(O=1/O)*N,!(b.abs(j-1)<3e-7));T++);return h},r.gammapinv=function(H,P){var g,u,m,j,h,C,T=0,I=P-1,B=r.gammaln(P);if(H>=1)return b.max(100,P+100*b.sqrt(P));if(H<=0)return 0;for(P>1?(h=b.log(I),C=b.exp(I*(h-1)-B),j=H<.5?H:1-H,g=(2.30753+.27061*(u=b.sqrt(-2*b.log(j))))/(1+u*(.99229+.04481*u))-u,H<.5&&(g=-g),g=b.max(.001,P*b.pow(1-1/(9*P)-g/(3*b.sqrt(P)),3))):g=H<(u=1-P*(.253+.12*P))?b.pow(H/u,1/P):1-b.log(1-(H-u)/(1-u));T<12;T++){if(g<=0)return 0;if((g-=u=(m=(r.lowRegGamma(P,g)-H)/(u=P>1?C*b.exp(-(g-I)+I*(b.log(g)-h)):b.exp(-g+I*b.log(g)-B)))/(1-.5*b.min(1,m*((P-1)/g-1))))<=0&&(g=.5*(g+u)),b.abs(u)<1e-8*g)break}return g},r.erf=function(H){var P,g,u,m,j=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=j.length-1,C=!1,T=0,I=0;for(H<0&&(H=-H,C=!0),g=4*(P=2/(2+H))-2;h>0;h--)u=T,T=g*T-I+j[h],I=u;return m=P*b.exp(-H*H+.5*(j[0]+g*T)-I),C?m-1:1-m},r.erfc=function(H){return 1-r.erf(H)},r.erfcinv=function(H){var P,g,u,m,j=0;if(H>=2)return-100;if(H<=0)return 100;for(m=H<1?H:2-H,P=-.70711*((2.30753+.27061*(u=b.sqrt(-2*b.log(m/2))))/(1+u*(.99229+.04481*u))-u);j<2;j++)P+=(g=r.erfc(P)-m)/(1.1283791670955126*b.exp(-P*P)-P*g);return H<1?P:-P},r.ibetainv=function(H,P,g){var u,m,j,h,C,T,I,B,F,N,O=P-1,G=g-1,q=0;if(H<=0)return 0;if(H>=1)return 1;for(P>=1&&g>=1?(j=H<.5?H:1-H,T=(2.30753+.27061*(h=b.sqrt(-2*b.log(j))))/(1+h*(.99229+.04481*h))-h,H<.5&&(T=-T),I=(T*T-3)/6,B=2/(1/(2*P-1)+1/(2*g-1)),F=T*b.sqrt(I+B)/B-(1/(2*g-1)-1/(2*P-1))*(I+.8333333333333334-2/(3*B)),T=P/(P+g*b.exp(2*F))):(u=b.log(P/(P+g)),m=b.log(g/(P+g)),T=H<(h=b.exp(P*u)/P)/(F=h+(C=b.exp(g*m)/g))?b.pow(P*F*H,1/P):1-b.pow(g*F*(1-H),1/g)),N=-r.gammaln(P)-r.gammaln(g)+r.gammaln(P+g);q<10;q++){if(T===0||T===1)return T;if((T-=h=(C=(r.ibeta(T,P,g)-H)/(h=b.exp(O*b.log(T)+G*b.log(1-T)+N)))/(1-.5*b.min(1,C*(O/T-G/(1-T)))))<=0&&(T=.5*(T+h)),T>=1&&(T=.5*(T+h+1)),b.abs(h)<1e-8*T&&q>0)break}return T},r.ibeta=function(H,P,g){var u=H===0||H===1?0:b.exp(r.gammaln(P+g)-r.gammaln(P)-r.gammaln(g)+P*b.log(H)+g*b.log(1-H));return!(H<0||H>1)&&(H<(P+1)/(P+g+2)?u*r.betacf(H,P,g)/P:1-u*r.betacf(1-H,g,P)/g)},r.randn=function(H,P){var g,u,m,j,h;if(P||(P=H),H)return r.create(H,P,function(){return r.randn()});do g=r._random_fn(),u=1.7156*(r._random_fn()-.5),h=(m=g-.449871)*m+(j=b.abs(u)+.386595)*(.196*j-.25472*m);while(h>.27597&&(h>.27846||u*u>-4*b.log(g)*g*g));return u/g},r.randg=function(H,P,g){var u,m,j,h,C,T,I=H;if(g||(g=P),H||(H=1),P)return(T=r.zeros(P,g)).alter(function(){return r.randg(H)}),T;H<1&&(H+=1),u=H-.3333333333333333,m=1/b.sqrt(9*u);do{do h=1+m*(C=r.randn());while(h<=0);h*=h*h,j=r._random_fn()}while(j>1-.331*b.pow(C,4)&&b.log(j)>.5*C*C+u*(1-h+b.log(h)));if(H==I)return u*h;do j=r._random_fn();while(j===0);return b.pow(j,1/I)*u*h},function(H){for(var P=0;P<H.length;P++)(function(g){r.fn[g]=function(){return r(r.map(this,function(u){return r[g](u)}))}})(H[P])}("gammaln gammafn factorial factorialln".split(" ")),function(H){for(var P=0;P<H.length;P++)(function(g){r.fn[g]=function(){return r(r[g].apply(null,arguments))}})(H[P])}("randn".split(" "))}(d,Math),function(r,b){function H(g,u,m,j){for(var h,C=0,T=1,I=1,B=1,F=0,N=0;b.abs((I-N)/I)>j;)N=I,T=B+(h=-(u+F)*(u+m+F)*g/(u+2*F)/(u+2*F+1))*T,I=(C=I+h*C)+(h=(F+=1)*(m-F)*g/(u+2*F-1)/(u+2*F))*I,C/=B=T+h*B,T/=B,I/=B,B=1;return I/u}function P(g,u,m){var j=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],h=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],C=.5*g;if(C>=8)return 1;var T,I=2*r.normal.cdf(C,0,1,1,0)-1;I=I>=b.exp(-50/m)?b.pow(I,m):0;for(var B=C,F=(8-C)/(T=g>3?2:3),N=B+F,O=0,G=m-1,q=1;q<=T;q++){for(var se=0,ge=.5*(N+B),ie=.5*(N-B),xe=1;xe<=12;xe++){var Te,ye=ge+ie*(6<xe?j[(Te=12-xe+1)-1]:-j[(Te=xe)-1]),ae=ye*ye;if(ae>60)break;var ke=2*r.normal.cdf(ye,0,1,1,0)*.5-2*r.normal.cdf(ye,g,1,1,0)*.5;ke>=b.exp(-30/G)&&(se+=ke=h[Te-1]*b.exp(-.5*ae)*b.pow(ke,G))}O+=se*=2*ie*m/b.sqrt(2*b.PI),B=N,N+=F}return(I+=O)<=b.exp(-30/u)?0:(I=b.pow(I,u))>=1?1:I}(function(g){for(var u=0;u<g.length;u++)(function(m){r[m]=function j(h,C,T){return this instanceof j?(this._a=h,this._b=C,this._c=T,this):new j(h,C,T)},r.fn[m]=function(j,h,C){var T=r[m](j,h,C);return T.data=this,T},r[m].prototype.sample=function(j){var h=this._a,C=this._b,T=this._c;return j?r.alter(j,function(){return r[m].sample(h,C,T)}):r[m].sample(h,C,T)},function(j){for(var h=0;h<j.length;h++)(function(C){r[m].prototype[C]=function(T){var I=this._a,B=this._b,F=this._c;return T||T===0||(T=this.data),typeof T!="number"?r.fn.map.call(T,function(N){return r[m][C](N,I,B,F)}):r[m][C](T,I,B,F)}})(j[h])}("pdf cdf inv".split(" ")),function(j){for(var h=0;h<j.length;h++)(function(C){r[m].prototype[C]=function(){return r[m][C](this._a,this._b,this._c)}})(j[h])}("mean median mode variance".split(" "))})(g[u])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(g,u,m){return g>1||g<0?0:u==1&&m==1?1:u<512&&m<512?b.pow(g,u-1)*b.pow(1-g,m-1)/r.betafn(u,m):b.exp((u-1)*b.log(g)+(m-1)*b.log(1-g)-r.betaln(u,m))},cdf:function(g,u,m){return g>1||g<0?1*(g>1):r.ibeta(g,u,m)},inv:function(g,u,m){return r.ibetainv(g,u,m)},mean:function(g,u){return g/(g+u)},median:function(g,u){return r.ibetainv(.5,g,u)},mode:function(g,u){return(g-1)/(g+u-2)},sample:function(g,u){var m=r.randg(g);return m/(m+r.randg(u))},variance:function(g,u){return g*u/(b.pow(g+u,2)*(g+u+1))}}),r.extend(r.centralF,{pdf:function(g,u,m){var j;return g<0?0:u<=2?g===0&&u<2?1/0:g===0&&u===2?1:1/r.betafn(u/2,m/2)*b.pow(u/m,u/2)*b.pow(g,u/2-1)*b.pow(1+u/m*g,-(u+m)/2):(j=u*g/(m+g*u),u*(m/(m+g*u))/2*r.binomial.pdf((u-2)/2,(u+m-2)/2,j))},cdf:function(g,u,m){return g<0?0:r.ibeta(u*g/(u*g+m),u/2,m/2)},inv:function(g,u,m){return m/(u*(1/r.ibetainv(g,u/2,m/2)-1))},mean:function(g,u){return u>2?u/(u-2):void 0},mode:function(g,u){return g>2?u*(g-2)/(g*(u+2)):void 0},sample:function(g,u){return 2*r.randg(g/2)/g/(2*r.randg(u/2)/u)},variance:function(g,u){if(!(u<=4))return 2*u*u*(g+u-2)/(g*(u-2)*(u-2)*(u-4))}}),r.extend(r.cauchy,{pdf:function(g,u,m){return m<0?0:m/(b.pow(g-u,2)+b.pow(m,2))/b.PI},cdf:function(g,u,m){return b.atan((g-u)/m)/b.PI+.5},inv:function(g,u,m){return u+m*b.tan(b.PI*(g-.5))},median:function(g){return g},mode:function(g){return g},sample:function(g,u){return r.randn()*b.sqrt(1/(2*r.randg(.5)))*u+g}}),r.extend(r.chisquare,{pdf:function(g,u){return g<0?0:g===0&&u===2?.5:b.exp((u/2-1)*b.log(g)-g/2-u/2*b.log(2)-r.gammaln(u/2))},cdf:function(g,u){return g<0?0:r.lowRegGamma(u/2,g/2)},inv:function(g,u){return 2*r.gammapinv(g,.5*u)},mean:function(g){return g},median:function(g){return g*b.pow(1-2/(9*g),3)},mode:function(g){return g-2>0?g-2:0},sample:function(g){return 2*r.randg(g/2)},variance:function(g){return 2*g}}),r.extend(r.exponential,{pdf:function(g,u){return g<0?0:u*b.exp(-u*g)},cdf:function(g,u){return g<0?0:1-b.exp(-u*g)},inv:function(g,u){return-b.log(1-g)/u},mean:function(g){return 1/g},median:function(g){return 1/g*b.log(2)},mode:function(){return 0},sample:function(g){return-1/g*b.log(r._random_fn())},variance:function(g){return b.pow(g,-2)}}),r.extend(r.gamma,{pdf:function(g,u,m){return g<0?0:g===0&&u===1?1/m:b.exp((u-1)*b.log(g)-g/m-r.gammaln(u)-u*b.log(m))},cdf:function(g,u,m){return g<0?0:r.lowRegGamma(u,g/m)},inv:function(g,u,m){return r.gammapinv(g,u)*m},mean:function(g,u){return g*u},mode:function(g,u){if(g>1)return(g-1)*u},sample:function(g,u){return r.randg(g)*u},variance:function(g,u){return g*u*u}}),r.extend(r.invgamma,{pdf:function(g,u,m){return g<=0?0:b.exp(-(u+1)*b.log(g)-m/g-r.gammaln(u)+u*b.log(m))},cdf:function(g,u,m){return g<=0?0:1-r.lowRegGamma(u,m/g)},inv:function(g,u,m){return m/r.gammapinv(1-g,u)},mean:function(g,u){return g>1?u/(g-1):void 0},mode:function(g,u){return u/(g+1)},sample:function(g,u){return u/r.randg(g)},variance:function(g,u){if(!(g<=2))return u*u/((g-1)*(g-1)*(g-2))}}),r.extend(r.kumaraswamy,{pdf:function(g,u,m){return g===0&&u===1?m:g===1&&m===1?u:b.exp(b.log(u)+b.log(m)+(u-1)*b.log(g)+(m-1)*b.log(1-b.pow(g,u)))},cdf:function(g,u,m){return g<0?0:g>1?1:1-b.pow(1-b.pow(g,u),m)},inv:function(g,u,m){return b.pow(1-b.pow(1-g,1/m),1/u)},mean:function(g,u){return u*r.gammafn(1+1/g)*r.gammafn(u)/r.gammafn(1+1/g+u)},median:function(g,u){return b.pow(1-b.pow(2,-1/u),1/g)},mode:function(g,u){if(g>=1&&u>=1&&g!==1&&u!==1)return b.pow((g-1)/(g*u-1),1/g)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(g,u,m){return g<=0?0:b.exp(-b.log(g)-.5*b.log(2*b.PI)-b.log(m)-b.pow(b.log(g)-u,2)/(2*m*m))},cdf:function(g,u,m){return g<0?0:.5+.5*r.erf((b.log(g)-u)/b.sqrt(2*m*m))},inv:function(g,u,m){return b.exp(-1.4142135623730951*m*r.erfcinv(2*g)+u)},mean:function(g,u){return b.exp(g+u*u/2)},median:function(g){return b.exp(g)},mode:function(g,u){return b.exp(g-u*u)},sample:function(g,u){return b.exp(r.randn()*u+g)},variance:function(g,u){return(b.exp(u*u)-1)*b.exp(2*g+u*u)}}),r.extend(r.noncentralt,{pdf:function(g,u,m){return b.abs(m)<1e-14?r.studentt.pdf(g,u):b.abs(g)<1e-14?b.exp(r.gammaln((u+1)/2)-m*m/2-.5*b.log(b.PI*u)-r.gammaln(u/2)):u/g*(r.noncentralt.cdf(g*b.sqrt(1+2/u),u+2,m)-r.noncentralt.cdf(g,u,m))},cdf:function(g,u,m){var j=1e-14;if(b.abs(m)<j)return r.studentt.cdf(g,u);var h=!1;g<0&&(h=!0,m=-m);for(var C=r.normal.cdf(-m,0,1),T=j+1,I=T,B=g*g/(g*g+u),F=0,N=b.exp(-m*m/2),O=b.exp(-m*m/2-.5*b.log(2)-r.gammaln(1.5))*m;F<200||I>j||T>j;)I=T,F>0&&(N*=m*m/(2*F),O*=m*m/(2*(F+.5))),C+=.5*(T=N*r.beta.cdf(B,F+.5,u/2)+O*r.beta.cdf(B,F+1,u/2)),F++;return h?1-C:C}}),r.extend(r.normal,{pdf:function(g,u,m){return b.exp(-.5*b.log(2*b.PI)-b.log(m)-b.pow(g-u,2)/(2*m*m))},cdf:function(g,u,m){return .5*(1+r.erf((g-u)/b.sqrt(2*m*m)))},inv:function(g,u,m){return-1.4142135623730951*m*r.erfcinv(2*g)+u},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},sample:function(g,u){return r.randn()*u+g},variance:function(g,u){return u*u}}),r.extend(r.pareto,{pdf:function(g,u,m){return g<u?0:m*b.pow(u,m)/b.pow(g,m+1)},cdf:function(g,u,m){return g<u?0:1-b.pow(u/g,m)},inv:function(g,u,m){return u/b.pow(1-g,1/m)},mean:function(g,u){if(!(u<=1))return u*b.pow(g,u)/(u-1)},median:function(g,u){return g*(u*b.SQRT2)},mode:function(g){return g},variance:function(g,u){if(!(u<=2))return g*g*u/(b.pow(u-1,2)*(u-2))}}),r.extend(r.studentt,{pdf:function(g,u){return u=u>1e100?1e100:u,1/(b.sqrt(u)*r.betafn(.5,u/2))*b.pow(1+g*g/u,-(u+1)/2)},cdf:function(g,u){var m=u/2;return r.ibeta((g+b.sqrt(g*g+u))/(2*b.sqrt(g*g+u)),m,m)},inv:function(g,u){var m=r.ibetainv(2*b.min(g,1-g),.5*u,.5);return m=b.sqrt(u*(1-m)/m),g>.5?m:-m},mean:function(g){return g>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(g){return r.randn()*b.sqrt(g/(2*r.randg(g/2)))},variance:function(g){return g>2?g/(g-2):g>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(g,u,m){return g<0||u<0||m<0?0:m/u*b.pow(g/u,m-1)*b.exp(-b.pow(g/u,m))},cdf:function(g,u,m){return g<0?0:1-b.exp(-b.pow(g/u,m))},inv:function(g,u,m){return u*b.pow(-b.log(1-g),1/m)},mean:function(g,u){return g*r.gammafn(1+1/u)},median:function(g,u){return g*b.pow(b.log(2),1/u)},mode:function(g,u){return u<=1?0:g*b.pow((u-1)/u,1/u)},sample:function(g,u){return g*b.pow(-b.log(r._random_fn()),1/u)},variance:function(g,u){return g*g*r.gammafn(1+2/u)-b.pow(r.weibull.mean(g,u),2)}}),r.extend(r.uniform,{pdf:function(g,u,m){return g<u||g>m?0:1/(m-u)},cdf:function(g,u,m){return g<u?0:g<m?(g-u)/(m-u):1},inv:function(g,u,m){return u+g*(m-u)},mean:function(g,u){return .5*(g+u)},median:function(g,u){return r.mean(g,u)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,u){return g/2+u/2+(u/2-g/2)*(2*r._random_fn()-1)},variance:function(g,u){return b.pow(u-g,2)/12}}),r.extend(r.binomial,{pdf:function(g,u,m){return m===0||m===1?u*m===g?1:0:r.combination(u,g)*b.pow(m,g)*b.pow(1-m,u-g)},cdf:function(g,u,m){var j,h=1e-10;if(g<0)return 0;if(g>=u)return 1;if(m<0||m>1||u<=0)return NaN;var C=m,T=(g=b.floor(g))+1,I=u-g,B=T+I,F=b.exp(r.gammaln(B)-r.gammaln(I)-r.gammaln(T)+T*b.log(C)+I*b.log(1-C));return j=C<(T+1)/(B+2)?F*H(C,T,I,h):1-F*H(1-C,I,T,h),b.round(1/h*(1-j))/(1/h)}}),r.extend(r.negbin,{pdf:function(g,u,m){return g===g>>>0&&(g<0?0:r.combination(g+u-1,u-1)*b.pow(1-m,g)*b.pow(m,u))},cdf:function(g,u,m){var j=0,h=0;if(g<0)return 0;for(;h<=g;h++)j+=r.negbin.pdf(h,u,m);return j}}),r.extend(r.hypgeom,{pdf:function(g,u,m,j){if(g!=g|0)return!1;if(g<0||g<m-(u-j)||g>j||g>m)return 0;if(2*m>u)return 2*j>u?r.hypgeom.pdf(u-m-j+g,u,u-m,u-j):r.hypgeom.pdf(j-g,u,u-m,j);if(2*j>u)return r.hypgeom.pdf(m-g,u,m,u-j);if(m<j)return r.hypgeom.pdf(g,u,j,m);for(var h=1,C=0,T=0;T<g;T++){for(;h>1&&C<j;)h*=1-m/(u-C),C++;h*=(j-T)*(m-T)/((T+1)*(u-m-j+T+1))}for(;C<j;C++)h*=1-m/(u-C);return b.min(1,b.max(0,h))},cdf:function(g,u,m,j){if(g<0||g<m-(u-j))return 0;if(g>=j||g>=m)return 1;if(2*m>u)return 2*j>u?r.hypgeom.cdf(u-m-j+g,u,u-m,u-j):1-r.hypgeom.cdf(j-g-1,u,u-m,j);if(2*j>u)return 1-r.hypgeom.cdf(m-g-1,u,m,u-j);if(m<j)return r.hypgeom.cdf(g,u,j,m);for(var h=1,C=1,T=0,I=0;I<g;I++){for(;h>1&&T<j;){var B=1-m/(u-T);C*=B,h*=B,T++}h+=C*=(j-I)*(m-I)/((I+1)*(u-m-j+I+1))}for(;T<j;T++)h*=1-m/(u-T);return b.min(1,b.max(0,h))}}),r.extend(r.poisson,{pdf:function(g,u){return u<0||g%1!=0||g<0?0:b.pow(u,g)*b.exp(-u)/r.factorial(g)},cdf:function(g,u){var m=[],j=0;if(g<0)return 0;for(;j<=g;j++)m.push(r.poisson.pdf(j,u));return r.sum(m)},mean:function(g){return g},variance:function(g){return g},sampleSmall:function(g){var u=1,m=0,j=b.exp(-g);do m++,u*=r._random_fn();while(u>j);return m-1},sampleLarge:function(g){var u,m,j,h,C,T,I,B,F,N,O=g;for(h=b.sqrt(O),C=b.log(O),T=.02483*(I=.931+2.53*h)-.059,B=1.1239+1.1328/(I-3.4),F=.9277-3.6224/(I-2);;)if(m=b.random()-.5,j=b.random(),N=.5-b.abs(m),u=b.floor((2*T/N+I)*m+O+.43),N>=.07&&j<=F||!(u<0||N<.013&&j>N)&&b.log(j)+b.log(B)-b.log(T/(N*N)+I)<=u*C-O-r.loggam(u+1))return u},sample:function(g){return g<10?this.sampleSmall(g):this.sampleLarge(g)}}),r.extend(r.triangular,{pdf:function(g,u,m,j){return m<=u||j<u||j>m?NaN:g<u||g>m?0:g<j?2*(g-u)/((m-u)*(j-u)):g===j?2/(m-u):2*(m-g)/((m-u)*(m-j))},cdf:function(g,u,m,j){return m<=u||j<u||j>m?NaN:g<=u?0:g>=m?1:g<=j?b.pow(g-u,2)/((m-u)*(j-u)):1-b.pow(m-g,2)/((m-u)*(m-j))},inv:function(g,u,m,j){return m<=u||j<u||j>m?NaN:g<=(j-u)/(m-u)?u+(m-u)*b.sqrt(g*((j-u)/(m-u))):u+(m-u)*(1-b.sqrt((1-g)*(1-(j-u)/(m-u))))},mean:function(g,u,m){return(g+u+m)/3},median:function(g,u,m){return m<=(g+u)/2?u-b.sqrt((u-g)*(u-m))/b.sqrt(2):m>(g+u)/2?g+b.sqrt((u-g)*(m-g))/b.sqrt(2):void 0},mode:function(g,u,m){return m},sample:function(g,u,m){var j=r._random_fn();return j<(m-g)/(u-g)?g+b.sqrt(j*(u-g)*(m-g)):u-b.sqrt((1-j)*(u-g)*(u-m))},variance:function(g,u,m){return(g*g+u*u+m*m-g*u-g*m-u*m)/18}}),r.extend(r.arcsine,{pdf:function(g,u,m){return m<=u?NaN:g<=u||g>=m?0:2/b.PI*b.pow(b.pow(m-u,2)-b.pow(2*g-u-m,2),-.5)},cdf:function(g,u,m){return g<u?0:g<m?2/b.PI*b.asin(b.sqrt((g-u)/(m-u))):1},inv:function(g,u,m){return u+(.5-.5*b.cos(b.PI*g))*(m-u)},mean:function(g,u){return u<=g?NaN:(g+u)/2},median:function(g,u){return u<=g?NaN:(g+u)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,u){return(g+u)/2+(u-g)/2*b.sin(2*b.PI*r.uniform.sample(0,1))},variance:function(g,u){return u<=g?NaN:b.pow(u-g,2)/8}}),r.extend(r.laplace,{pdf:function(g,u,m){return m<=0?0:b.exp(-b.abs(g-u)/m)/(2*m)},cdf:function(g,u,m){return m<=0?0:g<u?.5*b.exp((g-u)/m):1-.5*b.exp(-(g-u)/m)},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},variance:function(g,u){return 2*u*u},sample:function(g,u){var m,j=r._random_fn()-.5;return g-u*((m=j)/b.abs(m))*b.log(1-2*b.abs(j))}}),r.extend(r.tukey,{cdf:function(g,u,m){var j=u,h=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],C=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(g<=0)return 0;if(m<2||j<2)return NaN;if(!Number.isFinite(g))return 1;if(m>25e3)return P(g,1,j);var T,I=.5*m,B=I*b.log(m)-m*b.log(2)-r.gammaln(I),F=I-1,N=.25*m;T=m<=100?1:m<=800?.5:m<=5e3?.25:.125,B+=b.log(T);for(var O=0,G=1;G<=50;G++){for(var q=0,se=(2*G-1)*T,ge=1;ge<=16;ge++){var ie,xe;8<ge?(ie=ge-8-1,xe=B+F*b.log(se+h[ie]*T)-(h[ie]*T+se)*N):(ie=ge-1,xe=B+F*b.log(se-h[ie]*T)+(h[ie]*T-se)*N),xe>=-30&&(q+=P(8<ge?g*b.sqrt(.5*(h[ie]*T+se)):g*b.sqrt(.5*(-h[ie]*T+se)),1,j)*C[ie]*b.exp(xe))}if(G*T>=1&&q<=1e-14)break;O+=q}if(q>1e-14)throw new Error("tukey.cdf failed to converge");return O>1&&(O=1),O},inv:function(g,u,m){if(m<2||u<2)return NaN;if(g<0||g>1)return NaN;if(g===0)return 0;if(g===1)return 1/0;var j,h=function(F,N,O){var G=.5-.5*F,q=b.sqrt(b.log(1/(G*G))),se=q+((((-453642210148e-16*q-.204231210125)*q-.342242088547)*q-1)*q+.322232421088)/((((.0038560700634*q+.10353775285)*q+.531103462366)*q+.588581570495)*q+.099348462606);O<120&&(se+=(se*se*se+se)/O/4);var ge=.8832-.2368*se;return O<120&&(ge+=-1.214/O+1.208*se/O),se*(ge*b.log(N-1)+1.4142)}(g,u,m),C=r.tukey.cdf(h,u,m)-g;j=C>0?b.max(0,h-1):h+1;for(var T,I=r.tukey.cdf(j,u,m)-g,B=1;B<50;B++)if(T=j-I*(j-h)/(I-C),C=I,h=j,T<0&&(T=0,I=-g),I=r.tukey.cdf(T,u,m)-g,j=T,b.abs(j-h)<1e-4)return T;throw new Error("tukey.inv failed to converge")}})}(d,Math),function(r,b){var H,P,g=Array.prototype.push,u=r.utils.isArray;function m(j){return u(j)||j instanceof r}r.extend({add:function(j,h){return m(h)?(m(h[0])||(h=[h]),r.map(j,function(C,T,I){return C+h[T][I]})):r.map(j,function(C){return C+h})},subtract:function(j,h){return m(h)?(m(h[0])||(h=[h]),r.map(j,function(C,T,I){return C-h[T][I]||0})):r.map(j,function(C){return C-h})},divide:function(j,h){return m(h)?(m(h[0])||(h=[h]),r.multiply(j,r.inv(h))):r.map(j,function(C){return C/h})},multiply:function(j,h){var C,T,I,B,F,N,O,G;if(j.length===void 0&&h.length===void 0)return j*h;if(F=j.length,N=j[0].length,O=r.zeros(F,I=m(h)?h[0].length:N),G=0,m(h)){for(;G<I;G++)for(C=0;C<F;C++){for(B=0,T=0;T<N;T++)B+=j[C][T]*h[T][G];O[C][G]=B}return F===1&&G===1?O[0][0]:O}return r.map(j,function(q){return q*h})},outer:function(j,h){return r.multiply(j.map(function(C){return[C]}),[h])},dot:function(j,h){m(j[0])||(j=[j]),m(h[0])||(h=[h]);for(var C,T,I=j[0].length===1&&j.length!==1?r.transpose(j):j,B=h[0].length===1&&h.length!==1?r.transpose(h):h,F=[],N=0,O=I.length,G=I[0].length;N<O;N++){for(F[N]=[],C=0,T=0;T<G;T++)C+=I[N][T]*B[N][T];F[N]=C}return F.length===1?F[0]:F},pow:function(j,h){return r.map(j,function(C){return b.pow(C,h)})},exp:function(j){return r.map(j,function(h){return b.exp(h)})},log:function(j){return r.map(j,function(h){return b.log(h)})},abs:function(j){return r.map(j,function(h){return b.abs(h)})},norm:function(j,h){var C=0,T=0;for(isNaN(h)&&(h=2),m(j[0])&&(j=j[0]);T<j.length;T++)C+=b.pow(b.abs(j[T]),h);return b.pow(C,1/h)},angle:function(j,h){return b.acos(r.dot(j,h)/(r.norm(j)*r.norm(h)))},aug:function(j,h){var C,T=[];for(C=0;C<j.length;C++)T.push(j[C].slice());for(C=0;C<T.length;C++)g.apply(T[C],h[C]);return T},inv:function(j){for(var h,C=j.length,T=j[0].length,I=r.identity(C,T),B=r.gauss_jordan(j,I),F=[],N=0;N<C;N++)for(F[N]=[],h=T;h<B[0].length;h++)F[N][h-T]=B[N][h];return F},det:function j(h){if(h.length===2)return h[0][0]*h[1][1]-h[0][1]*h[1][0];for(var C=0,T=0;T<h.length;T++){for(var I=[],B=1;B<h.length;B++){I[B-1]=[];for(var F=0;F<h.length;F++)F<T?I[B-1][F]=h[B][F]:F>T&&(I[B-1][F-1]=h[B][F])}var N=T%2?-1:1;C+=j(I)*h[0][T]*N}return C},gauss_elimination:function(j,h){var C,T,I,B,F=0,N=0,O=j.length,G=j[0].length,q=1,se=0,ge=[];for(C=(j=r.aug(j,h))[0].length,F=0;F<O;F++){for(T=j[F][F],N=F,B=F+1;B<G;B++)T<b.abs(j[B][F])&&(T=j[B][F],N=B);if(N!=F)for(B=0;B<C;B++)I=j[F][B],j[F][B]=j[N][B],j[N][B]=I;for(N=F+1;N<O;N++)for(q=j[N][F]/j[F][F],B=F;B<C;B++)j[N][B]=j[N][B]-q*j[F][B]}for(F=O-1;F>=0;F--){for(se=0,N=F+1;N<=O-1;N++)se+=ge[N]*j[F][N];ge[F]=(j[F][C-1]-se)/j[F][F]}return ge},gauss_jordan:function(j,h){var C,T,I,B=r.aug(j,h),F=B.length,N=B[0].length,O=0;for(T=0;T<F;T++){var G=T;for(I=T+1;I<F;I++)b.abs(B[I][T])>b.abs(B[G][T])&&(G=I);var q=B[T];for(B[T]=B[G],B[G]=q,I=T+1;I<F;I++)for(O=B[I][T]/B[T][T],C=T;C<N;C++)B[I][C]-=B[T][C]*O}for(T=F-1;T>=0;T--){for(O=B[T][T],I=0;I<T;I++)for(C=N-1;C>T-1;C--)B[I][C]-=B[T][C]*B[I][T]/O;for(B[T][T]/=O,C=F;C<N;C++)B[T][C]/=O}return B},triaUpSolve:function(j,h){var C,T=j[0].length,I=r.zeros(1,T)[0],B=!1;return h[0].length!=null&&(h=h.map(function(F){return F[0]}),B=!0),r.arange(T-1,-1,-1).forEach(function(F){C=r.arange(F+1,T).map(function(N){return I[N]*j[F][N]}),I[F]=(h[F]-r.sum(C))/j[F][F]}),B?I.map(function(F){return[F]}):I},triaLowSolve:function(j,h){var C,T=j[0].length,I=r.zeros(1,T)[0],B=!1;return h[0].length!=null&&(h=h.map(function(F){return F[0]}),B=!0),r.arange(T).forEach(function(F){C=r.arange(F).map(function(N){return j[F][N]*I[N]}),I[F]=(h[F]-r.sum(C))/j[F][F]}),B?I.map(function(F){return[F]}):I},lu:function(j){var h,C=j.length,T=r.identity(C),I=r.zeros(j.length,j[0].length);return r.arange(C).forEach(function(B){I[0][B]=j[0][B]}),r.arange(1,C).forEach(function(B){r.arange(B).forEach(function(F){h=r.arange(F).map(function(N){return T[B][N]*I[N][F]}),T[B][F]=(j[B][F]-r.sum(h))/I[F][F]}),r.arange(B,C).forEach(function(F){h=r.arange(B).map(function(N){return T[B][N]*I[N][F]}),I[B][F]=j[h.length][F]-r.sum(h)})}),[T,I]},cholesky:function(j){var h,C=j.length,T=r.zeros(j.length,j[0].length);return r.arange(C).forEach(function(I){h=r.arange(I).map(function(B){return b.pow(T[I][B],2)}),T[I][I]=b.sqrt(j[I][I]-r.sum(h)),r.arange(I+1,C).forEach(function(B){h=r.arange(I).map(function(F){return T[I][F]*T[B][F]}),T[B][I]=(j[I][B]-r.sum(h))/T[I][I]})}),T},gauss_jacobi:function(j,h,C,T){for(var I,B,F,N,O=0,G=0,q=j.length,se=[],ge=[],ie=[];O<q;O++)for(se[O]=[],ge[O]=[],ie[O]=[],G=0;G<q;G++)O>G?(se[O][G]=j[O][G],ge[O][G]=ie[O][G]=0):O<G?(ge[O][G]=j[O][G],se[O][G]=ie[O][G]=0):(ie[O][G]=j[O][G],se[O][G]=ge[O][G]=0);for(F=r.multiply(r.multiply(r.inv(ie),r.add(se,ge)),-1),B=r.multiply(r.inv(ie),h),I=C,N=r.add(r.multiply(F,C),B),O=2;b.abs(r.norm(r.subtract(N,I)))>T;)I=N,N=r.add(r.multiply(F,I),B),O++;return N},gauss_seidel:function(j,h,C,T){for(var I,B,F,N,O,G=0,q=j.length,se=[],ge=[],ie=[];G<q;G++)for(se[G]=[],ge[G]=[],ie[G]=[],I=0;I<q;I++)G>I?(se[G][I]=j[G][I],ge[G][I]=ie[G][I]=0):G<I?(ge[G][I]=j[G][I],se[G][I]=ie[G][I]=0):(ie[G][I]=j[G][I],se[G][I]=ge[G][I]=0);for(N=r.multiply(r.multiply(r.inv(r.add(ie,se)),ge),-1),F=r.multiply(r.inv(r.add(ie,se)),h),B=C,O=r.add(r.multiply(N,C),F),G=2;b.abs(r.norm(r.subtract(O,B)))>T;)B=O,O=r.add(r.multiply(N,B),F),G+=1;return O},SOR:function(j,h,C,T,I){for(var B,F,N,O,G,q=0,se=j.length,ge=[],ie=[],xe=[];q<se;q++)for(ge[q]=[],ie[q]=[],xe[q]=[],B=0;B<se;B++)q>B?(ge[q][B]=j[q][B],ie[q][B]=xe[q][B]=0):q<B?(ie[q][B]=j[q][B],ge[q][B]=xe[q][B]=0):(xe[q][B]=j[q][B],ge[q][B]=ie[q][B]=0);for(O=r.multiply(r.inv(r.add(xe,r.multiply(ge,I))),r.subtract(r.multiply(xe,1-I),r.multiply(ie,I))),N=r.multiply(r.multiply(r.inv(r.add(xe,r.multiply(ge,I))),h),I),F=C,G=r.add(r.multiply(O,C),N),q=2;b.abs(r.norm(r.subtract(G,F)))>T;)F=G,G=r.add(r.multiply(O,F),N),q++;return G},householder:function(j){for(var h,C,T,I,B=j.length,F=j[0].length,N=0,O=[],G=[];N<B-1;N++){for(h=0,I=N+1;I<F;I++)h+=j[I][N]*j[I][N];for(h=(j[N+1][N]>0?-1:1)*b.sqrt(h),C=b.sqrt((h*h-j[N+1][N]*h)/2),(O=r.zeros(B,1))[N+1][0]=(j[N+1][N]-h)/(2*C),T=N+2;T<B;T++)O[T][0]=j[T][N]/(2*C);G=r.subtract(r.identity(B,F),r.multiply(r.multiply(O,r.transpose(O)),2)),j=r.multiply(G,r.multiply(j,G))}return j},QR:(H=r.sum,P=r.arange,function(j){var h,C,T,I=j.length,B=j[0].length,F=r.zeros(B,B);for(j=r.copy(j),C=0;C<B;C++){for(F[C][C]=b.sqrt(H(P(I).map(function(N){return j[N][C]*j[N][C]}))),h=0;h<I;h++)j[h][C]=j[h][C]/F[C][C];for(T=C+1;T<B;T++)for(F[C][T]=H(P(I).map(function(N){return j[N][C]*j[N][T]})),h=0;h<I;h++)j[h][T]=j[h][T]-j[h][C]*F[C][T]}return[j,F]}),lstsq:function(j,h){var C=!1;h[0].length===void 0&&(h=h.map(function(se){return[se]}),C=!0);var T=r.QR(j),I=T[0],B=T[1],F=j[0].length,N=r.slice(I,{col:{end:F}}),O=function(se){var ge=(se=r.copy(se)).length,ie=r.identity(ge);return r.arange(ge-1,-1,-1).forEach(function(xe){r.sliceAssign(ie,{row:xe},r.divide(r.slice(ie,{row:xe}),se[xe][xe])),r.sliceAssign(se,{row:xe},r.divide(r.slice(se,{row:xe}),se[xe][xe])),r.arange(xe).forEach(function(Te){var ye=r.multiply(se[Te][xe],-1),ae=r.slice(se,{row:Te}),ke=r.multiply(r.slice(se,{row:xe}),ye);r.sliceAssign(se,{row:Te},r.add(ae,ke));var Ke=r.slice(ie,{row:Te}),qe=r.multiply(r.slice(ie,{row:xe}),ye);r.sliceAssign(ie,{row:Te},r.add(Ke,qe))})}),ie}(r.slice(B,{row:{end:F}})),G=r.transpose(N);G[0].length===void 0&&(G=[G]);var q=r.multiply(r.multiply(O,G),h);return q.length===void 0&&(q=[[q]]),C?q.map(function(se){return se[0]}):q},jacobi:function(j){for(var h,C,T,I,B,F,N,O=1,G=j.length,q=r.identity(G,G),se=[];O===1;){for(B=j[0][1],T=0,I=1,h=0;h<G;h++)for(C=0;C<G;C++)h!=C&&B<b.abs(j[h][C])&&(B=b.abs(j[h][C]),T=h,I=C);for(F=j[T][T]===j[I][I]?j[T][I]>0?b.PI/4:-b.PI/4:b.atan(2*j[T][I]/(j[T][T]-j[I][I]))/2,(N=r.identity(G,G))[T][T]=b.cos(F),N[T][I]=-b.sin(F),N[I][T]=b.sin(F),N[I][I]=b.cos(F),q=r.multiply(q,N),j=r.multiply(r.multiply(r.inv(N),j),N),O=0,h=1;h<G;h++)for(C=1;C<G;C++)h!=C&&b.abs(j[h][C])>.001&&(O=1)}for(h=0;h<G;h++)se.push(j[h][h]);return[q,se]},rungekutta:function(j,h,C,T,I,B){var F,N,O;if(B===2)for(;T<=C;)I+=((F=h*j(T,I))+(N=h*j(T+h,I+F)))/2,T+=h;if(B===4)for(;T<=C;)I+=((F=h*j(T,I))+2*(N=h*j(T+h/2,I+F/2))+2*(O=h*j(T+h/2,I+N/2))+h*j(T+h,I+O))/6,T+=h;return I},romberg:function(j,h,C,T){for(var I,B,F,N,O,G=0,q=(C-h)/2,se=[],ge=[],ie=[];G<T/2;){for(O=j(h),F=h,N=0;F<=C;F+=q,N++)se[N]=F;for(I=se.length,F=1;F<I-1;F++)O+=(F%2!=0?4:2)*j(se[F]);O=q/3*(O+j(C)),ie[G]=O,q/=2,G++}for(B=ie.length,I=1;B!==1;){for(F=0;F<B-1;F++)ge[F]=(b.pow(4,I)*ie[F+1]-ie[F])/(b.pow(4,I)-1);B=ge.length,ie=ge,ge=[],I++}return ie},richardson:function(j,h,C,T){function I(xe,Te){for(var ye,ae=0,ke=xe.length;ae<ke;ae++)xe[ae]===Te&&(ye=ae);return ye}for(var B,F,N,O,G,q=b.abs(C-j[I(j,C)+1]),se=0,ge=[],ie=[];T>=q;)B=I(j,C+T),F=I(j,C),ge[se]=(h[B]-2*h[F]+h[2*F-B])/(T*T),T/=2,se++;for(O=ge.length,N=1;O!=1;){for(G=0;G<O-1;G++)ie[G]=(b.pow(4,N)*ge[G+1]-ge[G])/(b.pow(4,N)-1);O=ie.length,ge=ie,ie=[],N++}return ge},simpson:function(j,h,C,T){for(var I,B=(C-h)/T,F=j(h),N=[],O=h,G=0,q=1;O<=C;O+=B,G++)N[G]=O;for(I=N.length;q<I-1;q++)F+=(q%2!=0?4:2)*j(N[q]);return B/3*(F+j(C))},hermite:function(j,h,C,T){for(var I,B=j.length,F=0,N=0,O=[],G=[],q=[],se=[];N<B;N++){for(O[N]=1,I=0;I<B;I++)N!=I&&(O[N]*=(T-j[I])/(j[N]-j[I]));for(G[N]=0,I=0;I<B;I++)N!=I&&(G[N]+=1/(j[N]-j[I]));q[N]=(1-2*(T-j[N])*G[N])*(O[N]*O[N]),se[N]=(T-j[N])*(O[N]*O[N]),F+=q[N]*h[N]+se[N]*C[N]}return F},lagrange:function(j,h,C){for(var T,I,B=0,F=0,N=j.length;F<N;F++){for(I=h[F],T=0;T<N;T++)F!=T&&(I*=(C-j[T])/(j[F]-j[T]));B+=I}return B},cubic_spline:function(j,h,C){for(var T,I,B=j.length,F=0,N=[],O=[],G=[],q=[],se=[],ge=[];F<B-1;F++)q[F]=j[F+1]-j[F];for(G[0]=0,F=1;F<B-1;F++)G[F]=3/q[F]*(h[F+1]-h[F])-3/q[F-1]*(h[F]-h[F-1]);for(F=1;F<B-1;F++)N[F]=[],O[F]=[],N[F][F-1]=q[F-1],N[F][F]=2*(q[F-1]+q[F]),N[F][F+1]=q[F],O[F][0]=G[F];for(I=r.multiply(r.inv(N),O),T=0;T<B-1;T++)se[T]=(h[T+1]-h[T])/q[T]-q[T]*(I[T+1][0]+2*I[T][0])/3,ge[T]=(I[T+1][0]-I[T][0])/(3*q[T]);for(T=0;T<B&&!(j[T]>C);T++);return h[T-=1]+(C-j[T])*se[T]+r.sq(C-j[T])*I[T]+(C-j[T])*r.sq(C-j[T])*ge[T]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(j){var h,C,T,I,B,F=j.length,N=j[0].length,O=0,G=[],q=[],se=[],ge=[],ie=[],xe=[],Te=[];for(O=0;O<F;O++)G[O]=r.sum(j[O])/N;for(O=0;O<N;O++)for(ie[O]=[],h=0;h<F;h++)ie[O][h]=j[h][O]-G[h];for(ie=r.transpose(ie),O=0;O<F;O++)for(xe[O]=[],h=0;h<F;h++)xe[O][h]=r.dot([ie[O]],[ie[h]])/(N-1);for(B=(T=r.jacobi(xe))[0],q=T[1],Te=r.transpose(B),O=0;O<q.length;O++)for(h=O;h<q.length;h++)q[O]<q[h]&&(C=q[O],q[O]=q[h],q[h]=C,se=Te[O],Te[O]=Te[h],Te[h]=se);for(I=r.transpose(ie),O=0;O<F;O++)for(ge[O]=[],h=0;h<I.length;h++)ge[O][h]=r.dot([Te[O]],[I[h]]);return[j,q,Te,ge]}}),function(j){for(var h=0;h<j.length;h++)(function(C){r.fn[C]=function(T,I){var B=this;return I?(setTimeout(function(){I.call(B,r.fn[C].call(B,T))},15),this):typeof r[C](this,T)=="number"?r[C](this,T):r(r[C](this,T))}})(j[h])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(d,Math),function(r,b){var H=[].slice,P=r.utils.isNumber,g=r.utils.isArray;function u(m,j,h,C){if(m>1||h>1||m<=0||h<=0)throw new Error("Proportions should be greater than 0 and less than 1");var T=(m*j+h*C)/(j+C);return(m-h)/b.sqrt(T*(1-T)*(1/j+1/C))}r.extend({zscore:function(){var m=H.call(arguments);return P(m[1])?(m[0]-m[1])/m[2]:(m[0]-r.mean(m[1]))/r.stdev(m[1],m[2])},ztest:function(){var m,j=H.call(arguments);return g(j[1])?(m=r.zscore(j[0],j[1],j[3]),j[2]===1?r.normal.cdf(-b.abs(m),0,1):2*r.normal.cdf(-b.abs(m),0,1)):j.length>2?(m=r.zscore(j[0],j[1],j[2]),j[3]===1?r.normal.cdf(-b.abs(m),0,1):2*r.normal.cdf(-b.abs(m),0,1)):(m=j[0],j[1]===1?r.normal.cdf(-b.abs(m),0,1):2*r.normal.cdf(-b.abs(m),0,1))}}),r.extend(r.fn,{zscore:function(m,j){return(m-this.mean())/this.stdev(j)},ztest:function(m,j,h){var C=b.abs(this.zscore(m,h));return j===1?r.normal.cdf(-C,0,1):2*r.normal.cdf(-C,0,1)}}),r.extend({tscore:function(){var m=H.call(arguments);return m.length===4?(m[0]-m[1])/(m[2]/b.sqrt(m[3])):(m[0]-r.mean(m[1]))/(r.stdev(m[1],!0)/b.sqrt(m[1].length))},ttest:function(){var m,j=H.call(arguments);return j.length===5?(m=b.abs(r.tscore(j[0],j[1],j[2],j[3])),j[4]===1?r.studentt.cdf(-m,j[3]-1):2*r.studentt.cdf(-m,j[3]-1)):P(j[1])?(m=b.abs(j[0]),j[2]==1?r.studentt.cdf(-m,j[1]-1):2*r.studentt.cdf(-m,j[1]-1)):(m=b.abs(r.tscore(j[0],j[1])),j[2]==1?r.studentt.cdf(-m,j[1].length-1):2*r.studentt.cdf(-m,j[1].length-1))}}),r.extend(r.fn,{tscore:function(m){return(m-this.mean())/(this.stdev(!0)/b.sqrt(this.cols()))},ttest:function(m,j){return j===1?1-r.studentt.cdf(b.abs(this.tscore(m)),this.cols()-1):2*r.studentt.cdf(-b.abs(this.tscore(m)),this.cols()-1)}}),r.extend({anovafscore:function(){var m,j,h,C,T,I,B,F,N=H.call(arguments);if(N.length===1){for(T=new Array(N[0].length),B=0;B<N[0].length;B++)T[B]=N[0][B];N=T}for(j=new Array,B=0;B<N.length;B++)j=j.concat(N[B]);for(h=r.mean(j),m=0,B=0;B<N.length;B++)m+=N[B].length*b.pow(r.mean(N[B])-h,2);for(m/=N.length-1,I=0,B=0;B<N.length;B++)for(C=r.mean(N[B]),F=0;F<N[B].length;F++)I+=b.pow(N[B][F]-C,2);return m/(I/(j.length-N.length))},anovaftest:function(){var m,j,h,C,T=H.call(arguments);if(P(T[0]))return 1-r.centralF.cdf(T[0],T[1],T[2]);var I=r.anovafscore(T);for(m=T.length-1,h=0,C=0;C<T.length;C++)h+=T[C].length;return j=h-m-1,1-r.centralF.cdf(I,m,j)},ftest:function(m,j,h){return 1-r.centralF.cdf(m,j,h)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var m,j=0;for(m=0;m<this.length;m++)j+=this[m].length;return r.ftest(this.anovafscore(),this.length-1,j-this.length)}}),r.extend({qscore:function(){var m,j,h,C,T,I=H.call(arguments);return P(I[0])?(m=I[0],j=I[1],h=I[2],C=I[3],T=I[4]):(m=r.mean(I[0]),j=r.mean(I[1]),h=I[0].length,C=I[1].length,T=I[2]),b.abs(m-j)/(T*b.sqrt((1/h+1/C)/2))},qtest:function(){var m,j=H.call(arguments);j.length===3?(m=j[0],j=j.slice(1)):j.length===7?(m=r.qscore(j[0],j[1],j[2],j[3],j[4]),j=j.slice(5)):(m=r.qscore(j[0],j[1],j[2]),j=j.slice(3));var h=j[0],C=j[1];return 1-r.tukey.cdf(m,C,h-C)},tukeyhsd:function(m){for(var j=r.pooledstdev(m),h=m.map(function(N){return r.mean(N)}),C=m.reduce(function(N,O){return N+O.length},0),T=[],I=0;I<m.length;++I)for(var B=I+1;B<m.length;++B){var F=r.qtest(h[I],h[B],m[I].length,m[B].length,j,C,m.length);T.push([[I,B],F])}return T}}),r.extend({normalci:function(){var m,j=H.call(arguments),h=new Array(2);return m=j.length===4?b.abs(r.normal.inv(j[1]/2,0,1)*j[2]/b.sqrt(j[3])):b.abs(r.normal.inv(j[1]/2,0,1)*r.stdev(j[2])/b.sqrt(j[2].length)),h[0]=j[0]-m,h[1]=j[0]+m,h},tci:function(){var m,j=H.call(arguments),h=new Array(2);return m=j.length===4?b.abs(r.studentt.inv(j[1]/2,j[3]-1)*j[2]/b.sqrt(j[3])):b.abs(r.studentt.inv(j[1]/2,j[2].length-1)*r.stdev(j[2],!0)/b.sqrt(j[2].length)),h[0]=j[0]-m,h[1]=j[0]+m,h},significant:function(m,j){return m<j}}),r.extend(r.fn,{normalci:function(m,j){return r.normalci(m,j,this.toArray())},tci:function(m,j){return r.tci(m,j,this.toArray())}}),r.extend(r.fn,{oneSidedDifferenceOfProportions:function(m,j,h,C){var T=u(m,j,h,C);return r.ztest(T,1)},twoSidedDifferenceOfProportions:function(m,j,h,C){var T=u(m,j,h,C);return r.ztest(T,2)}})}(d,Math),d.models=function(){function r(b,H){var P=b.length,g=H[0].length-1,u=P-g-1,m=d.lstsq(H,b),j=d.multiply(H,m.map(function(F){return[F]})).map(function(F){return F[0]}),h=d.subtract(b,j),C=d.mean(b),T=d.sum(j.map(function(F){return Math.pow(F-C,2)})),I=d.sum(b.map(function(F,N){return Math.pow(F-j[N],2)})),B=T+I;return{exog:H,endog:b,nobs:P,df_model:g,df_resid:u,coef:m,predict:j,resid:h,ybar:C,SST:B,SSE:T,SSR:I,R2:T/B}}return{ols:function(b,H){var P=r(b,H),g=function(j){var h,C,T=(h=j.exog,C=h[0].length,d.arange(C).map(function(q){var se=d.arange(C).filter(function(ge){return ge!==q});return r(d.col(h,q).map(function(ge){return ge[0]}),d.col(h,se))})),I=Math.sqrt(j.SSR/j.df_resid),B=T.map(function(q){var se=q.SST,ge=q.R2;return I/Math.sqrt(se*(1-ge))}),F=j.coef.map(function(q,se){return(q-0)/B[se]}),N=F.map(function(q){var se=d.studentt.cdf(q,j.df_resid);return 2*(se>.5?1-se:se)}),O=d.studentt.inv(.975,j.df_resid),G=j.coef.map(function(q,se){var ge=O*B[se];return[q-ge,q+ge]});return{se:B,t:F,p:N,sigmaHat:I,interval95:G}}(P),u=function(j){var h,C,T,I=j.R2/j.df_model/((1-j.R2)/j.df_resid);return{F_statistic:I,pvalue:1-(h=I,C=j.df_model,T=j.df_resid,d.beta.cdf(h/(T/C+h),C/2,T/2))}}(P),m=1-(1-P.R2)*((P.nobs-1)/P.df_resid);return P.t=g,P.f=u,P.adjust_R2=m,P}}}(),d.extend({buildxmatrix:function(){for(var r=new Array(arguments.length),b=0;b<arguments.length;b++)r[b]=[1].concat(arguments[b]);return d(r)},builddxmatrix:function(){for(var r=new Array(arguments[0].length),b=0;b<arguments[0].length;b++)r[b]=[1].concat(arguments[0][b]);return d(r)},buildjxmatrix:function(r){for(var b=new Array(r.length),H=0;H<r.length;H++)b[H]=r[H];return d.builddxmatrix(b)},buildymatrix:function(r){return d(r).transpose()},buildjymatrix:function(r){return r.transpose()},matrixmult:function(r,b){var H,P,g,u,m;if(r.cols()==b.rows()){if(b.rows()>1){for(u=[],H=0;H<r.rows();H++)for(u[H]=[],P=0;P<b.cols();P++){for(m=0,g=0;g<r.cols();g++)m+=r.toArray()[H][g]*b.toArray()[g][P];u[H][P]=m}return d(u)}for(u=[],H=0;H<r.rows();H++)for(u[H]=[],P=0;P<b.cols();P++){for(m=0,g=0;g<r.cols();g++)m+=r.toArray()[H][g]*b.toArray()[P];u[H][P]=m}return d(u)}},regress:function(r,b){var H=d.xtranspxinv(r),P=r.transpose(),g=d.matrixmult(d(H),P);return d.matrixmult(g,b)},regresst:function(r,b,H){var P=d.regress(r,b),g={anova:{}},u=d.jMatYBar(r,P);g.yBar=u;var m=b.mean();g.anova.residuals=d.residuals(b,u),g.anova.ssr=d.ssr(u,m),g.anova.msr=g.anova.ssr/(r[0].length-1),g.anova.sse=d.sse(b,u),g.anova.mse=g.anova.sse/(b.length-(r[0].length-1)-1),g.anova.sst=d.sst(b,m),g.anova.mst=g.anova.sst/(b.length-1),g.anova.r2=1-g.anova.sse/g.anova.sst,g.anova.r2<0&&(g.anova.r2=0),g.anova.fratio=g.anova.msr/g.anova.mse,g.anova.pvalue=d.anovaftest(g.anova.fratio,r[0].length-1,b.length-(r[0].length-1)-1),g.anova.rmse=Math.sqrt(g.anova.mse),g.anova.r2adj=1-g.anova.mse/g.anova.mst,g.anova.r2adj<0&&(g.anova.r2adj=0),g.stats=new Array(r[0].length);for(var j,h,C,T=d.xtranspxinv(r),I=0;I<P.length;I++)j=Math.sqrt(g.anova.mse*Math.abs(T[I][I])),h=Math.abs(P[I]/j),C=d.ttest(h,b.length-r[0].length-1,H),g.stats[I]=[P[I],j,h,C];return g.regress=P,g},xtranspx:function(r){return d.matrixmult(r.transpose(),r)},xtranspxinv:function(r){var b=d.matrixmult(r.transpose(),r);return d.inv(b)},jMatYBar:function(r,b){var H=d.matrixmult(r,b);return new d(H)},residuals:function(r,b){return d.matrixsubtract(r,b)},ssr:function(r,b){for(var H=0,P=0;P<r.length;P++)H+=Math.pow(r[P]-b,2);return H},sse:function(r,b){for(var H=0,P=0;P<r.length;P++)H+=Math.pow(r[P]-b[P],2);return H},sst:function(r,b){for(var H=0,P=0;P<r.length;P++)H+=Math.pow(r[P]-b,2);return H},matrixsubtract:function(r,b){for(var H=new Array(r.length),P=0;P<r.length;P++){H[P]=new Array(r[P].length);for(var g=0;g<r[P].length;g++)H[P][g]=r[P][g]-b[P][g]}return d(H)}}),d.jStat=d,d)},960:function(U,d,r){const b=r(592);U.exports=function(H){function P(I,B){const F=B.split(".");let N=I;for(const O of F){if(N==null)return;N=N[O]}return N}for(let I=0;I<Object.keys(b).length;I++){let B,F=Object.keys(b)[I],N=[];if(typeof b[F]=="object"){N=Object.keys(b[F]),B=Object.values(b[F]);for(let O=0;O<B.length;O++)if(typeof B[O]=="object"){let G=N[O];b[F][G]&&(N=[...N,...Object.keys(b[F][G]).map(q=>G+"."+q)],N.splice(N.indexOf(G),1))}}if(N.length<1)H[F]=b[F];else for(let O=0;O<N.length;O++)typeof P(b[F],N[O])=="function"&&(H[F]=P(b[F],N[O]))}let g=function(I){return typeof I=="number"&&(I=parseInt(I)),I},u=null,m=null,j=null;H.TABLE=function(){return j},H.COLUMN=H.COL=function(){return j.tracking&&j.tracking.push(T.getColumnNameFromCoords(g(u),g(m))),g(u)+1},H.ROW=function(){return j.tracking&&j.tracking.push(T.getColumnNameFromCoords(g(u),g(m))),g(m)+1},H.CELL=function(){return T.getColumnNameFromCoords(u,m)},H.VALUE=function(I,B,F){return j.getValueFromCoords(g(I)-1,g(B)-1,F)},H.THISROWCELL=function(I){return j.getValueFromCoords(g(I)-1,g(m))};const h=function(I,B){for(let F=0;F<I.length;F++){let N=T.getTokensFromRange(I[F]);B=B.replace(I[F],"["+N.join(",")+"]")}return B},C=function(I){return typeof I=="string"&&(I=I.trim()),!isNaN(I)&&I!==null&&I!==""},T=function(I,B,F,N,O){j=O,u=F,m=N;let G="",q={};if(B)if(B.size){let ie,xe=null;B.forEach(function(Te,ye){ie=ye.replace(/!/g,"."),ie.indexOf(".")!==-1&&(ie=ie.split("."),q[ie[0]]=!0)}),ie=Object.keys(q);for(let Te=0;Te<ie.length;Te++)G+="var "+ie[Te]+" = {};";B.forEach(function(Te,ye){ie=ye.replace(/!/g,"."),Te===null||C(Te)||(xe=Te.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),xe&&xe.length&&(Te=updateRanges(xe,Te))),ie.indexOf(".")>0?G+=ie+" = "+B.get(ye)+`;
`:G+="var "+ie+" = "+Te+`;
`})}else{let ie=Object.keys(B);if(ie.length){let xe,Te={};for(let ye=0;ye<ie.length;ye++)if(xe=ie[ye].replace(/\!/g,"."),xe.indexOf(".")>0){let ae=ae.split(".");Te[ae[0]]={}}xe=Object.keys(Te);for(let ye=0;ye<xe.length;ye++)G+="var "+xe[ye]+" = {};";for(let ye=0;ye<ie.length;ye++){if(xe=ie[ye].replace(/!/g,"."),B[ie[ye]]!==null&&!C(B[ie[ye]])){let ae=B[ie[ye]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ae&&ae.length&&(B[ie[ye]]=h(ae,B[ie[ye]]))}xe.indexOf(".")>0?G+=xe+" = "+B[ie[ye]]+`;
`:G+="var "+xe+" = "+B[ie[ye]]+`;
`}}}let se=(I=function(ie,xe){let Te="",ye=0,ae=["=","!",">","<"];for(let ke=0;ke<ie.length;ke++)ie[ke]==='"'&&(ye=ye===0?1:0),ye===1?Te+=ie[ke]:(Te+=ie[ke].toUpperCase(),ke>0&&ie[ke]==="="&&ae.indexOf(ie[ke-1])===-1&&ae.indexOf(ie[ke+1])===-1&&(Te+="="));return Te=Te.replace(/\^/g,"**"),Te=Te.replace(/<>/g,"!="),Te=Te.replace(/&/g,"+"),Te=Te.replace(/\$/g,""),Te}(I=(I=I.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);se&&se.length&&(I=h(se,I));let ge=new Function(G+"; return "+I)();return ge===null&&(ge=0),ge};return T.getColumnNameFromCoords=function(I,B){return N="",(F=parseInt(I))>701?(N+=String.fromCharCode(64+parseInt(F/676)),N+=String.fromCharCode(64+parseInt(F%676/26))):F>25&&(N+=String.fromCharCode(64+parseInt(F/26))),N+String.fromCharCode(65+F%26)+(parseInt(B)+1);var F,N},T.getCoordsFromColumnName=function(I){var B=/^[a-zA-Z]+/.exec(I);if(B){for(var F=0,N=0;N<B[0].length;N++)F+=parseInt(B[0].charCodeAt(N)-64)*Math.pow(26,B[0].length-1-N);--F<0&&(F=0);var O=parseInt(/[0-9]+$/.exec(I))||null;return O>0&&O--,[F,O]}},T.getRangeFromTokens=function(I){I=I.filter(function(O){return O!="#REF!"});for(var B="",F="",N=0;N<I.length;N++)I[N].indexOf(".")>=0?B=".":I[N].indexOf("!")>=0&&(B="!"),B&&(F=I[N].split(B),I[N]=F[1],F=F[0]+B);return I.sort(function(O,G){var q=Helpers.getCoordsFromColumnName(O),se=Helpers.getCoordsFromColumnName(G);return q[1]>se[1]?1:q[1]<se[1]?-1:q[0]>se[0]?1:q[0]<se[0]?-1:0}),I.length?F+(I[0]+":")+I[I.length-1]:"#REF!"},T.getTokensFromRange=function(I){if(I.indexOf(".")>0){var B=I.split(".");I=B[1],B=B[0]+"."}else I.indexOf("!")>0?(B=I.split("!"),I=B[1],B=B[0]+"!"):B="";I=I.split(":");var F=T.getCoordsFromColumnName(I[0]),N=T.getCoordsFromColumnName(I[1]);if(F[0]<=N[0])var O=F[0],G=N[0];else O=N[0],G=F[0];if(F[1]===null&&N[1]==null)for(var q=null,se=null,ge=Object.keys(vars),ie=0;ie<ge.length;ie++){var xe=T.getCoordsFromColumnName(ge[ie]);xe[0]===F[0]&&(q===null||xe[1]<q)&&(q=xe[1]),xe[0]===N[0]&&(se===null||xe[1]>se)&&(se=xe[1])}else F[1]<=N[1]?(q=F[1],se=N[1]):(q=N[1],se=F[1]);for(var Te=[],ye=q;ye<=se;ye++){var ae=[];for(ie=O;ie<=G;ie++)ae.push(B+T.getColumnNameFromCoords(ie,ye));Te.push(ae)}return Te},T.setFormula=function(I){let B=Object.keys(I);for(let F=0;F<B.length;F++)typeof I[B[F]]=="function"&&(H[B[F]]=I[B[F]])},T.basic=!0,T}(typeof window>"u"?r.g:window)},592:function(U,d,r){var b=r(162),H=r(765);const P=new Error("#NULL!"),g=new Error("#DIV/0!"),u=new Error("#VALUE!"),m=new Error("#REF!"),j=new Error("#NAME?"),h=new Error("#NUM!"),C=new Error("#N/A"),T=new Error("#ERROR!"),I=new Error("#GETTING_DATA");var B=Object.freeze({__proto__:null,data:I,div0:g,error:T,na:C,name:j,nil:P,num:h,ref:m,value:u});function F(e){const t=[];return N(e,a=>{t.push(a)}),t}function N(e,t){let a=-1;const p=e.length;for(;++a<p&&t(e[a],a,e)!==!1;);return e}function O(e){let t,a=e.length;for(;a--;)if(t=e[a],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const p=Y(t);e[a]=p instanceof Error?0:p}}else e[a]=0;else e[a]=1;return e}function G(e,t){if(!e)return u;e.every(L=>Array.isArray(L))&&e.length!==0||(e=[[...e]]),e.map((L,R)=>{L.map((z,re)=>{z||(e[R][re]=0)})});const a=e.reduce((L,R,z)=>R.length>e[L].length?z:L,0),p=e[a].length;return e.map(L=>[...L,...Array(p-L.length).fill(t||0)])}function q(){let e;if(arguments.length===1){const a=arguments[0];e=(t=a)!=null&&typeof t.length=="number"&&typeof t!="string"?F.apply(null,arguments):[a]}else e=Array.from(arguments);for(var t;!ge(e);)e=se(e);return e}function se(e){return e&&e.reduce?e.reduce((t,a)=>{const p=Array.isArray(t),L=Array.isArray(a);return p&&L?t.concat(a):p?(t.push(a),t):L?[t].concat(a):[t,a]}):[e]}function ge(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function ie(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function xe(e){return e?e[0].map((t,a)=>e.map(p=>p[a])):u}function Te(e,t){let a=null;return N(e,(p,L)=>{if(p[0]===t)return a=L,!1}),a??u}function ye(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function ae(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function ke(e){return Math.round(e*1e14)/1e14}function Ke(){return q.apply(null,arguments).filter(e=>typeof e=="number")}function qe(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||u}function Be(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?h:function(a){a<60&&(a+=1);const p=Math.floor(a-25569),L=new Date(86400*p*1e3),R=a-Math.floor(a)+1e-7;let z=Math.floor(86400*R);const re=z%60;z-=re;const pe=Math.floor(z/3600),Ee=Math.floor(z/60)%60;let Se=L.getUTCDate(),_e=L.getUTCMonth();return a>=60&&a<61&&(Se=29,_e=1),new Date(L.getUTCFullYear(),_e,Se,pe,Ee,re)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?u:e}function lt(e){let t,a=e.length;for(;a--;){if(t=Be(e[a]),t===u)return t;e[a]=t}return e}function Y(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?u:parseFloat(e))}function Le(e){let t,a;if(!e||(t=e.length)===0)return u;for(;t--;){if(e[t]instanceof Error)return e[t];if(a=Y(e[t]),a instanceof Error)return a;e[t]=a}return e}function Ue(e){return e instanceof Error?e:e==null?"":e.toString()}function mt(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function Me(e){return e!=null}const Ie="=",Oe=[">",">=","<","<=","=","<>"],ze="operator",Ge="literal",Qe=[ze,Ge],ct=ze,at=Ge;function dt(e,t){if(Qe.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function vt(e){return function(t){let a="";const p=[];for(let L=0;L<t.length;L++){const R=t[L];L===0&&Oe.indexOf(R)>=0?p.push(dt(R,ct)):a+=R}return a.length>0&&p.push(dt(function(L){return typeof L!="string"||/^\d+(\.\d+)?$/.test(L)&&(L=L.indexOf(".")===-1?parseInt(L,10):parseFloat(L)),L}(a),at)),p.length>0&&p[0].type!==ct&&p.unshift(dt(Ie,ct)),p}(function(t){const a=t.length,p=[];let L=0,R="",z="";for(;L<a;){const re=t.charAt(L);switch(re){case">":case"<":case"=":z+=re,R.length>0&&(p.push(R),R="");break;default:z.length>0&&(p.push(z),z=""),R+=re}L++}return R.length>0&&p.push(R),z.length>0&&p.push(z),p}(e))}const ht=function(e){const t=[];let a;for(let p=0;p<e.length;p++){const L=e[p];switch(L.type){case ct:a=L.value;break;case at:t.push(L.value)}}return function(p,L){let R=!1;switch(L){case">":R=p[0]>p[1];break;case">=":R=p[0]>=p[1];break;case"<":R=p[0]<p[1];break;case"<=":R=p[0]<=p[1];break;case"=":R=p[0]==p[1];break;case"<>":R=p[0]!=p[1]}return R}(t,a)},St={};function Ft(e){return[u,m,g,h,j,P].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function ft(e){return Ft(e)||e===C}function Ot(e){return e===!0||e===!1}function Nt(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function w(e){return typeof e=="string"}function A(){const e=[];for(let t=0;t<arguments.length;++t){let a=!1;const p=arguments[t];for(let L=0;L<e.length&&(a=e[L]===p,!a);++L);a||e.push(p)}return e}function l(e,t,a,p){if(!t||!a)return C;p=!(p===0||p===!1);let L=C;const R=typeof e=="number";let z=!1;for(let re=0;re<t.length;re++){const pe=t[re];if(pe[0]===e){L=a<pe.length+1?pe[a-1]:m;break}!z&&(R&&p&&pe[0]<=e||p&&typeof pe[0]=="string"&&pe[0].localeCompare(e)<0)&&(L=a<pe.length+1?pe[a-1]:m),R&&pe[0]>e&&(z=!0)}return L}function o(){const e=q(arguments).filter(Me);if(e.length===0)return g;const t=ye.apply(void 0,e);if(t)return t;const a=Ke(e),p=a.length;let L,R=0,z=0;for(let re=0;re<p;re++)R+=a[re],z+=1;return L=R/z,isNaN(L)&&(L=h),L}function k(){const e=q(arguments).filter(Me);if(e.length===0)return g;const t=ye.apply(void 0,e);if(t)return t;const a=e,p=a.length;let L,R=0,z=0;for(let re=0;re<p;re++){const pe=a[re];typeof pe=="number"&&(R+=pe),pe===!0&&R++,pe!==null&&z++}return L=R/z,isNaN(L)&&(L=h),L}St.TYPE=e=>{switch(e){case P:return 1;case g:return 2;case u:return 3;case m:return 4;case j:return 5;case h:return 6;case C:return 7;case I:return 8}return C};const Q={DIST:function(e,t,a,p,L,R){return arguments.length<4?u:(L=L===void 0?0:L,R=R===void 0?1:R,ae(e=Y(e),t=Y(t),a=Y(a),L=Y(L),R=Y(R))?u:(e=(e-L)/(R-L),p?b.beta.cdf(e,t,a):b.beta.pdf(e,t,a)))},INV:(e,t,a,p,L)=>(p=p===void 0?0:p,L=L===void 0?1:L,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),L=Y(L))?u:b.beta.inv(e,t,a)*(L-p)+p)},ee={DIST:(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p))?u:p?b.binomial.cdf(e,t,a):b.binomial.pdf(e,t,a)};ee.DIST.RANGE=(e,t,a,p)=>{if(p=p===void 0?a:p,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p)))return u;let L=0;for(let R=a;R<=p;R++)L+=st(e,R)*Math.pow(t,R)*Math.pow(1-t,e-R);return L},ee.INV=(e,t,a)=>{if(ae(e=Y(e),t=Y(t),a=Y(a)))return u;let p=0;for(;p<=e;){if(b.binomial.cdf(p,e,t)>=a)return p;p++}};const S={DIST:(e,t,a)=>ae(e=Y(e),t=Y(t))?u:a?b.chisquare.cdf(e,t):b.chisquare.pdf(e,t)};S.DIST.RT=(e,t)=>!e|!t?C:e<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?u:1-b.chisquare.cdf(e,t),S.INV=(e,t)=>ae(e=Y(e),t=Y(t))?u:b.chisquare.inv(e,t),S.INV.RT=(e,t)=>!e|!t?C:e<0||e>1||t<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?u:b.chisquare.inv(1-e,t),S.TEST=function(e,t){if(arguments.length!==2)return C;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return u;const a=e.length;let p,L,R;for(L=0;L<a;L++)e[L]instanceof Array||(p=e[L],e[L]=[],e[L].push(p)),t[L]instanceof Array||(p=t[L],t[L]=[],t[L].push(p));const z=e[0].length,re=z===1?a-1:(a-1)*(z-1);let pe=0;const Ee=Math.PI;for(L=0;L<a;L++)for(R=0;R<z;R++)pe+=Math.pow(e[L][R]-t[L][R],2)/t[L][R];return Math.round(1e6*function(Se,_e){let Re=Math.exp(-.5*Se);_e%2==1&&(Re*=Math.sqrt(2*Se/Ee));let Xe=_e;for(;Xe>=2;)Re=Re*Se/Xe,Xe-=2;let et=Re,nt=_e;for(;et>1e-10*Re;)nt+=2,et=et*Se/nt,Re+=et;return 1-Re}(pe,re))/1e6};const M={};function V(){return Ke(q(arguments)).length}function K(){const e=q(arguments);return e.length-oe(e)}function oe(){const e=q(arguments);let t,a=0;for(let p=0;p<e.length;p++)t=e[p],t!=null&&t!==""||a++;return a}M.NORM=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:b.normalci(1,e,t,a)[1]-1,M.T=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:b.tci(1,e,t,a)[1]-1;const ve={P:(e,t)=>{if(ae(e=Le(q(e)),t=Le(q(t))))return u;const a=b.mean(e),p=b.mean(t);let L=0;const R=e.length;for(let z=0;z<R;z++)L+=(e[z]-a)*(t[z]-p);return L/R},S:(e,t)=>ae(e=Le(q(e)),t=Le(q(t)))?u:b.covariance(e,t)},de={DIST:(e,t,a)=>ae(e=Y(e),t=Y(t))?u:a?b.exponential.cdf(e,t):b.exponential.pdf(e,t)},fe={};function le(e,t,a){if(ae(e=Y(e),t=Le(q(t)),a=Le(q(a))))return u;const p=b.mean(a),L=b.mean(t),R=a.length;let z=0,re=0;for(let Ee=0;Ee<R;Ee++)z+=(a[Ee]-p)*(t[Ee]-L),re+=Math.pow(a[Ee]-p,2);const pe=z/re;return L-pe*p+pe*e}function me(e){return(e=Y(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?h:b.gammafn(e)}function Ne(e){return(e=Y(e))instanceof Error?e:b.gammaln(e)}fe.DIST=(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:p?b.centralF.cdf(e,t,a):b.centralF.pdf(e,t,a),fe.DIST.RT=function(e,t,a){return arguments.length!==3?C:e<0||t<1||a<1?h:typeof e!="number"||typeof t!="number"||typeof a!="number"?u:1-b.centralF.cdf(e,t,a)},fe.INV=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:e<=0||e>1?h:b.centralF.inv(e,t,a),fe.INV.RT=function(e,t,a){return arguments.length!==3?C:e<0||e>1||t<1||t>Math.pow(10,10)||a<1||a>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"||typeof a!="number"?u:b.centralF.inv(1-e,t,a)},fe.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return C;if(e.length<2||t.length<2)return g;const a=(R,z)=>{let re=0;for(let pe=0;pe<R.length;pe++)re+=Math.pow(R[pe]-z,2);return re},p=At(e)/e.length,L=At(t)/t.length;return a(e,p)/(e.length-1)/(a(t,L)/(t.length-1))},me.DIST=function(e,t,a,p){return arguments.length!==4?C:e<0||t<=0||a<=0||typeof e!="number"||typeof t!="number"||typeof a!="number"?u:p?b.gamma.cdf(e,t,a,!0):b.gamma.pdf(e,t,a,!1)},me.INV=function(e,t,a){return arguments.length!==3?C:e<0||e>1||t<=0||a<=0?h:typeof e!="number"||typeof t!="number"||typeof a!="number"?u:b.gamma.inv(e,t,a)},Ne.PRECISE=function(e){return arguments.length!==1?C:e<=0?h:typeof e!="number"?u:b.gammaln(e)};const We={};function Je(e,t){return ae(e=Le(q(e)),t=Y(t))?e:t<0||e.length<t?u:e.sort((a,p)=>p-a)[t-1]}function ce(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return u;const a=b.mean(e),p=b.mean(t),L=t.length;let R=0,z=0;for(let pe=0;pe<L;pe++)R+=(t[pe]-p)*(e[pe]-a),z+=Math.pow(t[pe]-p,2);const re=R/z;return[re,a-re*p]}We.DIST=(e,t,a,p,L)=>{if(ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p)))return u;function R(z,re,pe,Ee){return st(pe,z)*st(Ee-pe,re-z)/st(Ee,re)}return L?function(z,re,pe,Ee){let Se=0;for(let _e=0;_e<=z;_e++)Se+=R(_e,re,pe,Ee);return Se}(e,t,a,p):R(e,t,a,p)};const Ae={};function X(){const e=q(arguments),t=ye.apply(void 0,e);if(t)return t;const a=Ke(e);return a.length===0?0:Math.max.apply(Math,a)}function W(){const e=q(arguments),t=ye.apply(void 0,e);if(t)return t;const a=O(e);let p=b.median(a);return isNaN(p)&&(p=h),p}function ne(){const e=q(arguments),t=ye.apply(void 0,e);if(t)return t;const a=Ke(e);return a.length===0?0:Math.min.apply(Math,a)}Ae.DIST=(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:p?b.lognormal.cdf(e,t,a):b.lognormal.pdf(e,t,a),Ae.INV=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:b.lognormal.inv(e,t,a);const v={MULT:function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=e.length,a={};let p,L=[],R=0;for(let z=0;z<t;z++)p=e[z],a[p]=a[p]?a[p]+1:1,a[p]>R&&(R=a[p],L=[]),a[p]===R&&(L[L.length]=p);return L},SNGL:function(){const e=Le(q(arguments));return e instanceof Error?e:v.MULT(e).sort((t,a)=>t-a)[0]}},_={DIST:(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:p?b.negbin.cdf(e,t,a):b.negbin.pdf(e,t,a)},J={};function he(e,t){if(ae(t=Le(q(t)),e=Le(q(e))))return u;const a=b.mean(e),p=b.mean(t),L=e.length;let R=0,z=0,re=0;for(let pe=0;pe<L;pe++)R+=(e[pe]-a)*(t[pe]-p),z+=Math.pow(e[pe]-a,2),re+=Math.pow(t[pe]-p,2);return R/Math.sqrt(z*re)}J.DIST=(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:a<=0?h:p?b.normal.cdf(e,t,a):b.normal.pdf(e,t,a),J.INV=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:b.normal.inv(e,t,a),J.S={},J.S.DIST=(e,t)=>(e=Y(e))instanceof Error?u:t?b.normal.cdf(e,0,1):b.normal.pdf(e,0,1),J.S.INV=e=>(e=Y(e))instanceof Error?u:b.normal.inv(e,0,1);const Z={EXC:(e,t)=>{if(ae(e=Le(q(e)),t=Y(t)))return u;const a=(e=e.sort((R,z)=>R-z)).length;if(t<1/(a+1)||t>1-1/(a+1))return h;const p=t*(a+1)-1,L=Math.floor(p);return ke(p===L?e[p]:e[L]+(p-L)*(e[L+1]-e[L]))},INC:(e,t)=>{if(ae(e=Le(q(e)),t=Y(t)))return u;const a=t*((e=e.sort((L,R)=>L-R)).length-1),p=Math.floor(a);return ke(a===p?e[a]:e[p]+(a-p)*(e[p+1]-e[p]))}},ue={EXC:(e,t,a)=>{if(a=a===void 0?3:a,ae(e=Le(q(e)),t=Y(t),a=Y(a)))return u;e=e.sort((Se,_e)=>Se-_e);const p=A.apply(null,e),L=e.length,R=p.length,z=Math.pow(10,a);let re=0,pe=!1,Ee=0;for(;!pe&&Ee<R;)t===p[Ee]?(re=(e.indexOf(p[Ee])+1)/(L+1),pe=!0):t>=p[Ee]&&(t<p[Ee+1]||Ee===R-1)&&(re=(e.indexOf(p[Ee])+1+(t-p[Ee])/(p[Ee+1]-p[Ee]))/(L+1),pe=!0),Ee++;return Math.floor(re*z)/z},INC:(e,t,a)=>{if(a=a===void 0?3:a,ae(e=Le(q(e)),t=Y(t),a=Y(a)))return u;e=e.sort((Se,_e)=>Se-_e);const p=A.apply(null,e),L=e.length,R=p.length,z=Math.pow(10,a);let re=0,pe=!1,Ee=0;for(;!pe&&Ee<R;)t===p[Ee]?(re=e.indexOf(p[Ee])/(L-1),pe=!0):t>=p[Ee]&&(t<p[Ee+1]||Ee===R-1)&&(re=(e.indexOf(p[Ee])+(t-p[Ee])/(p[Ee+1]-p[Ee]))/(L-1),pe=!0),Ee++;return Math.floor(re*z)/z}},je={DIST:(e,t,a)=>ae(e=Y(e),t=Y(t))?u:a?b.poisson.cdf(e,t):b.poisson.pdf(e,t)},De={EXC:(e,t)=>{if(ae(e=Le(q(e)),t=Y(t)))return u;switch(t){case 1:return Z.EXC(e,.25);case 2:return Z.EXC(e,.5);case 3:return Z.EXC(e,.75);default:return h}},INC:(e,t)=>{if(ae(e=Le(q(e)),t=Y(t)))return u;switch(t){case 1:return Z.INC(e,.25);case 2:return Z.INC(e,.5);case 3:return Z.INC(e,.75);default:return h}}},Ce={};function Fe(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=b.mean(e),a=e.length;let p=0;for(let L=0;L<a;L++)p+=Math.pow(e[L]-t,3);return a*p/((a-1)*(a-2)*Math.pow(b.stdev(e,!0),3))}function Ve(e,t){return ae(e=Le(q(e)),t=Y(t))?e:e.sort((a,p)=>a-p)[t-1]}Ce.AVG=(e,t,a)=>{if(ae(e=Y(e),t=Le(q(t))))return u;const p=(a=a||!1)?(z,re)=>z-re:(z,re)=>re-z,L=(t=(t=q(t)).sort(p)).length;let R=0;for(let z=0;z<L;z++)t[z]===e&&R++;return R>1?(2*t.indexOf(e)+R+1)/2:t.indexOf(e)+1},Ce.EQ=(e,t,a)=>{if(ae(e=Y(e),t=Le(q(t))))return u;const p=(a=a||!1)?(L,R)=>L-R:(L,R)=>R-L;return(t=t.sort(p)).indexOf(e)+1},Fe.P=function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=b.mean(e),a=e.length;let p=0,L=0;for(let R=0;R<a;R++)L+=Math.pow(e[R]-t,3),p+=Math.pow(e[R]-t,2);return L/=a,p/=a,L/Math.pow(p,1.5)};const Ze={P:function(){const e=be.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},S:function(){const e=be.S.apply(this,arguments);return Math.sqrt(e)}},te={DIST:(e,t,a)=>a!==1&&a!==2?h:a===1?te.DIST.RT(e,t):te.DIST["2T"](e,t)};te.DIST["2T"]=function(e,t){return arguments.length!==2?C:e<0||t<1?h:typeof e!="number"||typeof t!="number"?u:2*(1-b.studentt.cdf(e,t))},te.DIST.RT=function(e,t){return arguments.length!==2?C:e<0||t<1?h:typeof e!="number"||typeof t!="number"?u:1-b.studentt.cdf(e,t)},te.INV=(e,t)=>ae(e=Y(e),t=Y(t))?u:b.studentt.inv(e,t),te.INV["2T"]=(e,t)=>(e=Y(e),t=Y(t),e<=0||e>1||t<1?h:ae(e,t)?u:Math.abs(b.studentt.inv(e/2,t))),te.TEST=(e,t)=>{if(ae(e=Le(q(e)),t=Le(q(t))))return u;const a=b.mean(e),p=b.mean(t);let L,R=0,z=0;for(L=0;L<e.length;L++)R+=Math.pow(e[L]-a,2);for(L=0;L<t.length;L++)z+=Math.pow(t[L]-p,2);R/=e.length-1,z/=t.length-1;const re=Math.abs(a-p)/Math.sqrt(R/e.length+z/t.length);return te.DIST["2T"](re,e.length+t.length-2)};const be={};function we(){const e=q(arguments),t=e.length;let a=0,p=0;const L=k(e);for(let R=0;R<t;R++){const z=e[R];a+=Math.pow(typeof z=="number"?z-L:z===!0?1-L:0-L,2),z!==null&&p++}return a/(p-1)}function He(){const e=q(arguments),t=e.length;let a=0,p=0;const L=k(e);let R;for(let z=0;z<t;z++){const re=e[z];a+=Math.pow(typeof re=="number"?re-L:re===!0?1-L:0-L,2),re!==null&&p++}return R=a/p,isNaN(R)&&(R=h),R}be.P=function(){const e=Ke(q(arguments)),t=e.length;let a=0;const p=o(e);let L;for(let R=0;R<t;R++)a+=Math.pow(e[R]-p,2);return L=a/t,isNaN(L)&&(L=h),L},be.S=function(){const e=Ke(q(arguments)),t=e.length;let a=0;const p=o(e);for(let L=0;L<t;L++)a+=Math.pow(e[L]-p,2);return a/(t-1)};const tt={DIST:(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:p?1-Math.exp(-Math.pow(e/a,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/a,t))*t/Math.pow(a,t)},$e={};function ot(e,t,a){const p=ye(e=Y(e),t=Y(t),a=Y(a));if(p)return p;if(t===0)return 0;t=Math.abs(t);const L=-Math.floor(Math.log(t)/Math.log(10));return e>=0?yt(Math.ceil(e/t)*t,L):a===0?-yt(Math.floor(Math.abs(e)/t)*t,L):-yt(Math.ceil(Math.abs(e)/t)*t,L)}function st(e,t){return ye(e=Y(e),t=Y(t))||(e<t?h:Ye(e)/(Ye(t)*Ye(e-t)))}$e.TEST=(e,t,a)=>{if(ae(e=Le(q(e)),t=Y(t)))return u;a=a||Ze.S(e);const p=e.length;return 1-J.S.DIST((o(e)-t)/(a/Math.sqrt(p)),!0)},ot.MATH=ot,ot.PRECISE=ot;const Pe=[];function Ye(e){if((e=Y(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(Pe[t]>0||(Pe[t]=Ye(t-1)*t),Pe[t])}function Et(e,t){const a=ye(e=Y(e),t=Y(t));if(a)return a;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return h;t=Math.abs(t);const p=-Math.floor(Math.log(t)/Math.log(10));return e>=0?yt(Math.floor(e/t)*t,p):-yt(Math.ceil(Math.abs(e)/t),p)}Et.MATH=(e,t,a)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const p=ye(e=Y(e),t=Y(t),a=Y(a));if(p)return p;if(t===0)return 0;t=t?Math.abs(t):1;const L=-Math.floor(Math.log(t)/Math.log(10));return e>=0?yt(Math.floor(e/t)*t,L):a===0||a===void 0?-yt(Math.ceil(Math.abs(e)/t)*t,L):-yt(Math.floor(Math.abs(e)/t)*t,L)},Et.PRECISE=Et.MATH;const dn={CEILING:ot};function en(e,t){const a=ye(e=Y(e),t=Y(t));if(a)return a;if(e===0&&t===0)return h;const p=Math.pow(e,t);return isNaN(p)?h:p}function Yt(){const e=q(arguments).filter(p=>p!=null);if(e.length===0)return 0;const t=Le(e);if(t instanceof Error)return t;let a=1;for(let p=0;p<t.length;p++)a*=t[p];return a}function yt(e,t){return ye(e=Y(e),t=Y(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function At(){let e=0;return N(F(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const a=parseFloat(t);!isNaN(a)&&(e+=a)}else if(Array.isArray(t)){const a=At.apply(null,t);a instanceof Error?e=a:e+=a}}),e}var fn=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?C:ye(e=Y(e),t=Y(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?C:ye(e=Y(e),t=Y(t))||(t===0?g:e/t)},EQ:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(mt(e,t)?(e=Ue(e),t=Ue(t)):(e=Y(e),t=Y(t)),ye(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?C:(mt(e,t)?(e=Ue(e),t=Ue(t)):(e=Y(e),t=Y(t)),ye(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?C:(mt(e,t)?(e=Ue(e),t=Ue(t)):(e=Y(e),t=Y(t)),ye(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?C:(mt(e,t)?(e=Ue(e),t=Ue(t)):(e=Y(e),t=Y(t)),ye(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?C:ye(e=Y(e),t=Y(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?C:ye(e=Y(e),t=Y(t))||e*t},NE:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?C:en(e,t)}});const pn=new Date(Date.UTC(1900,0,1)),hn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],gn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],kt=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function It(e,t,a){a=a.toUpperCase(),e=Be(e),t=Be(t);const p=e.getFullYear(),L=e.getMonth(),R=e.getDate(),z=t.getFullYear(),re=t.getMonth(),pe=t.getDate();let Ee;switch(a){case"Y":Ee=Math.floor(Ut(e,t));break;case"D":Ee=Lt(t,e);break;case"M":Ee=re-L+12*(z-p),pe<R&&Ee--;break;case"MD":R<=pe?Ee=pe-R:(re===0?(e.setFullYear(z-1),e.setMonth(12)):(e.setFullYear(z),e.setMonth(re-1)),Ee=Lt(t,e));break;case"YM":Ee=re-L+12*(z-p),pe<R&&Ee--,Ee%=12;break;case"YD":re>L||re===L&&pe<R?e.setFullYear(z):e.setFullYear(z-1),Ee=Lt(t,e)}return Ee}function Rt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Lt(e,t){return e=Be(e),t=Be(t),e instanceof Error?e:t instanceof Error?t:nn(Rt(e))-nn(Rt(t))}function wt(e,t,a){if(a=qe(a||"false"),e=Be(e),t=Be(t),e instanceof Error)return e;if(t instanceof Error)return t;if(a instanceof Error)return a;const p=e.getMonth();let L,R,z=t.getMonth();if(a)L=e.getDate()===31?30:e.getDate(),R=t.getDate()===31?30:t.getDate();else{const re=new Date(e.getFullYear(),p+1,0).getDate(),pe=new Date(t.getFullYear(),z+1,0).getDate();L=e.getDate()===re?30:e.getDate(),t.getDate()===pe?L<30?(z++,R=1):R=30:R=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(z-p)+(R-L)}function tn(e){if((e=Be(e))instanceof Error)return e;(e=Rt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function Ht(e,t,a){return Ht.INTL(e,t,1,a)}function Bt(e,t,a){return Bt.INTL(e,t,1,a)}function qt(e){return new Date(e,1,29).getMonth()===1}function Pt(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function Ut(e,t,a){if((e=Be(e))instanceof Error)return e;if((t=Be(t))instanceof Error)return t;a=a||0;let p=e.getDate();const L=e.getMonth()+1,R=e.getFullYear();let z=t.getDate();const re=t.getMonth()+1,pe=t.getFullYear();switch(a){case 0:return p===31&&z===31?(p=30,z=30):p===31?p=30:p===30&&z===31&&(z=30),(z+30*re+360*pe-(p+30*L+360*R))/360;case 1:{const Ee=(Xe,et)=>{const nt=Xe.getFullYear(),gt=new Date(nt,2,1);if(qt(nt)&&Xe<gt&&et>=gt)return!0;const ut=et.getFullYear(),Ct=new Date(ut,2,1);return qt(ut)&&et>=Ct&&Xe<Ct};let Se=365;if(R===pe||R+1===pe&&(L>re||L===re&&p>=z))return(R===pe&&qt(R)||Ee(e,t)||re===1&&z===29)&&(Se=366),Pt(e,t)/Se;const _e=pe-R+1,Re=(new Date(pe+1,0,1)-new Date(R,0,1))/1e3/60/60/24/_e;return Pt(e,t)/Re}case 2:return Pt(e,t)/360;case 3:return Pt(e,t)/365;case 4:return(z+30*re+360*pe-(p+30*L+360*R))/360}}function nn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-pn)/864e5)+t}function on(e){return(e=Y(e))===0?u:e instanceof Error?e:String.fromCharCode(e)}function rn(e){if(ae(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=u),t}function an(){const e=q(arguments),t=ye.apply(void 0,e);if(t)return t;let a=0;for(;(a=e.indexOf(!0))>-1;)e[a]="TRUE";let p=0;for(;(p=e.indexOf(!1))>-1;)e[p]="FALSE";return e.join("")}Ht.INTL=(e,t,a,p)=>{if((e=Be(e))instanceof Error)return e;if((t=Be(t))instanceof Error)return t;let L=!1;const R=[],z=[1,2,3,4,5,6,0],re=new RegExp("^[0|1]{7}$");if(a===void 0)a=kt[1];else if(typeof a=="string"&&re.test(a)){L=!0,a=a.split("");for(let _e=0;_e<a.length;_e++)a[_e]==="1"&&R.push(z[_e])}else a=kt[a];if(!(a instanceof Array))return u;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let _e=0;_e<p.length;_e++){const Re=Be(p[_e]);if(Re instanceof Error)return Re;p[_e]=Re}const pe=Math.round((t-e)/864e5)+1;let Ee=pe;const Se=e;for(let _e=0;_e<pe;_e++){const Re=new Date().getTimezoneOffset()>0?Se.getUTCDay():Se.getDay();let Xe=L?R.includes(Re):Re===a[0]||Re===a[1];for(let et=0;et<p.length;et++){const nt=p[et];if(nt.getDate()===Se.getDate()&&nt.getMonth()===Se.getMonth()&&nt.getFullYear()===Se.getFullYear()){Xe=!0;break}}Xe&&Ee--,Se.setDate(Se.getDate()+1)}return Ee},Bt.INTL=(e,t,a,p)=>{if((e=Be(e))instanceof Error)return e;if((t=Y(t))instanceof Error)return t;if(t<0)return h;if(!((a=a===void 0?kt[1]:kt[a])instanceof Array))return u;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let R=0;R<p.length;R++){const z=Be(p[R]);if(z instanceof Error)return z;p[R]=z}let L=0;for(;L<t;){e.setDate(e.getDate()+1);const R=e.getDay();if(R!==a[0]&&R!==a[1]){for(let z=0;z<p.length;z++){const re=p[z];if(re.getDate()===e.getDate()&&re.getMonth()===e.getMonth()&&re.getFullYear()===e.getFullYear()){L--;break}}L++}}return e};const mn=an;function sn(e,t=2,a=!1){if(e=Y(e),isNaN(e)||(t=Y(t),isNaN(t)))return u;if(t<0){const p=Math.pow(10,-t);e=Math.round(e/p)*p}else e=e.toFixed(t);if(a)e=e.toString().replace(/,/g,"");else{const p=e.toString().split(".");p[0]=p[0].replace(/\B(?=(\d{3})+$)/g,","),e=p.join(".")}return e}function bt(e,t){return ye(e,t)||(e=Ue(e),(t=Y(t))instanceof Error?t:new Array(t+1).join(e))}const bn=on,jn=rn;function zt(e){return/^[01]{1,10}$/.test(e)}function pt(e,t,a){if(ae(e=Y(e),t=Y(t)))return e;if((a=a===void 0?"i":a)!=="i"&&a!=="j")return u;if(e===0&&t===0)return 0;if(e===0)return t===1?a:t.toString()+a;if(t===0)return e.toString();{const p=t>0?"+":"";return e.toString()+p+(t===1?a:t.toString()+a)}}function Wt(e,t){return t=t===void 0?0:t,ae(e=Y(e),t=Y(t))?u:b.erf(e)}function Xt(e){return isNaN(e)?u:b.erfc(e)}function Gt(e){const t=it(e),a=rt(e);return ae(t,a)?u:Math.sqrt(Math.pow(t,2)+Math.pow(a,2))}function rt(e){if(e===void 0||e===!0||e===!1)return u;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),a=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),a===0&&(a=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),L=p==="i"||p==="j";return t>=0||a>=0?L?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,a))||isNaN(e.substring(a+1,e.length-1))?h:-Number(e.substring(a+1,e.length-1)):h:L?isNaN(e.substring(0,e.length-1))?h:e.substring(0,e.length-1):isNaN(e)?h:0}function Kt(e){const t=it(e),a=rt(e);return ae(t,a)?u:t===0&&a===0?g:t===0&&a>0?Math.PI/2:t===0&&a<0?-Math.PI/2:a===0&&t>0?0:a===0&&t<0?-Math.PI:t>0?Math.atan(a/t):t<0&&a>=0?Math.atan(a/t)+Math.PI:Math.atan(a/t)-Math.PI}function _t(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(t)*(Math.exp(a)+Math.exp(-a))/2,-Math.sin(t)*(Math.exp(a)-Math.exp(-a))/2,p)}function ln(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(a)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(a)*(Math.exp(t)-Math.exp(-t))/2,p)}function Mt(e,t){const a=it(e),p=rt(e),L=it(t),R=rt(t);if(ae(a,p,L,R))return u;const z=e.substring(e.length-1),re=t.substring(t.length-1);let pe="i";if((z==="j"||re==="j")&&(pe="j"),L===0&&R===0)return h;const Ee=L*L+R*R;return pt((a*L+p*R)/Ee,(p*L-a*R)/Ee,pe)}function it(e){if(e===void 0||e===!0||e===!1)return u;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),a=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),a===0&&(a=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),L=p==="i"||p==="j";return t>=0||a>=0?L?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(0,t)):isNaN(e.substring(0,a))||isNaN(e.substring(a+1,e.length-1))?h:Number(e.substring(0,a)):h:L?isNaN(e.substring(0,e.length-1))?h:0:isNaN(e)?h:e}function Vt(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.sin(t)*(Math.exp(a)+Math.exp(-a))/2,Math.cos(t)*(Math.exp(a)-Math.exp(-a))/2,p)}function un(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(a)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(a)*(Math.exp(t)+Math.exp(-t))/2,p)}Wt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Xt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const vn=Q.DIST,yn=Q.INV,xn=ee.DIST,wn=ot.MATH,Cn=ot.PRECISE,En=S.DIST,An=S.DIST.RT,Ln=S.INV,Mn=S.INV.RT,Tn=S.TEST,Nn=ve.P,In=ve.P,Dn=ve.S,Sn=ee.INV,Fn=Xt.PRECISE,On=Wt.PRECISE,kn=de.DIST,Rn=fe.DIST,Hn=fe.DIST.RT,Bn=fe.INV,Pn=fe.INV.RT,_n=Et.MATH,Vn=Et.PRECISE,Yn=fe.TEST,qn=me.DIST,Un=me.INV,zn=Ne.PRECISE,Wn=We.DIST,Xn=Ae.INV,Gn=Ae.DIST,Kn=Ae.INV,$n=v.MULT,Jn=v.SNGL,Zn=_.DIST,Qn=Ht.INTL,eo=J.DIST,to=J.INV,no=J.S.DIST,oo=J.S.INV,ro=Z.EXC,io=Z.INC,ao=ue.EXC,so=ue.INC,lo=je.DIST,uo=De.EXC,co=De.INC,fo=Ce.AVG,po=Ce.EQ,ho=Fe.P,go=Ze.P,mo=Ze.S,bo=te.DIST,jo=te.DIST.RT,vo=te.INV,yo=te.TEST,xo=be.P,wo=be.S,Co=tt.DIST,Eo=Bt.INTL,Ao=$e.TEST;function $t(e){const t=[];return N(e,a=>{a&&t.push(a)}),t}function jt(e,t){const a={};for(let R=1;R<e[0].length;++R)a[R]=!0;let p=t[0].length;for(let R=1;R<t.length;++R)t[R].length>p&&(p=t[R].length);for(let R=1;R<e.length;++R)for(let z=1;z<e[R].length;++z){let re=!1,pe=!1;for(let Ee=0;Ee<t.length;++Ee){const Se=t[Ee];if(Se.length<p)continue;const _e=Se[0];if(e[R][0]===_e){pe=!0;for(let Re=1;Re<Se.length;++Re)if(!re)if(Se[Re]===void 0||Se[Re]==="*")re=!0;else{const Xe=vt(Se[Re]+""),et=[dt(e[R][z],at)].concat(Xe);re=ht(et)}}}pe&&(a[z]=a[z]&&re)}const L=[];for(let R=0;R<e[0].length;++R)a[R]&&L.push(R-1);return L}function Jt(e){return e&&e.getTime&&!isNaN(e.getTime())}function Zt(e){return e instanceof Date?e:new Date(e)}function Tt(e,t,a,p,L){if(p=p||0,L=L||0,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),L=Y(L)))return u;let R;if(e===0)R=p+a*t;else{const z=Math.pow(1+e,t);R=L===1?p*z+a*(1+e)*(z-1)/e:p*z+a*(z-1)/e}return-R}function cn(e,t,a,p,L,R){if(L=L||0,R=R||0,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),L=Y(L),R=Y(R)))return u;const z=Dt(e,a,p,L,R);return(t===1?R===1?0:-p:R===1?Tt(e,t-2,z,p,1)-z:Tt(e,t-1,z,p,0))*e}function Qt(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=e[0];let a=0;for(let p=1;p<e.length;p++)a+=e[p]/Math.pow(1+t,p);return a}function Dt(e,t,a,p,L){if(p=p||0,L=L||0,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),L=Y(L)))return u;let R;if(e===0)R=(a+p)/t;else{const z=Math.pow(1+e,t);R=L===1?(p*e/(z-1)+a*e/(1-1/z))/(1+e):p*e/(z-1)+a*e/(1-1/z)}return-R}const Lo={errors:B,symbols:fn};d.ABS=function(e){return(e=Y(e))instanceof Error?e:Math.abs(e)},d.ACCRINT=function(e,t,a,p,L,R,z){return e=Zt(e),t=Zt(t),a=Zt(a),Jt(e)&&Jt(t)&&Jt(a)?p<=0||L<=0||[1,2,4].indexOf(R)===-1||[0,1,2,3,4].indexOf(z)===-1||a<=e?h:(L=L||0)*p*Ut(e,a,z=z||0):u},d.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},d.ACOS=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=h),t},d.ACOSH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=h),t},d.ACOT=function(e){return(e=Y(e))instanceof Error?e:Math.atan(1/e)},d.ACOTH=function(e){if((e=Y(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=h),t},d.AGGREGATE=function(e,t,a,p){if(ae(e=Y(e),Y(e)))return u;switch(e){case 1:return o(a);case 2:return V(a);case 3:return K(a);case 4:return X(a);case 5:return ne(a);case 6:return Yt(a);case 7:return Ze.S(a);case 8:return Ze.P(a);case 9:return At(a);case 10:return be.S(a);case 11:return be.P(a);case 12:return W(a);case 13:return v.SNGL(a);case 14:return Je(a,p);case 15:return Ve(a,p);case 16:return Z.INC(a,p);case 17:return De.INC(a,p);case 18:return Z.EXC(a,p);case 19:return De.EXC(a,p)}},d.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},d.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},d.AND=function(){const e=q(arguments);let t=u;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===u&&(t=!0),e[a]||(t=!1))}return t},d.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return u;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,a=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]}),t},d.ASC=function(){throw new Error("ASC is not implemented")},d.ASIN=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=h),t},d.ASINH=function(e){return(e=Y(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},d.ATAN=function(e){return(e=Y(e))instanceof Error?e:Math.atan(e)},d.ATAN2=function(e,t){return ye(e=Y(e),t=Y(t))||Math.atan2(e,t)},d.ATANH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=h),t},d.AVEDEV=function(){const e=q(arguments).filter(Me);if(e.length===0)return h;const t=Le(e);return t instanceof Error?t:b.sum(b(t).subtract(b.mean(t)).abs()[0])/t.length},d.AVERAGE=o,d.AVERAGEA=k,d.AVERAGEIF=function(e,t,a){if(arguments.length<=1)return C;if(a=Le(q(a=a||e).filter(Me)),e=q(e),a instanceof Error)return a;let p=0,L=0;const R=t===void 0||t==="*",z=R?null:vt(t+"");for(let re=0;re<e.length;re++){const pe=e[re];if(R)L+=a[re],p++;else{const Ee=[dt(pe,at)].concat(z);ht(Ee)&&(L+=a[re],p++)}}return L/p},d.AVERAGEIFS=function(){const e=F(arguments),t=(e.length-1)/2,a=q(e[0]);let p=0,L=0;for(let z=0;z<a.length;z++){let re=!1;for(let pe=0;pe<t;pe++){const Ee=e[2*pe+1][z],Se=e[2*pe+2];let _e=!1;if(Se===void 0||Se==="*")_e=!0;else{const Re=vt(Se+""),Xe=[dt(Ee,at)].concat(Re);_e=ht(Xe)}if(!_e){re=!1;break}re=!0}re&&(L+=a[z],p++)}const R=L/p;return isNaN(R)?0:R},d.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},d.BASE=function(e,t,a){const p=ye(e=Y(e),t=Y(t),a=Y(a));if(p)return p;if(t===0)return h;const L=e.toString(t);return new Array(Math.max(a+1-L.length,0)).join("0")+L},d.BESSELI=function(e,t){return ae(e=Y(e),t=Y(t))?u:H.besseli(e,t)},d.BESSELJ=function(e,t){return ae(e=Y(e),t=Y(t))?u:H.besselj(e,t)},d.BESSELK=function(e,t){return ae(e=Y(e),t=Y(t))?u:H.besselk(e,t)},d.BESSELY=function(e,t){return ae(e=Y(e),t=Y(t))?u:H.bessely(e,t)},d.BETA=Q,d.BETADIST=vn,d.BETAINV=yn,d.BIN2DEC=function(e){if(!zt(e))return h;const t=parseInt(e,2),a=e.toString();return a.length===10&&a.substring(0,1)==="1"?parseInt(a.substring(1),2)-512:t},d.BIN2HEX=function(e,t){if(!zt(e))return h;const a=e.toString();if(a.length===10&&a.substring(0,1)==="1")return(0xfffffffe00+parseInt(a.substring(1),2)).toString(16);const p=parseInt(e,2).toString(16);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?bt("0",t-p.length)+p:h},d.BIN2OCT=function(e,t){if(!zt(e))return h;const a=e.toString();if(a.length===10&&a.substring(0,1)==="1")return(1073741312+parseInt(a.substring(1),2)).toString(8);const p=parseInt(e,2).toString(8);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?bt("0",t-p.length)+p:h},d.BINOM=ee,d.BINOMDIST=xn,d.BITAND=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e&t},d.BITLSHIFT=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e<<t:e>>-t},d.BITOR=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e|t},d.BITRSHIFT=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e>>t:e<<-t},d.BITXOR=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e^t},d.CEILING=ot,d.CEILINGMATH=wn,d.CEILINGPRECISE=Cn,d.CELL=function(){throw new Error("CELL is not implemented")},d.CHAR=on,d.CHIDIST=En,d.CHIDISTRT=An,d.CHIINV=Ln,d.CHIINVRT=Mn,d.CHISQ=S,d.CHITEST=Tn,d.CHOOSE=function(){if(arguments.length<2)return C;const e=arguments[0];return e<1||e>254||arguments.length<e+1?u:arguments[e]},d.CLEAN=function(e){return ae(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},d.CODE=rn,d.COLUMN=function(e,t){return arguments.length!==2?C:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?b.col(e,t):void 0:u},d.COLUMNS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:b.cols(e):u},d.COMBIN=st,d.COMBINA=function(e,t){return ye(e=Y(e),t=Y(t))||(e<t?h:e===0&&t===0?1:st(e+t-1,e-1))},d.COMPLEX=pt,d.CONCAT=mn,d.CONCATENATE=an,d.CONFIDENCE=M,d.CONVERT=function(e,t,a){if((e=Y(e))instanceof Error)return e;const p=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],L={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},R={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let z,re=null,pe=null,Ee=t,Se=a,_e=1,Re=1;for(let Xe=0;Xe<p.length;Xe++)z=p[Xe][2]===null?[]:p[Xe][2],(p[Xe][1]===Ee||z.indexOf(Ee)>=0)&&(re=p[Xe]),(p[Xe][1]===Se||z.indexOf(Se)>=0)&&(pe=p[Xe]);if(re===null){const Xe=L[t.substring(0,2)];let et=R[t.substring(0,1)];t.substring(0,2)==="da"&&(et=["dekao",10,"da"]),Xe?(_e=Xe[2],Ee=t.substring(2)):et&&(_e=et[1],Ee=t.substring(et[2].length));for(let nt=0;nt<p.length;nt++)z=p[nt][2]===null?[]:p[nt][2],(p[nt][1]===Ee||z.indexOf(Ee)>=0)&&(re=p[nt])}if(pe===null){const Xe=L[a.substring(0,2)];let et=R[a.substring(0,1)];a.substring(0,2)==="da"&&(et=["dekao",10,"da"]),Xe?(Re=Xe[2],Se=a.substring(2)):et&&(Re=et[1],Se=a.substring(et[2].length));for(let nt=0;nt<p.length;nt++)z=p[nt][2]===null?[]:p[nt][2],(p[nt][1]===Se||z.indexOf(Se)>=0)&&(pe=p[nt])}return re===null||pe===null||re[3]!==pe[3]?C:e*re[6]*_e/(pe[6]*Re)},d.CORREL=function(e,t){return ae(e=Le(q(e)),t=Le(q(t)))?u:b.corrcoeff(e,t)},d.COS=function(e){return(e=Y(e))instanceof Error?e:Math.cos(e)},d.COSH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},d.COT=function(e){return(e=Y(e))instanceof Error?e:e===0?g:1/Math.tan(e)},d.COTH=function(e){if((e=Y(e))instanceof Error)return e;if(e===0)return g;const t=Math.exp(2*e);return(t+1)/(t-1)},d.COUNT=V,d.COUNTA=K,d.COUNTBLANK=oe,d.COUNTIF=function(e,t){if(e=q(e),t===void 0||t==="*")return e.length;let a=0;const p=vt(t+"");for(let L=0;L<e.length;L++){const R=[dt(e[L],at)].concat(p);ht(R)&&a++}return a},d.COUNTIFS=function(){const e=F(arguments),t=new Array(q(e[0]).length);for(let p=0;p<t.length;p++)t[p]=!0;for(let p=0;p<e.length;p+=2){const L=q(e[p]),R=e[p+1];if(R!==void 0&&R!=="*"){const z=vt(R+"");for(let re=0;re<L.length;re++){const pe=[dt(L[re],at)].concat(z);t[re]=t[re]&&ht(pe)}}}let a=0;for(let p=0;p<t.length;p++)t[p]&&a++;return a},d.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},d.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},d.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},d.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},d.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},d.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},d.COVAR=Nn,d.COVARIANCE=ve,d.COVARIANCEP=In,d.COVARIANCES=Dn,d.CRITBINOM=Sn,d.CSC=function(e){return(e=Y(e))instanceof Error?e:e===0?g:1/Math.sin(e)},d.CSCH=function(e){return(e=Y(e))instanceof Error?e:e===0?g:2/(Math.exp(e)-Math.exp(-e))},d.CUMIPMT=function(e,t,a,p,L,R){if(ae(e=Y(e),t=Y(t),a=Y(a)))return u;if(e<=0||t<=0||a<=0||p<1||L<1||p>L||R!==0&&R!==1)return h;const z=Dt(e,t,a,0,R);let re=0;p===1&&(R===0&&(re=-a),p++);for(let pe=p;pe<=L;pe++)re+=R===1?Tt(e,pe-2,z,a,1)-z:Tt(e,pe-1,z,a,0);return re*=e,re},d.CUMPRINC=function(e,t,a,p,L,R){if(ae(e=Y(e),t=Y(t),a=Y(a)))return u;if(e<=0||t<=0||a<=0||p<1||L<1||p>L||R!==0&&R!==1)return h;const z=Dt(e,t,a,0,R);let re=0;p===1&&(re=R===0?z+a*e:z,p++);for(let pe=p;pe<=L;pe++)re+=R>0?z-(Tt(e,pe-2,z,a,1)-z)*e:z-Tt(e,pe-1,z,a,0)*e;return re},d.DATE=function(e,t,a){let p;return ae(e=Y(e),t=Y(t),a=Y(a))?p=u:(p=new Date(e,t-1,a),p.getFullYear()<0&&(p=h)),p},d.DATEDIF=It,d.DATEVALUE=function(e){if(typeof e!="string")return u;const t=Date.parse(e);return isNaN(t)?u:new Date(e)},d.DAVERAGE=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);let R=0;return N(p,z=>{R+=L[z]}),p.length===0?g:R/p.length},d.DAY=function(e){const t=Be(e);return t instanceof Error?t:t.getDate()},d.DAYS=Lt,d.DAYS360=wt,d.DB=function(e,t,a,p,L){if(L=L===void 0?12:L,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),L=Y(L)))return u;if(e<0||t<0||a<0||p<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(L)===-1||p>a)return h;if(t>=e)return 0;const R=(1-Math.pow(t/e,1/a)).toFixed(3),z=e*R*L/12;let re=z,pe=0;const Ee=p===a?a-1:p;for(let Se=2;Se<=Ee;Se++)pe=(e-re)*R,re+=pe;return p===1?z:p===a?(e-re)*R:pe},d.DBCS=function(){throw new Error("DBCS is not implemented")},d.DCOUNT=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);const R=[];return N(p,z=>{R.push(L[z])}),V(R)},d.DCOUNTA=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);const R=[];return N(p,z=>{R.push(L[z])}),K(R)},d.DDB=function(e,t,a,p,L){if(L=L===void 0?2:L,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),L=Y(L)))return u;if(e<0||t<0||a<0||p<0||L<=0||p>a)return h;if(t>=e)return 0;let R=0,z=0;for(let re=1;re<=p;re++)z=Math.min(L/a*(e-R),e-t-R),R+=z;return z},d.DEC2BIN=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return h;if(e<0)return"1"+bt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const a=parseInt(e,10).toString(2);return t===void 0?a:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=a.length?bt("0",t-a.length)+a:h},d.DEC2HEX=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return h;if(e<0)return(1099511627776+e).toString(16);const a=parseInt(e,10).toString(16);return t===void 0?a:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=a.length?bt("0",t-a.length)+a:h},d.DEC2OCT=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return h;if(e<0)return(1073741824+e).toString(8);const a=parseInt(e,10).toString(8);return t===void 0?a:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=a.length?bt("0",t-a.length)+a:h},d.DECIMAL=function(e,t){return arguments.length<1?u:ye(e=Y(e),t=Y(t))||(t===0?h:parseInt(e,t))},d.DEGREES=function(e){return(e=Y(e))instanceof Error?e:180*e/Math.PI},d.DELTA=function(e,t){return t=t===void 0?0:t,ae(e=Y(e),t=Y(t))?u:e===t?1:0},d.DEVSQ=function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=b.mean(e);let a=0;for(let p=0;p<e.length;p++)a+=Math.pow(e[p]-t,2);return a},d.DGET=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];return L=ie(typeof t=="string"?e[Te(e,t)]:e[t]),p.length===0?u:p.length>1?h:L[p[0]]},d.DISC=function(e,t,a,p,L){if(ae(e=Be(e),t=Be(t),a=Y(a),p=Y(p),L=(L=Y(L))||0))return u;if(a<=0||p<=0)return h;if(e>=t)return u;let R,z;switch(L){case 0:R=360,z=wt(e,t,!1);break;case 1:case 3:R=365,z=It(e,t,"D");break;case 2:R=360,z=It(e,t,"D");break;case 4:R=360,z=wt(e,t,!0);break;default:return h}return(p-a)/p*R/z},d.DMAX=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);let R=L[p[0]];return N(p,z=>{R<L[z]&&(R=L[z])}),R},d.DMIN=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);let R=L[p[0]];return N(p,z=>{R>L[z]&&(R=L[z])}),R},d.DOLLAR=function(e,t=2){if(e=Y(e),isNaN(e))return u;const a={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},p=(e=yt(e,t)).toLocaleString("en-US",a);return e<0?"$("+p.slice(2)+")":p},d.DOLLARDE=function(e,t){if(ae(e=Y(e),t=Y(t)))return u;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let a=parseInt(e,10);a+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const p=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return a=Math.round(a*p)/p,a},d.DOLLARFR=function(e,t){if(ae(e=Y(e),t=Y(t)))return u;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let a=parseInt(e,10);return a+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,a},d.DPRODUCT=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const re=Te(e,t);L=ie(e[re])}else L=ie(e[t]);let R=[];N(p,re=>{R.push(L[re])}),R=$t(R);let z=1;return N(R,re=>{z*=re}),z},d.DSTDEV=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);let R=[];return N(p,z=>{R.push(L[z])}),R=$t(R),Ze.S(R)},d.DSTDEVP=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);let R=[];return N(p,z=>{R.push(L[z])}),R=$t(R),Ze.P(R)},d.DSUM=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);const R=[];return N(p,z=>{R.push(L[z])}),At(R)},d.DURATION=function(){throw new Error("DURATION is not implemented")},d.DVAR=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);const R=[];return N(p,z=>{R.push(L[z])}),be.S(R)},d.DVARP=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const p=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);const R=[];return N(p,z=>{R.push(L[z])}),be.P(R)},d.EDATE=function(e,t){return(e=Be(e))instanceof Error?e:isNaN(t)?u:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},d.EFFECT=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<=0||t<1?h:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},d.EOMONTH=function(e,t){return(e=Be(e))instanceof Error?e:isNaN(t)?u:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},d.ERF=Wt,d.ERFC=Xt,d.ERFCPRECISE=Fn,d.ERFPRECISE=On,d.ERROR=St,d.EVEN=function(e){return(e=Y(e))instanceof Error?e:ot(e,-2,-1)},d.EXACT=function(e,t){return arguments.length!==2?C:ye(e,t)||(e=Ue(e))===Ue(t)},d.EXP=function(e){return arguments.length<1?C:arguments.length>1?T:(e=Y(e))instanceof Error?e:e=Math.exp(e)},d.EXPON=de,d.EXPONDIST=kn,d.F=fe,d.FACT=Ye,d.FACTDOUBLE=function e(t){if((t=Y(t))instanceof Error)return t;const a=Math.floor(t);return a<=0?1:a*e(a-2)},d.FALSE=function(){return!1},d.FDIST=Rn,d.FDISTRT=Hn,d.FIND=function(e,t,a){if(arguments.length<2)return C;e=Ue(e),a=a===void 0?0:a;const p=(t=Ue(t)).indexOf(e,a-1);return p===-1?u:p+1},d.FINV=Bn,d.FINVRT=Pn,d.FISHER=function(e){return(e=Y(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},d.FISHERINV=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},d.FIXED=sn,d.FLOOR=Et,d.FLOORMATH=_n,d.FLOORPRECISE=Vn,d.FORECAST=le,d.FREQUENCY=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return u;const a=e.length,p=t.length,L=[];for(let R=0;R<=p;R++){L[R]=0;for(let z=0;z<a;z++)R===0?e[z]<=t[0]&&(L[0]+=1):R<p?e[z]>t[R-1]&&e[z]<=t[R]&&(L[R]+=1):R===p&&e[z]>t[p-1]&&(L[p]+=1)}return L},d.FTEST=Yn,d.FV=Tt,d.FVSCHEDULE=function(e,t){if(ae(e=Y(e),t=Le(q(t))))return u;const a=t.length;let p=e;for(let L=0;L<a;L++)p*=1+t[L];return p},d.GAMMA=me,d.GAMMADIST=qn,d.GAMMAINV=Un,d.GAMMALN=Ne,d.GAMMALNPRECISE=zn,d.GAUSS=function(e){return(e=Y(e))instanceof Error?e:b.normal.cdf(e,0,1)-.5},d.GCD=function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=e.length,a=e[0];let p=a<0?-a:a;for(let L=1;L<t;L++){const R=e[L];let z=R<0?-R:R;for(;p&&z;)p>z?p%=z:z%=p;p+=z}return p},d.GEOMEAN=function(){const e=Le(q(arguments));return e instanceof Error?e:b.geomean(e)},d.GESTEP=function(e,t){return ae(t=t||0,e=Y(e))?e:e>=t?1:0},d.GROWTH=function(e,t,a,p){if((e=Le(e))instanceof Error)return e;let L;if(t===void 0)for(t=[],L=1;L<=e.length;L++)t.push(L);if(a===void 0)for(a=[],L=1;L<=e.length;L++)a.push(L);if(ae(t=Le(t),a=Le(a)))return u;p===void 0&&(p=!0);const R=e.length;let z,re,pe=0,Ee=0,Se=0,_e=0;for(L=0;L<R;L++){const Xe=t[L],et=Math.log(e[L]);pe+=Xe,Ee+=et,Se+=Xe*et,_e+=Xe*Xe}pe/=R,Ee/=R,Se/=R,_e/=R,p?(z=(Se-pe*Ee)/(_e-pe*pe),re=Ee-z*pe):(z=Se/_e,re=0);const Re=[];for(L=0;L<a.length;L++)Re.push(Math.exp(re+z*a[L]));return Re},d.HARMEAN=function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=e.length;let a=0;for(let p=0;p<t;p++)a+=1/e[p];return t/a},d.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const a=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),p=a?parseInt(e,16)-1099511627776:parseInt(e,16);if(p<-512||p>511)return h;if(a)return"1"+bt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const L=p.toString(2);return t===void 0?L:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=L.length?bt("0",t-L.length)+L:h},d.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},d.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const a=parseInt(e,16);if(a>536870911&&a<0xffe0000000)return h;if(a>=0xffe0000000)return(a-0xffc0000000).toString(8);const p=a.toString(8);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?bt("0",t-p.length)+p:h},d.HLOOKUP=function(e,t,a,p){return l(e,xe(t),a,p)},d.HOUR=function(e){return(e=Be(e))instanceof Error?e:e.getHours()},d.HYPGEOM=We,d.HYPGEOMDIST=Wn,d.IF=function(e,t,a){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(a=arguments.length===3&&a)==null&&(a=0),e?t:a)},d.IFERROR=function(e,t){return ft(e)?t:e},d.IFNA=function(e,t){return e===C?t:e},d.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return C},d.IMABS=Gt,d.IMAGINARY=rt,d.IMARGUMENT=Kt,d.IMCONJUGATE=function(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",a!==0?pt(t,-a,p):e},d.IMCOS=_t,d.IMCOSH=ln,d.IMCOT=function(e){return ae(it(e),rt(e))?u:Mt(_t(e),Vt(e))},d.IMCSC=function(e){return e===!0||e===!1?u:ae(it(e),rt(e))?h:Mt("1",Vt(e))},d.IMCSCH=function(e){return e===!0||e===!1?u:ae(it(e),rt(e))?h:Mt("1",un(e))},d.IMDIV=Mt,d.IMEXP=function(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let p=e.substring(e.length-1);p=p==="i"||p==="j"?p:"i";const L=Math.exp(t);return pt(L*Math.cos(a),L*Math.sin(a),p)},d.IMLN=function(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+a*a)),Math.atan(a/t),p)},d.IMLOG10=function(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+a*a))/Math.log(10),Math.atan(a/t)/Math.log(10),p)},d.IMLOG2=function(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+a*a))/Math.log(2),Math.atan(a/t)/Math.log(2),p)},d.IMPOWER=function(e,t){if(ae(t=Y(t),it(e),rt(e)))return u;let a=e.substring(e.length-1);a=a==="i"||a==="j"?a:"i";const p=Math.pow(Gt(e),t),L=Kt(e);return pt(p*Math.cos(t*L),p*Math.sin(t*L),a)},d.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return u;for(let t=1;t<arguments.length;t++){const a=it(e),p=rt(e),L=it(arguments[t]),R=rt(arguments[t]);if(ae(a,p,L,R))return u;e=pt(a*L-p*R,a*R+p*L)}return e},d.IMREAL=it,d.IMSEC=function(e){return e===!0||e===!1||ae(it(e),rt(e))?u:Mt("1",_t(e))},d.IMSECH=function(e){return ae(it(e),rt(e))?u:Mt("1",ln(e))},d.IMSIN=Vt,d.IMSINH=un,d.IMSQRT=function(e){if(ae(it(e),rt(e)))return u;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const a=Math.sqrt(Gt(e)),p=Kt(e);return pt(a*Math.cos(p/2),a*Math.sin(p/2),t)},d.IMSUB=function(e,t){const a=it(e),p=rt(e),L=it(t),R=rt(t);if(ae(a,p,L,R))return u;const z=e.substring(e.length-1),re=t.substring(t.length-1);let pe="i";return(z==="j"||re==="j")&&(pe="j"),pt(a-L,p-R,pe)},d.IMSUM=function(){if(!arguments.length)return u;const e=q(arguments);let t=e[0];for(let a=1;a<e.length;a++){const p=it(t),L=rt(t),R=it(e[a]),z=rt(e[a]);if(ae(p,L,R,z))return u;t=pt(p+R,L+z)}return t},d.IMTAN=function(e){return e===!0||e===!1||ae(it(e),rt(e))?u:Mt(Vt(e),_t(e))},d.INDEX=function(e,t,a){const p=ye(e,t,a);if(p)return p;if(!Array.isArray(e))return u;const L=e.length>0&&!Array.isArray(e[0]);return L&&!a?(a=t,t=1):(a=a||1,t=t||1),a<0||t<0?u:L&&t===1&&a<=e.length?e[a-1]:t<=e.length&&a<=e[t-1].length?e[t-1][a-1]:m},d.INFO=function(){throw new Error("INFO is not implemented")},d.INT=function(e){return(e=Y(e))instanceof Error?e:Math.floor(e)},d.INTERCEPT=function(e,t){return ae(e=Le(e),t=Le(t))?u:e.length!==t.length?C:le(0,e,t)},d.INTRATE=function(){throw new Error("INTRATE is not implemented")},d.IPMT=cn,d.IRR=function(e,t){if(t=t||0,ae(e=Le(q(e)),t=Y(t)))return u;const a=(Re,Xe,et)=>{const nt=et+1;let gt=Re[0];for(let ut=1;ut<Re.length;ut++)gt+=Re[ut]/Math.pow(nt,(Xe[ut]-Xe[0])/365);return gt},p=(Re,Xe,et)=>{const nt=et+1;let gt=0;for(let ut=1;ut<Re.length;ut++){const Ct=(Xe[ut]-Xe[0])/365;gt-=Ct*Re[ut]/Math.pow(nt,Ct+1)}return gt},L=[];let R=!1,z=!1;for(let Re=0;Re<e.length;Re++)L[Re]=Re===0?0:L[Re-1]+365,e[Re]>0&&(R=!0),e[Re]<0&&(z=!0);if(!R||!z)return h;let re,pe,Ee,Se=t=t===void 0?.1:t,_e=!0;do Ee=a(e,L,Se),re=Se-Ee/p(e,L,Se),pe=Math.abs(re-Se),Se=re,_e=pe>1e-10&&Math.abs(Ee)>1e-10;while(_e);return Se},d.ISBLANK=function(e){return e===null},d.ISERR=Ft,d.ISERROR=ft,d.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},d.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},d.ISLOGICAL=Ot,d.ISNA=function(e){return e===C},d.ISNONTEXT=function(e){return typeof e!="string"},d.ISNUMBER=Nt,d.ISO=dn,d.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},d.ISOWEEKNUM=tn,d.ISPMT=function(e,t,a,p){return ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p))?u:p*e*(t/a-1)},d.ISREF=function(){throw new Error("ISREF is not implemented")},d.ISTEXT=w,d.KURT=function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=b.mean(e),a=e.length;let p=0;for(let L=0;L<a;L++)p+=Math.pow(e[L]-t,4);return p/=Math.pow(b.stdev(e,!0),4),a*(a+1)/((a-1)*(a-2)*(a-3))*p-3*(a-1)*(a-1)/((a-2)*(a-3))},d.LARGE=Je,d.LCM=function(){const e=Le(q(arguments));if(e instanceof Error)return e;for(var t,a,p,L,R=1;(p=e.pop())!==void 0;){if(p===0)return 0;for(;p>1;){if(p%2){for(t=3,a=Math.floor(Math.sqrt(p));t<=a&&p%t;t+=2);L=t<=a?t:p}else L=2;for(p/=L,R*=L,t=e.length;t;e[--t]%L==0&&(e[t]/=L)==1&&e.splice(t,1));}}return R},d.LEFT=function(e,t){return ye(e,t)||(e=Ue(e),(t=Y(t=t===void 0?1:t))instanceof Error||typeof e!="string"?u:e.substring(0,t))},d.LEN=function(e){return arguments.length===0?T:e instanceof Error?e:Array.isArray(e)?u:Ue(e).length},d.LINEST=ce,d.LN=function(e){return(e=Y(e))instanceof Error?e:e===0?h:Math.log(e)},d.LOG=function(e,t){return ye(e=Y(e),t=Y(t))||(e===0||t===0?h:Math.log(e)/Math.log(t))},d.LOG10=function(e){return(e=Y(e))instanceof Error?e:e===0?h:Math.log(e)/Math.log(10)},d.LOGEST=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t)))||e.length!==t.length)return u;for(let p=0;p<e.length;p++)e[p]=Math.log(e[p]);const a=ce(e,t);return a[0]=Math.round(1e6*Math.exp(a[0]))/1e6,a[1]=Math.round(1e6*Math.exp(a[1]))/1e6,a},d.LOGINV=Xn,d.LOGNORM=Ae,d.LOGNORMDIST=Gn,d.LOGNORMINV=Kn,d.LOOKUP=function(e,t,a){t=q(t),a=a?q(a):t;const p=typeof e=="number";let L=C;for(let R=0;R<t.length;R++){if(t[R]===e)return a[R];if(p&&t[R]<=e||typeof t[R]=="string"&&t[R].localeCompare(e)<0)L=a[R];else if(p&&t[R]>e)return L}return L},d.LOWER=function(e){return arguments.length!==1?u:ae(e=Ue(e))?e:e.toLowerCase()},d.MATCH=function(e,t,a){if(!e||!t||(arguments.length===2&&(a=1),!((t=q(t))instanceof Array))||a!==-1&&a!==0&&a!==1)return C;let p,L;for(let R=0;R<t.length;R++)if(a===1){if(t[R]===e)return R+1;t[R]<e&&(L?t[R]>L&&(p=R+1,L=t[R]):(p=R+1,L=t[R]))}else if(a===0){if(typeof e=="string"&&typeof t[R]=="string"){const z=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+z+"$").test(t[R].toLowerCase()))return R+1}else if(t[R]===e)return R+1}else if(a===-1){if(t[R]===e)return R+1;t[R]>e&&(L?t[R]<L&&(p=R+1,L=t[R]):(p=R+1,L=t[R]))}return p||C},d.MAX=X,d.MAXA=function(){const e=q(arguments),t=ye.apply(void 0,e);if(t)return t;let a=O(e);return a=a.map(p=>p??0),a.length===0?0:Math.max.apply(Math,a)},d.MDURATION=function(){throw new Error("MDURATION is not implemented")},d.MEDIAN=W,d.MID=function(e,t,a){if(t==null)return u;if(ae(t=Y(t),a=Y(a))||typeof e!="string")return a;const p=t-1,L=p+a;return e.substring(p,L)},d.MIN=ne,d.MINA=function(){const e=q(arguments),t=ye.apply(void 0,e);if(t)return t;let a=O(e);return a=a.map(p=>p??0),a.length===0?0:Math.min.apply(Math,a)},d.MINUTE=function(e){return(e=Be(e))instanceof Error?e:e.getMinutes()},d.MIRR=function(e,t,a){if(ae(e=Le(q(e)),t=Y(t),a=Y(a)))return u;const p=e.length,L=[],R=[];for(let pe=0;pe<p;pe++)e[pe]<0?L.push(e[pe]):R.push(e[pe]);const z=-Qt(a,R)*Math.pow(1+a,p-1),re=Qt(t,L)*(1+t);return Math.pow(z/re,1/(p-1))-1},d.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(a=>!a.length)||t.some(a=>!a.length)||se(e).some(a=>typeof a!="number")||se(t).some(a=>typeof a!="number")||e[0].length!==t.length?u:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((a,p)=>a.map((L,R)=>e[p].reduce((z,re,pe)=>z+re*t[pe][R],0)))},d.MOD=function(e,t){const a=ye(e=Y(e),t=Y(t));if(a)return a;if(t===0)return g;let p=Math.abs(e%t);return p=e<0?t-p:p,t>0?p:-p},d.MODE=v,d.MODEMULT=$n,d.MODESNGL=Jn,d.MONTH=function(e){return(e=Be(e))instanceof Error?e:e.getMonth()+1},d.MROUND=function(e,t){return ye(e=Y(e),t=Y(t))||(e*t==0?0:e*t<0?h:Math.round(e/t)*t)},d.MULTINOMIAL=function(){const e=Le(q(arguments));if(e instanceof Error)return e;let t=0,a=1;for(let p=0;p<e.length;p++)t+=e[p],a*=Ye(e[p]);return Ye(t)/a},d.MUNIT=function(e){return arguments.length>1?C:!(e=parseInt(e))||e<=0?u:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,a)=>(t[a]=1,t))},d.N=function(e){return Nt(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:ft(e)?e:0},d.NA=function(){return C},d.NEGBINOM=_,d.NEGBINOMDIST=Zn,d.NETWORKDAYS=Ht,d.NETWORKDAYSINTL=Qn,d.NOMINAL=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<=0||t<1?h:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},d.NORM=J,d.NORMDIST=eo,d.NORMINV=to,d.NORMSDIST=no,d.NORMSINV=oo,d.NOT=function(e){return typeof e=="string"?u:e instanceof Error?e:!e},d.NOW=function(){return new Date},d.NPER=function(e,t,a,p,L){if(L=L===void 0?0:L,p=p===void 0?0:p,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),L=Y(L)))return u;if(e===0)return-(a+p)/t;{const R=t*(1+e*L)-p*e,z=a*e+t*(1+e*L);return Math.log(R/z)/Math.log(1+e)}},d.NPV=Qt,d.NUMBERVALUE=function(e,t,a){return typeof(e=Me(e)?e:"")=="number"?e:typeof e!="string"?C:(t=t===void 0?".":t,a=a===void 0?",":a,Number(e.replace(t,".").replace(a,"")))},d.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const a=!(e.length!==10||e.substring(0,1)!=="7"),p=a?parseInt(e,8)-1073741824:parseInt(e,8);if(p<-512||p>511)return h;if(a)return"1"+bt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const L=p.toString(2);return t===void 0?L:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=L.length?bt("0",t-L.length)+L:h},d.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return h;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},d.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const a=parseInt(e,8);if(a>=536870912)return"ff"+(a+3221225472).toString(16);const p=a.toString(16);return t===void 0?p:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=p.length?bt("0",t-p.length)+p:h},d.ODD=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},d.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},d.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},d.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},d.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},d.OR=function(){const e=q(arguments);let t=u;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===u&&(t=!1),e[a]&&(t=!0))}return t},d.PDURATION=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?u:e<=0?h:(Math.log(a)-Math.log(t))/Math.log(1+e)},d.PEARSON=he,d.PERCENTILE=Z,d.PERCENTILEEXC=ro,d.PERCENTILEINC=io,d.PERCENTRANK=ue,d.PERCENTRANKEXC=ao,d.PERCENTRANKINC=so,d.PERMUT=function(e,t){return ae(e=Y(e),t=Y(t))?u:Ye(e)/Ye(e-t)},d.PERMUTATIONA=function(e,t){return ae(e=Y(e),t=Y(t))?u:Math.pow(e,t)},d.PHI=function(e){return(e=Y(e))instanceof Error?u:Math.exp(-.5*e*e)/2.5066282746310002},d.PI=function(){return Math.PI},d.PMT=Dt,d.POISSON=je,d.POISSONDIST=lo,d.POWER=en,d.PPMT=function(e,t,a,p,L,R){return L=L||0,R=R||0,ae(e=Y(e),a=Y(a),p=Y(p),L=Y(L),R=Y(R))?u:Dt(e,a,p,L,R)-cn(e,t,a,p,L,R)},d.PRICE=function(){throw new Error("PRICE is not implemented")},d.PRICEDISC=function(e,t,a,p,L){if(ae(e=Be(e),t=Be(t),a=Y(a),p=Y(p),L=(L=Y(L))||0))return u;if(a<=0||p<=0)return h;if(e>=t)return u;let R,z;switch(L){case 0:R=360,z=wt(e,t,!1);break;case 1:case 3:R=365,z=It(e,t,"D");break;case 2:R=360,z=It(e,t,"D");break;case 4:R=360,z=wt(e,t,!0);break;default:return h}return p-a*p*z/R},d.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},d.PROB=function(e,t,a,p){if(a===void 0)return 0;if(p=p===void 0?a:p,ae(e=Le(q(e)),t=Le(q(t)),a=Y(a),p=Y(p)))return u;if(a===p)return e.indexOf(a)>=0?t[e.indexOf(a)]:0;const L=e.sort((re,pe)=>re-pe),R=L.length;let z=0;for(let re=0;re<R;re++)L[re]>=a&&L[re]<=p&&(z+=t[e.indexOf(L[re])]);return z},d.PRODUCT=Yt,d.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},d.PROPER=function(e){return ae(e)?e:isNaN(e)&&typeof e=="number"?u:(e=Ue(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},d.PV=function(e,t,a,p,L){return p=p||0,L=L||0,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),L=Y(L))?u:e===0?-a*t-p:((1-Math.pow(1+e,t))/e*a*(1+e*L)-p)/Math.pow(1+e,t)},d.QUARTILE=De,d.QUARTILEEXC=uo,d.QUARTILEINC=co,d.QUOTIENT=function(e,t){return ye(e=Y(e),t=Y(t))||parseInt(e/t,10)},d.RADIANS=function(e){return(e=Y(e))instanceof Error?e:e*Math.PI/180},d.RAND=function(){return Math.random()},d.RANDBETWEEN=function(e,t){return ye(e=Y(e),t=Y(t))||e+Math.ceil((t-e+1)*Math.random())-1},d.RANK=Ce,d.RANKAVG=fo,d.RANKEQ=po,d.RATE=function(e,t,a,p,L,R){if(R=R===void 0?.01:R,p=p===void 0?0:p,L=L===void 0?0:L,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),L=Y(L),R=Y(R)))return u;const z=1e-10;let re=R;L=L?1:0;for(let pe=0;pe<20;pe++){if(re<=-1)return h;let Ee,Se,_e;if(Math.abs(re)<z?Ee=a*(1+e*re)+t*(1+re*L)*e+p:(Se=Math.pow(1+re,e),Ee=a*Se+t*(1/re+L)*(Se-1)+p),Math.abs(Ee)<z)return re;if(Math.abs(re)<z)_e=a*e+t*L*e;else{Se=Math.pow(1+re,e);const Re=e*Math.pow(1+re,e-1);_e=a*Re+t*(1/re+L)*Re+t*(-1/(re*re))*(Se-1)}re-=Ee/_e}return re},d.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},d.REPLACE=function(e,t,a,p){return ae(t=Y(t),a=Y(a))||typeof e!="string"||typeof p!="string"?u:e.substr(0,t-1)+p+e.substr(t-1+a)},d.REPT=bt,d.RIGHT=function(e,t){return ye(e,t)||(e=Ue(e),(t=Y(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},d.ROMAN=function(e){if((e=Y(e))instanceof Error)return e;const t=String(e).split(""),a=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let p="",L=3;for(;L--;)p=(a[+t.pop()+10*L]||"")+p;return new Array(+t.join("")+1).join("M")+p},d.ROUND=yt,d.ROUNDDOWN=function(e,t){return ye(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},d.ROUNDUP=function(e,t){return ye(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},d.ROW=function(e,t){return arguments.length!==2?C:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?b.row(e,t):void 0:u},d.ROWS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:b.rows(e):u},d.RRI=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?u:e===0||t===0?h:Math.pow(a/t,1/e)-1},d.RSQ=function(e,t){return ae(e=Le(q(e)),t=Le(q(t)))?u:Math.pow(he(e,t),2)},d.SEARCH=function(e,t,a){let p;return typeof e!="string"||typeof t!="string"?u:(a=a===void 0?0:a,p=t.toLowerCase().indexOf(e.toLowerCase(),a-1)+1,p===0?u:p)},d.SEC=function(e){return(e=Y(e))instanceof Error?e:1/Math.cos(e)},d.SECH=function(e){return(e=Y(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},d.SECOND=function(e){return(e=Be(e))instanceof Error?e:e.getSeconds()},d.SERIESSUM=function(e,t,a,p){if(ae(e=Y(e),t=Y(t),a=Y(a),p=Le(p)))return u;let L=p[0]*Math.pow(e,t);for(let R=1;R<p.length;R++)L+=p[R]*Math.pow(e,t+R*a);return L},d.SHEET=function(){throw new Error("SHEET is not implemented")},d.SHEETS=function(){throw new Error("SHEETS is not implemented")},d.SIGN=function(e){return(e=Y(e))instanceof Error?e:e<0?-1:e===0?0:1},d.SIN=function(e){return(e=Y(e))instanceof Error?e:Math.sin(e)},d.SINH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},d.SKEW=Fe,d.SKEWP=ho,d.SLN=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?u:a===0?h:(e-t)/a},d.SLOPE=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return u;const a=b.mean(t),p=b.mean(e),L=t.length;let R=0,z=0;for(let re=0;re<L;re++)R+=(t[re]-a)*(e[re]-p),z+=Math.pow(t[re]-a,2);return R/z},d.SMALL=Ve,d.SORT=function(e,t=1,a=1,p=!1){if(!e||!Array.isArray(e))return C;if(e.length===0)return 0;if(!(t=Y(t))||t<1||(a=Y(a))!==1&&a!==-1)return u;if(typeof(p=qe(p))!="boolean")return j;const L=re=>re.sort((pe,Ee)=>(pe=Ue(pe[t-1]),Ee=Ue(Ee[t-1]),a===1?pe<Ee?-1*a:a:pe>Ee?a:-1*a)),R=G(e),z=p?xe(R):R;return t>=1&&t<=z[0].length?p?xe(L(z)):L(z):u},d.SQRT=function(e){return(e=Y(e))instanceof Error?e:e<0?h:Math.sqrt(e)},d.SQRTPI=function(e){return(e=Y(e))instanceof Error?e:Math.sqrt(e*Math.PI)},d.STANDARDIZE=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?u:(e-t)/a},d.STDEV=Ze,d.STDEVA=function(){const e=we.apply(this,arguments);return Math.sqrt(e)},d.STDEVP=go,d.STDEVPA=function(){const e=He.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},d.STDEVS=mo,d.STEYX=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return u;const a=b.mean(t),p=b.mean(e),L=t.length;let R=0,z=0,re=0;for(let pe=0;pe<L;pe++)R+=Math.pow(e[pe]-p,2),z+=(t[pe]-a)*(e[pe]-p),re+=Math.pow(t[pe]-a,2);return Math.sqrt((R-z*z/re)/(L-2))},d.SUBSTITUTE=function(e,t,a,p){if(arguments.length<3)return C;if(e&&t){if(p===void 0)return e.split(t).join(a);{if(p=Math.floor(Number(p)),Number.isNaN(p)||p<=0)return u;let L=0,R=0;for(;L>-1&&e.indexOf(t,L)>-1;)if(L=e.indexOf(t,L+1),R++,L>-1&&R===p)return e.substring(0,L)+a+e.substring(L+t.length);return e}}return e},d.SUBTOTAL=function(e,t){if((e=Y(e))instanceof Error)return e;switch(e){case 1:case 101:return o(t);case 2:case 102:return V(t);case 3:case 103:return K(t);case 4:case 104:return X(t);case 5:case 105:return ne(t);case 6:case 106:return Yt(t);case 7:case 107:return Ze.S(t);case 8:case 108:return Ze.P(t);case 9:case 109:return At(t);case 10:case 110:return be.S(t);case 11:case 111:return be.P(t)}},d.SUM=At,d.SUMIF=function(e,t,a){if(e=q(e),a=a?q(a):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let p=0;const L=t==="*",R=L?null:vt(t+"");for(let z=0;z<e.length;z++){const re=e[z],pe=a[z];if(L)p+=re;else{const Ee=[dt(re,at)].concat(R);p+=ht(Ee)?pe:0}}return p},d.SUMIFS=function(){const e=F(arguments),t=Le(q(e.shift()));if(t instanceof Error)return t;const a=e,p=a.length/2;for(let R=0;R<p;R++)a[2*R]=q(a[2*R]);let L=0;for(let R=0;R<t.length;R++){let z=!1;for(let re=0;re<p;re++){const pe=a[2*re][R],Ee=a[2*re+1];let Se=!1;if(Ee===void 0||Ee==="*")Se=!0;else{const _e=vt(Ee+""),Re=[dt(pe,at)].concat(_e);Se=ht(Re)}if(!Se){z=!1;break}z=!0}z&&(L+=t[R])}return L},d.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return u;const e=arguments.length+1;let t,a,p,L,R=0;for(let z=0;z<arguments[0].length;z++)if(arguments[0][z]instanceof Array)for(let re=0;re<arguments[0][z].length;re++){for(t=1,a=1;a<e;a++){const pe=arguments[a-1][z][re];if(pe instanceof Error)return pe;if(L=Y(pe),L instanceof Error)return L;t*=L}R+=t}else{for(t=1,a=1;a<e;a++){const re=arguments[a-1][z];if(re instanceof Error)return re;if(p=Y(re),p instanceof Error)return p;t*=p}R+=t}return R},d.SUMSQ=function(){const e=Le(q(arguments));if(e instanceof Error)return e;let t=0;const a=e.length;for(let p=0;p<a;p++)t+=Nt(e[p])?e[p]*e[p]:0;return t},d.SUMX2MY2=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return u;let a=0;for(let p=0;p<e.length;p++)a+=e[p]*e[p]-t[p]*t[p];return a},d.SUMX2PY2=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return u;let a=0;e=Le(q(e)),t=Le(q(t));for(let p=0;p<e.length;p++)a+=e[p]*e[p]+t[p]*t[p];return a},d.SUMXMY2=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return u;let a=0;e=q(e),t=q(t);for(let p=0;p<e.length;p++)a+=Math.pow(e[p]-t[p],2);return a},d.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],a=arguments.length-1,p=Math.floor(a/2);let L=!1;const R=a%2!=0,z=a%2==0?null:arguments[arguments.length-1];if(p){for(let re=0;re<p;re++)if(t===arguments[2*re+1]){e=arguments[2*re+2],L=!0;break}}L||(e=R?z:C)}else e=u;return e},d.SYD=function(e,t,a,p){return ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p))?u:a===0||p<1||p>a?h:(e-t)*(a-(p=parseInt(p,10))+1)*2/(a*(a+1))},d.T=function(e){return e instanceof Error||typeof e=="string"?e:""},d.TAN=function(e){return(e=Y(e))instanceof Error?e:Math.tan(e)},d.TANH=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},d.TBILLEQ=function(e,t,a){return ae(e=Be(e),t=Be(t),a=Y(a))?u:a<=0||e>t||t-e>31536e6?h:365*a/(360-a*wt(e,t,!1))},d.TBILLPRICE=function(e,t,a){return ae(e=Be(e),t=Be(t),a=Y(a))?u:a<=0||e>t||t-e>31536e6?h:100*(1-a*wt(e,t,!1)/360)},d.TBILLYIELD=function(e,t,a){return ae(e=Be(e),t=Be(t),a=Y(a))?u:a<=0||e>t||t-e>31536e6?h:360*(100-a)/(a*wt(e,t,!1))},d.TDIST=bo,d.TDISTRT=jo,d.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return C;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return u;const a=t.startsWith("$")?"$":"",p=t.endsWith("%");return p&&(e*=100),e=(e=sn(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+a+(e=e.replace("-","")):a+e,p&&(e+="%"),e},d.TEXTJOIN=function(e,t,...a){if(typeof t!="boolean"&&(t=qe(t)),arguments.length<3)return C;e=e??"";let p=q(a),L=t?p.filter(R=>R):p;if(Array.isArray(e)){e=q(e);let R=L.map(re=>[re]),z=0;for(let re=0;re<R.length-1;re++)R[re].push(e[z]),z++,z===e.length&&(z=0);return L=q(R),L.join("")}return L.join(e)},d.TIME=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?u:e<0||t<0||a<0?h:(3600*e+60*t+a)/86400},d.TIMEVALUE=function(e){return(e=Be(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},d.TINV=vo,d.TODAY=function(){return Rt(new Date)},d.TRANSPOSE=function(e){return e?xe(G(e)):C},d.TREND=function(e,t,a){if(ae(e=Le(q(e)),t=Le(q(t)),a=Le(q(a))))return u;const p=ce(e,t),L=p[0],R=p[1],z=[];return a.forEach(re=>{z.push(L*re+R)}),z},d.TRIM=function(e){return(e=Ue(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},d.TRIMMEAN=function(e,t){if(ae(e=Le(q(e)),t=Y(t)))return u;const a=Et(e.length*t,2)/2;return b.mean((L=(L=a)||1,(p=ie(e.sort((R,z)=>R-z),a))&&typeof p.slice=="function"?p.slice(0,p.length-L):p));var p,L},d.TRUE=function(){return!0},d.TRUNC=function(e,t){return ye(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},d.TTEST=yo,d.TYPE=function(e){return Nt(e)?1:w(e)?2:Ot(e)?4:ft(e)?16:Array.isArray(e)?64:void 0},d.UNICHAR=bn,d.UNICODE=jn,d.UNIQUE=A,d.UPPER=function(e){return(e=Ue(e))instanceof Error?e:e.toUpperCase()},d.VALUE=function(e){const t=ye(e);if(t)return t;if(typeof e=="number")return e;if(Me(e)||(e=""),typeof e!="string")return u;const a=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let p=Number(e);return isNaN(p)?u:(p=p||0,a&&(p*=.01),p)},d.VAR=be,d.VARA=we,d.VARP=xo,d.VARPA=He,d.VARS=wo,d.VDB=function(){throw new Error("VDB is not implemented")},d.VLOOKUP=l,d.WEEKDAY=function(e,t){if((e=Be(e))instanceof Error)return e;t===void 0&&(t=1);const a=e.getDay();return gn[t][a]},d.WEEKNUM=function(e,t){if((e=Be(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return tn(e);const a=hn[t];let p=new Date(e.getFullYear(),0,1);const L=p.getDay()<a?1:0;return p-=24*Math.abs(p.getDay()-a)*60*60*1e3,Math.floor((e-p)/864e5/7+1)+L},d.WEIBULL=tt,d.WEIBULLDIST=Co,d.WORKDAY=Bt,d.WORKDAYINTL=Eo,d.XIRR=function(e,t,a){if(ae(e=Le(q(e)),t=lt(q(t)),a=Y(a)))return u;const p=(Re,Xe,et)=>{const nt=et+1;let gt=Re[0];for(let ut=1;ut<Re.length;ut++)gt+=Re[ut]/Math.pow(nt,Lt(Xe[ut],Xe[0])/365);return gt},L=(Re,Xe,et)=>{const nt=et+1;let gt=0;for(let ut=1;ut<Re.length;ut++){const Ct=Lt(Xe[ut],Xe[0])/365;gt-=Ct*Re[ut]/Math.pow(nt,Ct+1)}return gt};let R=!1,z=!1;for(let Re=0;Re<e.length;Re++)e[Re]>0&&(R=!0),e[Re]<0&&(z=!0);if(!R||!z)return h;let re,pe,Ee,Se=a=a||.1,_e=!0;do Ee=p(e,t,Se),re=Se-Ee/L(e,t,Se),pe=Math.abs(re-Se),Se=re,_e=pe>1e-10&&Math.abs(Ee)>1e-10;while(_e);return Se},d.XNPV=function(e,t,a){if(ae(e=Y(e),t=Le(q(t)),a=lt(q(a))))return u;let p=0;for(let L=0;L<t.length;L++)p+=t[L]/Math.pow(1+e,Lt(a[L],a[0])/365);return p},d.XOR=function(){const e=q(arguments);let t=u;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===u&&(t=0),e[a]&&t++)}return t===u?t:!!(1&Math.floor(Math.abs(t)))},d.YEAR=function(e){return(e=Be(e))instanceof Error?e:e.getFullYear()},d.YEARFRAC=Ut,d.YIELD=function(){throw new Error("YIELD is not implemented")},d.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},d.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},d.Z=$e,d.ZTEST=Ao,d.utils=Lo}},f={};function E(U){var d=f[U];if(d!==void 0)return d.exports;var r=f[U]={exports:{}};return c[U].call(r.exports,r,r.exports,E),r.exports}E.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var D=E(960);s=D}(),s)},138:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(243);var factory;factory=function(){var Version=(info={title:"Jspreadsheet",version:"4.13.2",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(n){var s=(""+n)[0];return s=="="||s=="#"},getMask=function(n){if(n.format||n.mask||n.locale){var s={};return n.mask?s.mask=n.mask:n.format?s.mask=n.format:(s.locale=n.locale,s.options=n.options),n.decimal&&(s.options||(s.options={}),s.options={decimal:n.decimal}),s}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(n){n==null&&(n=!obj.options.fullscreen),obj.options.fullscreen!=n&&(obj.options.fullscreen=n,n==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(n){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var s=obj.options.onevent.apply(this,arguments);typeof obj.options[n]=="function"&&(s=obj.options[n].apply(this,Array.prototype.slice.call(arguments,1)))}if(n=="onafterchanges"&&obj.options.persistance){var c=obj.options.persistance==1?obj.options.url:obj.options.persistance,f=obj.prepareJson(arguments[2]);obj.save(c,f)}return s},obj.prepareTable=function(){var n=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var s=Object.keys(obj.options.data[0]);s.length>n&&(n=s.length)}obj.options.minDimensions[0]>n&&(n=obj.options.minDimensions[0]);for(var c=[],f=0;f<n;f++)obj.options.colHeaders[f]||(obj.options.colHeaders[f]=""),obj.options.colWidths[f]||(obj.options.colWidths[f]=obj.options.defaultColWidth),obj.options.colAlignments[f]||(obj.options.colAlignments[f]=obj.options.defaultColAlign),obj.options.columns[f]?obj.options.columns[f].type||(obj.options.columns[f].type="text"):obj.options.columns[f]={type:"text"},obj.options.columns[f].name||(obj.options.columns[f].name=s&&s[f]?s[f]:f),obj.options.columns[f].source||(obj.options.columns[f].source=[]),obj.options.columns[f].options||(obj.options.columns[f].options=[]),obj.options.columns[f].editor||(obj.options.columns[f].editor=null),obj.options.columns[f].allowEmpty||(obj.options.columns[f].allowEmpty=!1),obj.options.columns[f].title||(obj.options.columns[f].title=obj.options.colHeaders[f]?obj.options.colHeaders[f]:""),obj.options.columns[f].width||(obj.options.columns[f].width=obj.options.colWidths[f]?obj.options.colWidths[f]:obj.options.defaultColWidth),obj.options.columns[f].align||(obj.options.columns[f].align=obj.options.colAlignments[f]?obj.options.colAlignments[f]:"center"),obj.options.columns[f].type=="autocomplete"||obj.options.columns[f].type=="dropdown"?obj.options.columns[f].url&&c.push({url:obj.options.columns[f].url,index:f,method:"GET",dataType:"json",success:function(E){for(var D=0;D<E.length;D++)obj.options.columns[this.index].source.push(E[D])}}):obj.options.columns[f].type=="calendar"&&(obj.options.columns[f].options.format||(obj.options.columns[f].options.format="DD/MM/YYYY"));c.length?jSuites.ajax(c,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(h){obj.scrollControls(h)},obj.content.onwheel=function(h){obj.wheelControls(h)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var n=document.createElement("div"),s=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),n.appendChild(s),n.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var c=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var f=0;f<obj.options.paginationOptions.length;f++){var E=document.createElement("option");E.value=obj.options.paginationOptions[f],E.innerHTML=obj.options.paginationOptions[f],obj.paginationDropdown.appendChild(E)}obj.paginationDropdown.value=obj.options.pagination,c.appendChild(document.createTextNode(obj.options.text.show)),c.appendChild(obj.paginationDropdown),c.appendChild(document.createTextNode(obj.options.text.entries))}var D,U=document.createElement("div");if(U.classList.add("jexcel_filter"),U.appendChild(c),U.appendChild(n),obj.colgroupContainer=document.createElement("colgroup"),(D=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(D),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var d=0;d<obj.options.nestedHeaders.length;d++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[d]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(D=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(D),f=0;f<obj.options.columns.length;f++)obj.createCellHeader(f),obj.headerContainer.appendChild(obj.headers[f]),obj.colgroupContainer.appendChild(obj.colgroup[f]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var r=document.createElement("td");for(obj.filter.appendChild(r),f=0;f<obj.options.columns.length;f++)(r=document.createElement("td")).innerHTML="&nbsp;",r.setAttribute("data-x",f),r.className="jexcel_column_filter",obj.options.columns[f].type=="hidden"&&(r.style.display="none"),obj.filter.appendChild(r);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var b=document.createElement("a");b.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if(typeof sessionStorage<"u"&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var H=document.createElement("img");H.src="//bossanova.uk/jspreadsheet/logo.png",b.appendChild(H)}}catch{}var P=document.createElement("span");P.innerHTML="Jspreadsheet CE",b.appendChild(P),obj.ads.appendChild(b),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var g=document.createElement("div"),u=document.createElement("div");if(obj.pagination.appendChild(g),obj.pagination.appendChild(u),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(U),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var m=Object.keys(obj.options.classes);for(f=0;f<m.length;f++){var j=jexcel.getIdFromColumnName(m[f],!0);obj.records[j[1]][j[0]].classList.add(obj.options.classes[m[f]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(n){if(n&&(typeof n=="string"&&(n=JSON.parse(n)),obj.options.data=n),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){n=[];for(var s=0;s<obj.options.data.length;s++){for(var c=[],f=0;f<obj.options.columns.length;f++)c[f]=obj.options.data[s][obj.options.columns[f].name];n.push(c)}obj.options.data=n}s=0,f=0;var E=obj.options.columns.length,D=obj.options.data.length,U=obj.options.minDimensions[0],d=obj.options.minDimensions[1],r=U>E?U:E,b=d>D?d:D;for(s=0;s<b;s++)for(f=0;f<r;f++)obj.options.data[s]==null&&(obj.options.data[s]=[]),obj.options.data[s][f]==null&&(obj.options.data[s][f]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var H=0,P=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,H=obj.options.pagination*obj.pageNumber,P=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<P&&(P=obj.options.data.length)):(H=0,P=obj.options.data.length);for(s=0;s<obj.options.data.length;s++){var g=obj.createRow(s,obj.options.data[s]);s>=H&&s<P&&obj.tbody.appendChild(g)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var u=Object.keys(obj.options.mergeCells);for(f=0;f<u.length;f++){var m=obj.options.mergeCells[u[f]];obj.setMerge(u[f],m[0],m[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(n,s){for(var c=[],f=0,E=0,D=s==1||obj.options.copyCompatibility==0,U=obj.options.columns.length,d=obj.options.data.length,r=0;r<d;r++){f=0;for(var b=0;b<U;b++)n&&!obj.records[r][b].classList.contains("highlight")||(c[E]||(c[E]=[]),c[E][f]=D?obj.options.data[r][b]:obj.records[r][b].innerHTML,f++);f>0&&E++}return c},obj.getJsonRow=function(n){for(var s=obj.options.data[n],c=obj.options.columns.length,f={},E=0;E<c;E++)obj.options.columns[E].name||(obj.options.columns[E].name=E),f[obj.options.columns[E].name]=s[E];return f},obj.getJson=function(n){for(var s=[],c=obj.options.columns.length,f=obj.options.data.length,E=0;E<f;E++){for(var D=null,U=0;U<c;U++)n&&!obj.records[E][U].classList.contains("highlight")||(D==null&&(D={}),obj.options.columns[U].name||(obj.options.columns[U].name=U),D[obj.options.columns[U].name]=obj.options.data[E][U]);D!=null&&s.push(D)}return s},obj.prepareJson=function(n){for(var s=[],c=0;c<n.length;c++){var f=n[c].x,E=n[c].y,D=obj.options.columns[f].name?obj.options.columns[f].name:f;s[E]||(s[E]={row:E,data:{}}),s[E].data[D]=n[c].newValue}return s.filter(function(U){return U!=null})},obj.save=function(n,s){var c=obj.dispatch("onbeforesave",el,obj,s);if(c)s=c;else if(c===!1)return!1;jSuites.ajax({url:n,method:"POST",dataType:"json",data:{data:JSON.stringify(s)},success:function(f){obj.dispatch("onsave",el,obj,s)}})},obj.getRowData=function(n){return obj.options.data[n]},obj.setRowData=function(n,s){for(var c=0;c<obj.headers.length;c++){var f=jexcel.getColumnNameFromId([c,n]);s[c]!=null&&obj.setValue(f,s[c])}},obj.getColumnData=function(n){for(var s=[],c=0;c<obj.options.data.length;c++)s.push(obj.options.data[c][n]);return s},obj.setColumnData=function(n,s){for(var c=0;c<obj.rows.length;c++){var f=jexcel.getColumnNameFromId([n,c]);s[c]!=null&&obj.setValue(f,s[c])}},obj.createRow=function(n,s){obj.records[n]||(obj.records[n]=[]),s||(s=obj.options.data[n]),obj.rows[n]=document.createElement("tr"),obj.rows[n].setAttribute("data-y",n);var c=null;obj.options.defaultRowHeight&&(obj.rows[n].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[n]&&(obj.options.rows[n].height&&(obj.rows[n].style.height=obj.options.rows[n].height),obj.options.rows[n].title&&(c=obj.options.rows[n].title)),c||(c=parseInt(n+1));var f=document.createElement("td");f.innerHTML=c,f.setAttribute("data-y",n),f.className="jexcel_row",obj.rows[n].appendChild(f);for(var E=0;E<obj.options.columns.length;E++)obj.records[n][E]=obj.createCell(E,n,s[E]),obj.rows[n].appendChild(obj.records[n][E]);return obj.rows[n]},obj.parseValue=function(n,s,c,f){(""+c).substr(0,1)=="="&&obj.options.parseFormulas==1&&(c=obj.executeFormula(c,n,s));var E=obj.options.columns[n];if(E&&!isFormula(c)){var D=null;if(D=getMask(E)){c&&c==Number(c)&&(c=Number(c));var U=jSuites.mask.render(c,D,!0);if(f&&D.mask){var d=D.mask.split(";");d[1]&&(d[1].match(new RegExp("\\[Red\\]","gi"))&&(c<0?f.classList.add("red"):f.classList.remove("red")),d[1].match(new RegExp("\\(","gi"))&&c<0&&(U="("+U+")"))}U&&(c=U)}}return c};var validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])};obj.createCell=function(n,s,c){var f=document.createElement("td");if(f.setAttribute("data-x",n),f.setAttribute("data-y",s),(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1){var E=secureFormula(c);E!=c&&(c=E)}if(obj.options.columns[n].editor)obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=c:f.textContent=c,typeof obj.options.columns[n].editor.createCell=="function"&&(f=obj.options.columns[n].editor.createCell(f));else if(obj.options.columns[n].type=="hidden")f.style.display="none",f.textContent=c;else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){var D=document.createElement("input");D.type=obj.options.columns[n].type,D.name="c"+n,D.checked=c==1||c==1||c=="true",D.onclick=function(){obj.setValue(f,this.checked)},obj.options.columns[n].readOnly!=1&&obj.options.editable!=0||D.setAttribute("disabled","disabled"),f.appendChild(D),obj.options.data[s][n]=D.checked}else if(obj.options.columns[n].type=="calendar"){var U=null;if(!validDate(c)){var d=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);d&&(U=d)}f.textContent=jSuites.calendar.getDateString(U||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")f.classList.add("jexcel_dropdown"),f.textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="color")if(obj.options.columns[n].render=="square"){var r=document.createElement("div");r.className="color",r.style.backgroundColor=c,f.appendChild(r)}else f.style.color=c,f.textContent=c;else if(obj.options.columns[n].type=="image"){if(c&&c.substr(0,10)=="data:image"){var b=document.createElement("img");b.src=c,f.appendChild(b)}}else obj.options.columns[n].type=="html"||obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=stripScript(obj.parseValue(n,s,c,f)):f.textContent=obj.parseValue(n,s,c,f);obj.options.columns[n].readOnly==1&&(f.className="readonly");var H=obj.options.columns[n].align?obj.options.columns[n].align:"center";return f.style.textAlign=H,obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||f.innerHTML.length>200)&&(f.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(c||f.innerHTML?obj.records[s][n-1].style.overflow="hidden":n==obj.options.columns.length-1&&(f.style.overflow="hidden")),f},obj.createCellHeader=function(n){var s=obj.options.columns[n].width?obj.options.columns[n].width:obj.options.defaultColWidth,c=obj.options.columns[n].align?obj.options.columns[n].align:obj.options.defaultColAlign;obj.headers[n]=document.createElement("td"),obj.options.stripHTML?obj.headers[n].textContent=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n):obj.headers[n].innerHTML=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n),obj.headers[n].setAttribute("data-x",n),obj.headers[n].style.textAlign=c,obj.options.columns[n].title&&obj.headers[n].setAttribute("title",obj.headers[n].innerText),obj.options.columns[n].id&&obj.headers[n].setAttribute("id",obj.options.columns[n].id),obj.colgroup[n]=document.createElement("col"),obj.colgroup[n].setAttribute("width",s),obj.options.columns[n].type=="hidden"&&(obj.headers[n].style.display="none",obj.colgroup[n].style.display="none")},obj.updateNestedHeader=function(n,s,c){obj.options.nestedHeaders[s][n].title&&(obj.options.nestedHeaders[s][n].title=c,obj.options.nestedHeaders[s].element.children[n+1].textContent=c)},obj.createNestedHeader=function(n){var s=document.createElement("tr");s.classList.add("jexcel_nested");var c=document.createElement("td");s.appendChild(c),n.element=s;for(var f=0,E=0;E<n.length;E++){n[E].colspan||(n[E].colspan=1),n[E].align||(n[E].align="center"),n[E].title||(n[E].title=""),n[E].id||(n[E].id="");for(var D=n[E].colspan,U=[],d=0;d<D;d++)obj.options.columns[f]&&obj.options.columns[f].type=="hidden"&&D++,U.push(f),f++;(c=document.createElement("td")).setAttribute("data-column",U.join(",")),c.setAttribute("colspan",n[E].colspan),c.setAttribute("align",n[E].align),c.setAttribute("id",n[E].id),c.textContent=n[E].title,s.appendChild(c)}return s},obj.createToolbar=function(n){n?obj.options.toolbar=n:n=obj.options.toolbar;for(var s=0;s<n.length;s++)if(n[s].type=="i")(D=document.createElement("i")).classList.add("jexcel_toolbar_item"),D.classList.add("material-icons"),D.setAttribute("data-k",n[s].k),D.setAttribute("data-v",n[s].v),D.setAttribute("id",n[s].id),n[s].tooltip&&D.setAttribute("title",n[s].tooltip),n[s].onclick&&(n[s].onclick,1)?D.onclick=function(U){var d=U;return function(){n[d].onclick(el,obj,this)}}(s):D.onclick=function(){var U=this.getAttribute("data-k"),d=this.getAttribute("data-v");obj.setStyle(obj.highlighted,U,d)},D.textContent=n[s].content,obj.toolbar.appendChild(D);else if(n[s].type=="select"){var c=!1;(D=document.createElement("select")).classList.add("jexcel_toolbar_item"),D.setAttribute("data-k",n[s].k),n[s].tooltip&&D.setAttribute("title",n[s].tooltip),n[s].onchange&&(n[s].onchange,1)?(D.onchange=n[s].onchange,c=!0):D.onchange=function(){var U=this.getAttribute("data-k");obj.setStyle(obj.highlighted,U,this.value)};for(var f=0;f<n[s].v.length;f++){var E=document.createElement("option");E.value=n[s].v[f],E.textContent=n[s].v[f],n[s].selectedValue&&E.value===n[s].selectedValue&&(E.selected=!0),D.appendChild(E)}c&&D.dispatchEvent(new Event("change")),obj.toolbar.appendChild(D)}else if(n[s].type=="color"){var D;(D=document.createElement("i")).classList.add("jexcel_toolbar_item"),D.classList.add("material-icons"),D.setAttribute("data-k",n[s].k),D.setAttribute("data-v",""),n[s].tooltip&&D.setAttribute("title",n[s].tooltip),obj.toolbar.appendChild(D),D.textContent=n[s].content,jSuites.color(D,{onchange:function(U,d){var r=U.getAttribute("data-k");obj.setStyle(obj.highlighted,r,d)}})}},obj.setMerge=function(n,s,c,f){var E=!1;if(!n){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var D=parseInt(obj.highlighted[0].getAttribute("data-x")),U=parseInt(obj.highlighted[0].getAttribute("data-y")),d=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),r=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));n=jexcel.getColumnNameFromId([D,U]),s=d-D+1,c=r-U+1}var b=jexcel.getIdFromColumnName(n,!0);if(obj.options.mergeCells[n])obj.records[b[1]][b[0]].getAttribute("data-merged")&&(E=obj.options.text.cellAlreadyMerged);else if((!s||s<2)&&(!c||c<2))E=obj.options.text.invalidMergeProperties;else for(var H=b[1];H<b[1]+c;H++)for(var P=b[0];P<b[0]+s;P++)jexcel.getColumnNameFromId([P,H]),obj.records[H][P].getAttribute("data-merged")&&(E=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(E)alert(E);else{s>1?obj.records[b[1]][b[0]].setAttribute("colspan",s):s=1,c>1?obj.records[b[1]][b[0]].setAttribute("rowspan",c):c=1,obj.options.mergeCells[n]=[s,c,[]],obj.records[b[1]][b[0]].setAttribute("data-merged","true"),obj.records[b[1]][b[0]].style.overflow="hidden";for(var g=[],u=b[1];u<b[1]+c;u++)for(var m=b[0];m<b[0]+s;m++)b[0]==m&&b[1]==u||(g.push(obj.options.data[u][m]),obj.updateCell(m,u,"",!0),obj.options.mergeCells[n][2].push(obj.records[u][m]),obj.records[u][m].style.display="none",obj.records[u][m]=obj.records[b[1]][b[0]]);obj.updateSelection(obj.records[b[1]][b[0]]),f||(obj.setHistory({action:"setMerge",column:n,colspan:s,rowspan:c,data:g}),obj.dispatch("onmerge",el,n,s,c))}},obj.getMerge=function(n){var s={};if(n)s=obj.options.mergeCells[n]?[obj.options.mergeCells[n][0],obj.options.mergeCells[n][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var c=Object.keys(obj.options.mergeCells),f=0;f<c.length;f++)s[c[f]]=[obj.options.mergeCells[c[f]][0],obj.options.mergeCells[c[f]][1]]}return s},obj.removeMerge=function(n,s,c){if(obj.options.mergeCells[n]){var f=jexcel.getIdFromColumnName(n,!0);obj.records[f[1]][f[0]].removeAttribute("colspan"),obj.records[f[1]][f[0]].removeAttribute("rowspan"),obj.records[f[1]][f[0]].removeAttribute("data-merged");for(var E=obj.options.mergeCells[n],D=0,U=0;U<E[1];U++)for(var d=0;d<E[0];d++)(U>0||d>0)&&(obj.records[f[1]+U][f[0]+d]=E[2][D],obj.records[f[1]+U][f[0]+d].style.display="",s&&s[D]&&obj.updateCell(f[0]+d,f[1]+U,s[D]),D++);obj.updateSelection(obj.records[f[1]][f[0]],obj.records[f[1]+U-1][f[0]+d-1]),c||delete obj.options.mergeCells[n]}},obj.destroyMerged=function(n){if(obj.options.mergeCells){obj.options.mergeCells;for(var s=Object.keys(obj.options.mergeCells),c=0;c<s.length;c++)obj.removeMerge(s[c],null,n)}},obj.isColMerged=function(n,s){var c=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),E=0;E<f.length;E++){var D=jexcel.getIdFromColumnName(f[E],!0),U=obj.options.mergeCells[f[E]][0],d=D[0],r=D[0]+(U>1?U-1:0);s==null?d<=n&&r>=n&&c.push(f[E]):s?d<n&&r>=n&&c.push(f[E]):d<=n&&r>n&&c.push(f[E])}return c},obj.isRowMerged=function(n,s){var c=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),E=0;E<f.length;E++){var D=jexcel.getIdFromColumnName(f[E],!0),U=obj.options.mergeCells[f[E]][1],d=D[1],r=D[1]+(U>1?U-1:0);s==null?d<=n&&r>=n&&c.push(f[E]):s?d<n&&r>=n&&c.push(f[E]):d<=n&&r>n&&c.push(f[E])}return c},obj.openFilter=function(n){if(obj.options.filters){n=parseInt(n),obj.resetSelection();var s=[];if(obj.options.columns[n].type=="checkbox")s.push({id:"true",name:"True"}),s.push({id:"false",name:"False"});else{for(var c=[],f=!1,E=0;E<obj.options.data.length;E++){var D=obj.options.data[E][n],U=obj.records[E][n].innerHTML;D&&U?c[D]=U:f=!0}var d=Object.keys(c);for(s=[],E=0;E<d.length;E++)s.push({id:d[E],name:c[d[E]]});f&&s.push({value:"",id:"",name:"(Blanks)"})}var r=document.createElement("div");obj.filter.children[n+1].innerHTML="",obj.filter.children[n+1].appendChild(r),obj.filter.children[n+1].style.paddingLeft="0px",obj.filter.children[n+1].style.paddingRight="0px",obj.filter.children[n+1].style.overflow="initial";var b={data:s,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[n]!==void 0?obj.filters[n]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(H){obj.resetFilters(),obj.filters[n]=H.dropdown.getValue(!0),obj.filter.children[n+1].innerHTML=H.dropdown.getText(),obj.filter.children[n+1].style.paddingLeft="",obj.filter.children[n+1].style.paddingRight="",obj.filter.children[n+1].style.overflow="",obj.closeFilter(n),obj.refreshSelection()}};jSuites.dropdown(r,b)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var n=0;n<obj.filter.children.length;n++)obj.filter.children[n].innerHTML="&nbsp;",obj.filters[n]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(n){if(!n)for(var s=0;s<obj.filter.children.length;s++)obj.filters[s]&&(n=s);var c=function(D,U,d){for(var r=0;r<D.length;r++){var b=""+obj.options.data[d][U],H=""+obj.records[d][U].innerHTML;if(D[r]==b||D[r]==H)return!0}return!1},f=obj.filters[n];obj.results=[];for(var E=0;E<obj.options.data.length;E++)c(f,n,E)&&obj.results.push(E);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(n,s,c){var f=n.getAttribute("data-y"),E=n.getAttribute("data-x");obj.dispatch("oneditionstart",el,n,E,f),E>0&&(obj.records[f][E-1].style.overflow="hidden");var D=function(T){var I=n.getBoundingClientRect(),B=document.createElement(T);return B.style.width=I.width+"px",B.style.height=I.height-2+"px",B.style.minHeight=I.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(B),obj.dispatch("oncreateeditor",el,n,E,f,B),B};if(n.classList.contains("readonly")!=1){if(obj.edition=[obj.records[f][E],obj.records[f][E].innerHTML,E,f],obj.options.columns[E].editor)obj.options.columns[E].editor.openEditor(n,el,s,c);else if(obj.options.columns[E].type!="hidden")if(obj.options.columns[E].type=="checkbox"||obj.options.columns[E].type=="radio"){var U=!n.children[0].checked;obj.setValue(n,U),obj.edition=null}else if(obj.options.columns[E].type=="dropdown"||obj.options.columns[E].type=="autocomplete"){if(U=obj.options.data[f][E],obj.options.columns[E].multiple&&!Array.isArray(U)&&(U=U.split(";")),typeof obj.options.columns[E].filter=="function")var d=obj.options.columns[E].filter(el,n,E,f,obj.options.columns[E].source);else d=obj.options.columns[E].source;for(var r=[],b=0;b<d.length;b++)r.push(d[b]);var H=D("div"),P={data:r,multiple:!!obj.options.columns[E].multiple,autocomplete:!(!obj.options.columns[E].autocomplete&&obj.options.columns[E].type!="autocomplete"),opened:!0,value:U,width:"100%",height:H.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(n,!0)}};obj.options.columns[E].options&&obj.options.columns[E].options.type&&(P.type=obj.options.columns[E].options.type),jSuites.dropdown(H,P)}else if(obj.options.columns[E].type=="calendar"||obj.options.columns[E].type=="color")U=obj.options.data[f][E],(H=D("input")).value=U,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[E].options.position=!0),obj.options.columns[E].options.value=obj.options.data[f][E],obj.options.columns[E].options.opened=!0,obj.options.columns[E].options.onclose=function(T,I){obj.closeEditor(n,!0)},obj.options.columns[E].type=="color"?jSuites.color(H,obj.options.columns[E].options):jSuites.calendar(H,obj.options.columns[E].options),H.focus();else if(obj.options.columns[E].type=="html"){U=obj.options.data[f][E],(H=D("div")).style.position="relative",(m=document.createElement("div")).classList.add("jexcel_richtext"),H.appendChild(m),jSuites.editor(m,{focus:!0,value:U});var g=n.getBoundingClientRect(),u=m.getBoundingClientRect();window.innerHeight<g.bottom+u.height?m.style.top=g.top-(u.height+2)+"px":m.style.top=g.top+"px"}else if(obj.options.columns[E].type=="image"){var m,j=n.children[0];(H=D("div")).style.position="relative",(m=document.createElement("div")).classList.add("jclose"),j&&j.src&&m.appendChild(j),H.appendChild(m),jSuites.image(m,obj.options.imageOptions),g=n.getBoundingClientRect(),u=m.getBoundingClientRect(),window.innerHeight<g.bottom+u.height?m.style.top=g.top-(u.height+2)+"px":m.style.top=g.top+"px"}else{U=s==1?"":obj.options.data[f][E],obj.options.columns[E].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[E].wordWrap!=1?H=D("input"):H=D("textarea"),H.focus(),H.value=U,P=obj.options.columns[E];var h=null;if(!isFormula(U)&&(h=getMask(P))){if(!P.disabledMaskOnEdition)if(P.mask){var C=P.mask.split(";");H.setAttribute("data-mask",C[0])}else P.locale&&H.setAttribute("data-locale",P.locale);h.input=H,H.mask=h,jSuites.mask.render(U,h,!1)}H.onblur=function(){obj.closeEditor(n,!0)},H.scrollLeft=H.scrollWidth}}},obj.closeEditor=function(n,s){var c=parseInt(n.getAttribute("data-x")),f=parseInt(n.getAttribute("data-y"));if(s==1){if(obj.options.columns[c].editor)var E=obj.options.columns[c].editor.closeEditor(n,s);else if(!(obj.options.columns[c].type=="checkbox"||obj.options.columns[c].type=="radio"||obj.options.columns[c].type=="hidden"))if(obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete")E=n.children[0].dropdown.close(!0);else if(obj.options.columns[c].type=="calendar")E=n.children[0].calendar.close(!0);else if(obj.options.columns[c].type=="color")E=n.children[0].color.close(!0);else if(obj.options.columns[c].type=="html")E=n.children[0].children[0].editor.getData();else if(obj.options.columns[c].type=="image"){var D=n.children[0].children[0].children[0];E=D&&D.tagName=="IMG"?D.src:""}else if(obj.options.columns[c].type=="numeric")(""+(E=n.children[0].value)).substr(0,1)!="="&&E==""&&(E=obj.options.columns[c].allowEmpty?"":0),n.children[0].onblur=null;else{E=n.children[0].value,n.children[0].onblur=null;var U,d=obj.options.columns[c];if((U=getMask(d))&&E!==""&&!isFormula(E)&&typeof E!="number"){var r=jSuites.mask.extract(E,U,!0);r&&r.value!==""&&(E=r.value)}}obj.options.data[f][c]==E?n.innerHTML=obj.edition[1]:obj.setValue(n,E)}else obj.options.columns[c].editor?obj.options.columns[c].editor.closeEditor(n,s):obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete"?n.children[0].dropdown.close(!0):obj.options.columns[c].type=="calendar"?n.children[0].calendar.close(!0):obj.options.columns[c].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,n,c,f,E,s),n.classList.remove("editor"),obj.edition=null},obj.getCell=function(n){var s=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][s]},obj.getColumnOptions=function(n,s){var c=obj.options.columns[n];return c||(c={type:"text"}),c},obj.getCellFromCoords=function(n,s){return obj.records[s][n]},obj.getLabel=function(n){var s=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][s].innerHTML},obj.getLabelFromCoords=function(n,s){return obj.records[s][n].innerHTML},obj.getValue=function(n,s){if(typeof n=="object")var c=n.getAttribute("data-x"),f=n.getAttribute("data-y");else c=(n=jexcel.getIdFromColumnName(n,!0))[0],f=n[1];var E=null;return c!=null&&f!=null&&(obj.records[f]&&obj.records[f][c]&&(s||obj.options.copyCompatibility==1)?E=obj.records[f][c].innerHTML:obj.options.data[f]&&obj.options.data[f][c]!="undefined"&&(E=obj.options.data[f][c])),E},obj.getValueFromCoords=function(n,s,c){var f=null;return n!=null&&s!=null&&(obj.records[s]&&obj.records[s][n]&&c||obj.options.copyCompatibility==1?f=obj.records[s][n].innerHTML:obj.options.data[s]&&obj.options.data[s][n]!="undefined"&&(f=obj.options.data[s][n])),f},obj.setValue=function(n,s,c){var f=[];if(typeof n=="string"){var E=(r=jexcel.getIdFromColumnName(n,!0))[0],D=r[1];f.push(obj.updateCell(E,D,s,c)),obj.updateFormulaChain(E,D,f)}else if(E=null,D=null,n&&n.getAttribute&&(E=n.getAttribute("data-x"),D=n.getAttribute("data-y")),E!=null&&D!=null)f.push(obj.updateCell(E,D,s,c)),obj.updateFormulaChain(E,D,f);else{var U=Object.keys(n);if(U.length>0)for(var d=0;d<U.length;d++){var r;typeof n[d]=="string"?(E=(r=jexcel.getIdFromColumnName(n[d],!0))[0],D=r[1]):n[d].x!=null&&n[d].y!=null?(E=n[d].x,D=n[d].y,n[d].newValue!=null?s=n[d].newValue:n[d].value!=null&&(s=n[d].value)):(E=n[d].getAttribute("data-x"),D=n[d].getAttribute("data-y")),E!=null&&D!=null&&(f.push(obj.updateCell(E,D,s,c)),obj.updateFormulaChain(E,D,f))}}obj.setHistory({action:"setValue",records:f,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,f)},obj.setValueFromCoords=function(n,s,c,f){var E=[];E.push(obj.updateCell(n,s,c,f)),obj.updateFormulaChain(n,s,E),obj.setHistory({action:"setValue",records:E,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,E)},obj.setCheckRadioValue=function(){for(var n=[],s=Object.keys(obj.highlighted),c=0;c<s.length;c++){var f=obj.highlighted[c].getAttribute("data-x"),E=obj.highlighted[c].getAttribute("data-y");obj.options.columns[f].type!="checkbox"&&obj.options.columns[f].type!="radio"||n.push(obj.updateCell(f,E,!obj.options.data[E][f]))}n.length&&(obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.onafterchanges(el,n))};var stripScript=function(n){var s=new Option;s.innerHTML=n;var c=null;for(n=s.getElementsByTagName("script");c=n[0];)c.parentNode.removeChild(c);return s.innerHTML};obj.updateCell=function(n,s,c,f){if(obj.records[s][n].classList.contains("readonly")!=1||f){var E;(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1&&(E=secureFormula(c))!=c&&(c=E),(E=obj.dispatch("onbeforechange",el,obj.records[s][n],n,s,c))!=null&&(c=E),obj.options.columns[n].editor&&typeof obj.options.columns[n].editor.updateCell=="function"&&(c=obj.options.columns[n].editor.updateCell(obj.records[s][n],c,f)),H={x:n,y:s,col:n,row:s,newValue:c,oldValue:obj.options.data[s][n]};let P=obj.options.columns[n].editor;if(P)obj.options.data[s][n]=c,typeof P.setValue=="function"&&P.setValue(obj.records[s][n],c);else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){if(obj.options.columns[n].type=="radio")for(var D=0;D<obj.options.data.length;D++)obj.options.data[D][n]=!1;obj.records[s][n].children[0].checked=c==1||c==1||c=="true"||c=="TRUE",obj.options.data[s][n]=obj.records[s][n].children[0].checked}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")obj.options.data[s][n]=c,obj.records[s][n].textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="calendar"){var U=null;if(!validDate(c)){var d=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);d&&(U=d)}obj.options.data[s][n]=c,obj.records[s][n].textContent=jSuites.calendar.getDateString(U||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="color")if(obj.options.data[s][n]=c,obj.options.columns[n].render=="square"){var r=document.createElement("div");r.className="color",r.style.backgroundColor=c,obj.records[s][n].textContent="",obj.records[s][n].appendChild(r)}else obj.records[s][n].style.color=c,obj.records[s][n].textContent=c;else if(obj.options.columns[n].type=="image"){if(c=""+c,obj.options.data[s][n]=c,obj.records[s][n].innerHTML="",c&&c.substr(0,10)=="data:image"){var b=document.createElement("img");b.src=c,obj.records[s][n].appendChild(b)}}else obj.options.data[s][n]=c,obj.options.columns[n].type=="html"?obj.records[s][n].innerHTML=stripScript(obj.parseValue(n,s,c)):obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?obj.records[s][n].innerHTML=stripScript(obj.parseValue(n,s,c,obj.records[s][n])):obj.records[s][n].textContent=obj.parseValue(n,s,c,obj.records[s][n]),obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||obj.records[s][n].innerHTML.length>200)?obj.records[s][n].style.whiteSpace="pre-wrap":obj.records[s][n].style.whiteSpace="";n>0&&(obj.records[s][n-1].style.overflow=c?"hidden":""),obj.dispatch("onchange",el,obj.records[s]&&obj.records[s][n]?obj.records[s][n]:null,n,s,c,H.oldValue)}else var H={x:n,y:s,col:n,row:s};return H},obj.copyData=function(n,s){var c=obj.getData(!0,!0),f=obj.selectedContainer,E=parseInt(n.getAttribute("data-x")),D=parseInt(n.getAttribute("data-y")),U=parseInt(s.getAttribute("data-x")),d=parseInt(s.getAttribute("data-y")),r=[],b=!1;if(f[0]==E){if(D<f[1])var H=D-f[1];else H=1;var P=0}else P=E<f[0]?E-f[0]:1,H=0;for(var g=0,u=0,m=D;m<=d;m++)if(!obj.rows[m]||obj.rows[m].style.display!="none"){c[u]==null&&(u=0),g=0,f[0]!=E&&(P=E<f[0]?E-f[0]:1);for(var j=E;j<=U;j++){if(obj.records[m][j]&&!obj.records[m][j].classList.contains("readonly")&&obj.records[m][j].style.display!="none"&&b==0){if(!obj.selection.length&&obj.options.data[m][j]!=""){b=!0;continue}(c[u]==null||c[u][g]==null)&&(g=0);var h=c[u][g];if(h&&!c[1]&&obj.options.autoIncrement==1){if(obj.options.columns[j].type=="text"||obj.options.columns[j].type=="number")if((""+h).substr(0,1)=="="){var C=h.match(/([A-Z]+[0-9]+)/g);if(C){for(var T=[],I=0;I<C.length;I++){var B=jexcel.getIdFromColumnName(C[I],1);B[0]+=P,B[1]+=H,B[1]<0&&(B[1]=0);var F=jexcel.getColumnNameFromId([B[0],B[1]]);F!=C[I]&&(T[C[I]]=F)}T&&(h=obj.updateFormula(h,T))}}else h==Number(h)&&(h=Number(h)+H);else if(obj.options.columns[j].type=="calendar"){var N=new Date(h);N.setDate(N.getDate()+H),h=N.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(N.getMonth()+1))+"-"+jexcel.doubleDigitFormat(N.getDate())+" 00:00:00"}}r.push(obj.updateCell(j,m,h)),obj.updateFormulaChain(j,m,r)}g++,f[0]!=E&&P++}u++,H++}obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(n,s,c){if(n==1){if(obj.selectedCell&&(s>=obj.selectedCell[1]&&s<=obj.selectedCell[3]||c>=obj.selectedCell[1]&&c<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(s>=obj.selectedCell[0]&&s<=obj.selectedCell[2]||c>=obj.selectedCell[0]&&c<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(n){if(obj.highlighted.length){b=1;for(var s=0;s<obj.highlighted.length;s++){obj.highlighted[s].classList.remove("highlight"),obj.highlighted[s].classList.remove("highlight-left"),obj.highlighted[s].classList.remove("highlight-right"),obj.highlighted[s].classList.remove("highlight-top"),obj.highlighted[s].classList.remove("highlight-bottom"),obj.highlighted[s].classList.remove("highlight-selected");var c=parseInt(obj.highlighted[s].getAttribute("data-x")),f=parseInt(obj.highlighted[s].getAttribute("data-y"));if(obj.highlighted[s].getAttribute("data-merged"))var E=parseInt(obj.highlighted[s].getAttribute("colspan")),D=parseInt(obj.highlighted[s].getAttribute("rowspan")),U=E>0?c+(E-1):c,d=D>0?f+(D-1):f;else U=c,d=f;for(var r=c;r<=U;r++)obj.headers[r]&&obj.headers[r].classList.remove("selected");for(r=f;r<=d;r++)obj.rows[r]&&obj.rows[r].classList.remove("selected")}}else var b=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",n==1&&b==1&&obj.dispatch("onblur",el),b},obj.updateSelection=function(n,s,c){var f=n.getAttribute("data-x"),E=n.getAttribute("data-y");if(s)var D=s.getAttribute("data-x"),U=s.getAttribute("data-y");else D=f,U=E;obj.updateSelectionFromCoords(f,E,D,U,c)},obj.updateSelectionFromCoords=function(n,s,c,f,E){var D=obj.resetSelection();if(s==null&&(s=0,f=obj.rows.length-1),c==null&&(c=n),f==null&&(f=s),n>=obj.headers.length&&(n=obj.headers.length-1),s>=obj.rows.length&&(s=obj.rows.length-1),c>=obj.headers.length&&(c=obj.headers.length-1),f>=obj.rows.length&&(f=obj.rows.length-1),obj.selectedCell=[n,s,c,f],n!=null){if(obj.records[s][n]&&obj.records[s][n].classList.add("highlight-selected"),parseInt(n)<parseInt(c))var U=parseInt(n),d=parseInt(c);else U=parseInt(c),d=parseInt(n);if(parseInt(s)<parseInt(f))var r=parseInt(s),b=parseInt(f);else r=parseInt(f),b=parseInt(s);for(var H=U;H<=d;H++)for(var P=r;P<=b;P++)if(obj.records[P][H]&&obj.records[P][H].getAttribute("data-merged")){var g=parseInt(obj.records[P][H].getAttribute("data-x")),u=parseInt(obj.records[P][H].getAttribute("data-y")),m=parseInt(obj.records[P][H].getAttribute("colspan")),j=parseInt(obj.records[P][H].getAttribute("rowspan"));m>1&&(g<U&&(U=g),g+m>d&&(d=g+m-1)),j&&(u<r&&(r=u),u+j>b&&(b=u+j-1))}var h=null,C=null,T=null,I=null;for(P=r;P<=b;P++)obj.rows[P].style.display!="none"&&(T==null&&(T=P),I=P);for(H=U;H<=d;H++){for(P=r;P<=b;P++)obj.rows[P].style.display!="none"&&obj.records[P][H].style.display!="none"&&(obj.records[P][H].classList.add("highlight"),obj.highlighted.push(obj.records[P][H]));obj.options.columns[H].type!="hidden"&&(h==null&&(h=H),C=H)}for(h||(h=0),C||(C=0),H=h;H<=C;H++)obj.options.columns[H].type!="hidden"&&(obj.records[T]&&obj.records[T][H]&&obj.records[T][H].classList.add("highlight-top"),obj.records[I]&&obj.records[I][H]&&obj.records[I][H].classList.add("highlight-bottom"),obj.headers[H].classList.add("selected"));for(P=T;P<=I;P++)obj.rows[P]&&obj.rows[P].style.display!="none"&&(obj.records[P][h].classList.add("highlight-left"),obj.records[P][C].classList.add("highlight-right"),obj.rows[P].classList.add("selected"));obj.selectedContainer=[h,T,C,I]}D==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,h,T,C,I,E),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var n=0;n<obj.selection.length;n++)obj.selection[n].classList.remove("selection"),obj.selection[n].classList.remove("selection-left"),obj.selection[n].classList.remove("selection-right"),obj.selection[n].classList.remove("selection-top"),obj.selection[n].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(n,s){obj.removeCopySelection();var c=obj.selectedContainer[0],f=obj.selectedContainer[1],E=obj.selectedContainer[2],D=obj.selectedContainer[3];if(n!=null&&s!=null){if(n-E>0)var U=parseInt(E)+1,d=parseInt(n);else U=parseInt(n),d=parseInt(c)-1;if(s-D>0)var r=parseInt(D)+1,b=parseInt(s);else r=parseInt(s),b=parseInt(f)-1;d-U<=b-r?(U=parseInt(c),d=parseInt(E)):(r=parseInt(f),b=parseInt(D));for(var H=r;H<=b;H++)for(var P=U;P<=d;P++)obj.records[H][P]&&obj.rows[H].style.display!="none"&&obj.records[H][P].style.display!="none"&&(obj.records[H][P].classList.add("selection"),obj.records[r][P].classList.add("selection-top"),obj.records[b][P].classList.add("selection-bottom"),obj.records[H][U].classList.add("selection-left"),obj.records[H][d].classList.add("selection-right"),obj.selection.push(obj.records[H][P]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var n=obj.highlighted[obj.highlighted.length-1],s=n.getAttribute("data-x"),c=obj.content.getBoundingClientRect(),f=c.left,E=c.top,D=n.getBoundingClientRect(),U=D.left,d=D.top,r=D.width,b=D.height,H=U-f+obj.content.scrollLeft+r-4,P=d-E+obj.content.scrollTop+b-4;if(obj.corner.style.top=P+"px",obj.corner.style.left=H+"px",obj.options.freezeColumns){var g=obj.getFreezeWidth();s>obj.options.freezeColumns-1&&U-f+r<g?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(n){var s=obj.content.getBoundingClientRect(),c=s.left,f=s.top,E=s.width,D=s.height,U=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),d=U.left,r=U.top,b=U.width,H=U.height;if(n==0||n==1)var P=d-c+obj.content.scrollLeft,g=r-f+obj.content.scrollTop-2;else P=d-c+obj.content.scrollLeft+b,g=r-f+obj.content.scrollTop+H;g>obj.content.scrollTop+30&&g<obj.content.scrollTop+D||(g<obj.content.scrollTop+30?obj.content.scrollTop=g-H:obj.content.scrollTop=g-(D-2));var u=obj.getFreezeWidth();P>obj.content.scrollLeft+u&&P<obj.content.scrollLeft+E||(P<obj.content.scrollLeft+30?(obj.content.scrollLeft=P,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):P<obj.content.scrollLeft+u?obj.content.scrollLeft=P-u-1:obj.content.scrollLeft=P-(E-20))},obj.getWidth=function(n){if(n===void 0)for(var s=[],c=0;c<obj.headers.length;c++)s.push(obj.options.columns[c].width);else typeof n=="object"&&(n=n.getAttribute("data-x")),s=obj.colgroup[n].getAttribute("width");return s},obj.setWidth=function(n,s,c){if(s){if(Array.isArray(n)){c||(c=[]);for(var f=0;f<n.length;f++){c[f]||(c[f]=obj.colgroup[n[f]].getAttribute("width"));var E=Array.isArray(s)&&s[f]?s[f]:s;obj.colgroup[n[f]].setAttribute("width",E),obj.options.columns[n[f]].width=E}}else c||(c=obj.colgroup[n].getAttribute("width")),obj.colgroup[n].setAttribute("width",s),obj.options.columns[n].width=s;obj.setHistory({action:"setWidth",column:n,oldValue:c,newValue:s}),obj.dispatch("onresizecolumn",el,n,s,c),obj.updateCornerPosition()}},obj.setHeight=function(n,s,c){s>0&&(typeof n=="object"&&(n=n.getAttribute("data-y")),c||(c=obj.rows[n].getAttribute("height"))||(c=obj.rows[n].getBoundingClientRect().height),s=parseInt(s),obj.rows[n].style.height=s+"px",obj.options.rows[n]||(obj.options.rows[n]={}),obj.options.rows[n].height=s,obj.setHistory({action:"setHeight",row:n,oldValue:c,newValue:s}),obj.dispatch("onresizerow",el,n,s,c),obj.updateCornerPosition())},obj.getHeight=function(n){if(n===void 0)for(var s=[],c=0;c<obj.rows.length;c++){var f=obj.rows[c].style.height;f&&(s[c]=f)}else typeof n=="object"&&(n=$(n).getAttribute("data-y")),s=obj.rows[n].style.height;return s},obj.setFooter=function(n){if(n&&(obj.options.footers=n),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var s=0;s<obj.options.footers.length;s++){if(obj.tfoot.children[s])var c=obj.tfoot.children[s];else{c=document.createElement("tr");var f=document.createElement("td");c.appendChild(f),obj.tfoot.appendChild(c)}for(var E=0;E<obj.headers.length;E++){if(obj.options.footers[s][E]||(obj.options.footers[s][E]=""),obj.tfoot.children[s].children[E+1])f=obj.tfoot.children[s].children[E+1];else{f=document.createElement("td"),c.appendChild(f);var D=obj.options.columns[E].align?obj.options.columns[E].align:"center";f.style.textAlign=D}f.textContent=obj.parseValue(+obj.records.length+E,s,obj.options.footers[s][E]),f.style.display=obj.colgroup[E].style.display}}}},obj.getHeader=function(n){return obj.headers[n].textContent},obj.setHeader=function(n,s){if(obj.headers[n]){var c=obj.headers[n].textContent;s||(s=prompt(obj.options.text.columnName,c)),s&&(obj.headers[n].textContent=s,obj.headers[n].setAttribute("title",s),obj.options.columns[n].title=s),obj.setHistory({action:"setHeader",column:n,oldValue:c,newValue:s}),obj.dispatch("onchangeheader",el,n,c,s)}},obj.getHeaders=function(n){for(var s=[],c=0;c<obj.headers.length;c++)s.push(obj.getHeader(c));return n?s:s.join(obj.options.csvDelimiter)},obj.getMeta=function(n,s){return n?s?obj.options.meta[n]&&obj.options.meta[n][s]?obj.options.meta[n][s]:null:obj.options.meta[n]?obj.options.meta[n]:null:obj.options.meta},obj.setMeta=function(n,s,c){if(obj.options.meta||(obj.options.meta={}),s&&c)obj.options.meta[n]||(obj.options.meta[n]={}),obj.options.meta[n][s]=c;else for(var f=Object.keys(n),E=0;E<f.length;E++){obj.options.meta[f[E]]||(obj.options.meta[f[E]]={});for(var D=Object.keys(n[f[E]]),U=0;U<D.length;U++)obj.options.meta[f[E]][D[U]]=n[f[E]][D[U]]}obj.dispatch("onchangemeta",el,n,s,c)},obj.updateMeta=function(n){if(obj.options.meta){for(var s={},c=Object.keys(obj.options.meta),f=0;f<c.length;f++)n[c[f]]?s[n[c[f]]]=obj.options.meta[c[f]]:s[c[f]]=obj.options.meta[c[f]];obj.options.meta=s}},obj.getStyle=function(n,s){if(n)return n=jexcel.getIdFromColumnName(n,!0),s?obj.records[n[1]][n[0]].style[s]:obj.records[n[1]][n[0]].getAttribute("style");for(var c={},f=obj.options.data[0].length,E=obj.options.data.length,D=0;D<E;D++)for(var U=0;U<f;U++){var d=s?obj.records[D][U].style[s]:obj.records[D][U].getAttribute("style");d&&(c[jexcel.getColumnNameFromId([U,D])]=d)}return c},obj.resetStyle=function(n,s){for(var c=Object.keys(n),f=0;f<c.length;f++){var E=jexcel.getIdFromColumnName(c[f],!0);obj.records[E[1]]&&obj.records[E[1]][E[0]]&&obj.records[E[1]][E[0]].setAttribute("style","")}obj.setStyle(n,null,null,null,s)},obj.setStyle=function(n,s,c,f,E){var D={},U={},d=function(h,C,T){var I=jexcel.getIdFromColumnName(h,!0);if(obj.records[I[1]]&&obj.records[I[1]][I[0]]&&(obj.records[I[1]][I[0]].classList.contains("readonly")==0||f)){var B=obj.records[I[1]][I[0]].style[C];B!=T||f?obj.records[I[1]][I[0]].style[C]=T:(T="",obj.records[I[1]][I[0]].style[C]=""),U[h]||(U[h]=[]),D[h]||(D[h]=[]),U[h].push([C+":"+B]),D[h].push([C+":"+T])}};if(s&&c)if(typeof n=="string")d(n,s,c);else for(var r=[],b=0;b<n.length;b++){var H=n[b].getAttribute("data-x"),P=n[b].getAttribute("data-y"),g=jexcel.getColumnNameFromId([H,P]);r[g]||(d(g,s,c),r[g]=!0)}else{var u=Object.keys(n);for(b=0;b<u.length;b++){var m=n[u[b]];typeof m=="string"&&(m=m.split(";"));for(var j=0;j<m.length;j++)typeof m[j]=="string"&&(m[j]=m[j].split(":")),m[j][0].trim()&&d(u[b],m[j][0].trim(),m[j][1])}}for(u=Object.keys(U),b=0;b<u.length;b++)U[u[b]]=U[u[b]].join(";");for(u=Object.keys(D),b=0;b<u.length;b++)D[u[b]]=D[u[b]].join(";");E||obj.setHistory({action:"setStyle",oldValue:U,newValue:D}),obj.dispatch("onchangestyle",el,n,s,c)},obj.getComments=function(n,s){if(n)return typeof n=="string"&&(n=jexcel.getIdFromColumnName(n,!0)),s?[obj.records[n[1]][n[0]].getAttribute("title"),obj.records[n[1]][n[0]].getAttribute("author")]:obj.records[n[1]][n[0]].getAttribute("title")||"";for(var c={},f=0;f<obj.options.data.length;f++)for(var E=0;E<obj.options.columns.length;E++){var D=obj.records[f][E].getAttribute("title");D&&(c[n=jexcel.getColumnNameFromId([E,f])]=D)}return c},obj.setComments=function(n,s,c){if(typeof n=="string")var f=jexcel.getIdFromColumnName(n,!0);else f=n;var E=obj.records[f[1]][f[0]].getAttribute("title"),D=[E,c=obj.records[f[1]][f[0]].getAttribute("data-author")];obj.records[f[1]][f[0]].setAttribute("title",s||""),obj.records[f[1]][f[0]].setAttribute("data-author",c||""),s?obj.records[f[1]][f[0]].classList.add("jexcel_comments"):obj.records[f[1]][f[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:n,newValue:[s,c],oldValue:D}),obj.dispatch("oncomments",el,s,E,f,f[0],f[1])},obj.getConfig=function(){var n=obj.options;return n.style=obj.getStyle(),n.mergeCells=obj.getMerge(),n.comments=obj.getComments(),n},obj.orderBy=function(n,s){if(n>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}s=s==null?obj.headers[n].classList.contains("arrow-down")?1:0:s?1:0;var c=[];if(obj.options.columns[n].type=="number"||obj.options.columns[n].type=="numeric"||obj.options.columns[n].type=="percentage"||obj.options.columns[n].type=="autonumber"||obj.options.columns[n].type=="color")for(var f=0;f<obj.options.data.length;f++)c[f]=[f,Number(obj.options.data[f][n])];else if(obj.options.columns[n].type=="calendar"||obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio")for(f=0;f<obj.options.data.length;f++)c[f]=[f,obj.options.data[f][n]];else for(f=0;f<obj.options.data.length;f++)c[f]=[f,obj.records[f][n].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(D){return function(U,d){var r=U[1],b=d[1];return D?r===""&&b!==""?1:r!==""&&b===""||r>b?-1:r<b?1:0:r===""&&b!==""?1:r!==""&&b===""?-1:r>b?1:r<b?-1:0}}),c=c.sort(obj.options.sorting(s));var E=[];for(f=0;f<c.length;f++)E[f]=c[f][0];return obj.setHistory({action:"orderBy",rows:E,column:n,order:s}),obj.updateOrderArrow(n,s),obj.updateOrder(E),obj.dispatch("onsort",el,n,s),!0}},obj.updateOrderArrow=function(n,s){for(var c=0;c<obj.headers.length;c++)obj.headers[c].classList.remove("arrow-up"),obj.headers[c].classList.remove("arrow-down");s?obj.headers[n].classList.add("arrow-up"):obj.headers[n].classList.add("arrow-down")},obj.updateOrder=function(n){for(var s=[],c=0;c<n.length;c++)s[c]=obj.options.data[n[c]];for(obj.options.data=s,s=[],c=0;c<n.length;c++)s[c]=obj.records[n[c]];for(obj.records=s,s=[],c=0;c<n.length;c++)s[c]=obj.rows[n[c]];if(obj.rows=s,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(c=0;c<obj.rows.length;c++)obj.tbody.appendChild(obj.rows[c])},obj.moveRow=function(n,s,c){if(Object.keys(obj.options.mergeCells).length>0){if(n>s)var f=1;else f=0;if(obj.isRowMerged(n).length||obj.isRowMerged(s,f).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}c||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[s])>=0?n>s?obj.tbody.insertBefore(obj.rows[n],obj.rows[s]):obj.tbody.insertBefore(obj.rows[n],obj.rows[s].nextSibling):obj.tbody.removeChild(obj.rows[n])),obj.rows.splice(s,0,obj.rows.splice(n,1)[0]),obj.records.splice(s,0,obj.records.splice(n,1)[0]),obj.options.data.splice(s,0,obj.options.data.splice(n,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:n,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,n,s)},obj.insertRow=function(n,s,c){if(obj.options.allowInsertRow==1){var f=[];if(n>0)var E=n;else E=1,n&&(f=n);c=!!c;var D=obj.options.data.length-1;if((s==null||s>=parseInt(D)||s<0)&&(s=D),obj.dispatch("onbeforeinsertrow",el,s,E,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(s,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var U=c?s:s+1,d=obj.records.splice(U),r=obj.options.data.splice(U),b=obj.rows.splice(U),H=[],P=[],g=[],u=U;u<E+U;u++){obj.options.data[u]=[];for(var m=0;m<obj.options.columns.length;m++)obj.options.data[u][m]=f[m]?f[m]:"";var j=obj.createRow(u,obj.options.data[u]);b[0]?Array.prototype.indexOf.call(obj.tbody.children,b[0])>=0&&obj.tbody.insertBefore(j,b[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[s])>=0&&obj.tbody.appendChild(j),H.push(obj.records[u]),P.push(obj.options.data[u]),g.push(j)}Array.prototype.push.apply(obj.records,d),Array.prototype.push.apply(obj.options.data,r),Array.prototype.push.apply(obj.rows,b),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:s,numOfRows:E,insertBefore:c,rowRecords:H,rowData:P,rowNode:g}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,s,E,H,c)}},obj.deleteRow=function(n,s){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(n==null){var c=obj.getSelectedRows();c[0]?(n=parseInt(c[0].getAttribute("data-y")),s=c.length):(n=obj.options.data.length-1,s=1)}var f=obj.options.data.length-1;if((n==null||n>f||n<0)&&(n=f),s||(s=1),n+s>=obj.options.data.length&&(s=obj.options.data.length-n),obj.dispatch("onbeforedeleterow",el,n,s)===!1)return!1;if(parseInt(n)>-1){var E=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var D=n;D<n+s;D++)obj.isRowMerged(D,!1).length&&(E=!0);if(E){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&f+1===s&&(s--,console.error("Jspreadsheet: It is not possible to delete the last row")),D=n;D<n+s;D++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[D])>=0&&(obj.rows[D].className="",obj.rows[D].parentNode.removeChild(obj.rows[D]));var U=obj.records.splice(n,s),d=obj.options.data.splice(n,s),r=obj.rows.splice(n,s);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,n,n+s-1),obj.setHistory({action:"deleteRow",rowNumber:n,numOfRows:s,insertBefore:1,rowRecords:U,rowData:d,rowNode:r}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,n,s,U)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(n,s){if(Object.keys(obj.options.mergeCells).length>0){if(n>s)var c=1;else c=0;if(obj.isColMerged(n).length||obj.isColMerged(s,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((n=parseInt(n))>(s=parseInt(s))){obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s]),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s]);for(var f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][s])}else for(obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s].nextSibling),f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][s].nextSibling);for(obj.options.columns.splice(s,0,obj.options.columns.splice(n,1)[0]),obj.headers.splice(s,0,obj.headers.splice(n,1)[0]),obj.colgroup.splice(s,0,obj.colgroup.splice(n,1)[0]),f=0;f<obj.rows.length;f++)obj.options.data[f].splice(s,0,obj.options.data[f].splice(n,1)[0]),obj.records[f].splice(s,0,obj.records[f].splice(n,1)[0]);if(obj.options.footers)for(f=0;f<obj.options.footers.length;f++)obj.options.footers[f].splice(s,0,obj.options.footers[f].splice(n,1)[0]);obj.setHistory({action:"moveColumn",oldValue:n,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,n,s)},obj.insertColumn=function(n,s,c,f){if(obj.options.allowInsertColumn==1){var E=[];if(n>0)var D=n;else D=1,n&&(E=n);c=!!c;var U=obj.options.columns.length-1;if((s==null||s>=parseInt(U)||s<0)&&(s=U),obj.dispatch("onbeforeinsertcolumn",el,s,D,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(s,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}f||(f=[]);for(var d=0;d<D;d++)f[d]||(f[d]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var r=c?s:s+1;obj.options.columns=jexcel.injectArray(obj.options.columns,r,f);for(var b=obj.headers.splice(r),H=obj.colgroup.splice(r),P=[],g=[],u=[],m=[],j=[],h=r;h<D+r;h++)obj.createCellHeader(h),obj.headerContainer.insertBefore(obj.headers[h],obj.headerContainer.children[h+1]),obj.colgroupContainer.insertBefore(obj.colgroup[h],obj.colgroupContainer.children[h+1]),P.push(obj.headers[h]),g.push(obj.colgroup[h]);if(obj.options.footers)for(var C=0;C<obj.options.footers.length;C++){for(j[C]=[],d=0;d<D;d++)j[C].push("");obj.options.footers[C].splice(r,0,j[C])}for(var T=0;T<obj.options.data.length;T++){var I=obj.options.data[T].splice(r),B=obj.records[T].splice(r);for(m[T]=[],u[T]=[],h=r;h<D+r;h++){var F=E[T]?E[T]:"";obj.options.data[T][h]=F;var N=obj.createCell(h,T,obj.options.data[T][h]);obj.records[T][h]=N,obj.rows[T]&&obj.rows[T].insertBefore(N,obj.rows[T].children[h+1]),m[T].push(F),u[T].push(N)}Array.prototype.push.apply(obj.options.data[T],I),Array.prototype.push.apply(obj.records[T],B)}if(Array.prototype.push.apply(obj.headers,b),Array.prototype.push.apply(obj.colgroup,H),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(C=0;C<obj.options.nestedHeaders.length;C++){var O=parseInt(obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan)+D;obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan=O,obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("colspan",O);var G=obj.thead.children[C].children[obj.thead.children[C].children.length-1].getAttribute("data-column");for(G=G.split(","),h=r;h<D+r;h++)G.push(h);obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("data-column",G)}else O=parseInt(obj.options.nestedHeaders[0].colspan)+D,obj.options.nestedHeaders[0].colspan=O,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",O);obj.setHistory({action:"insertColumn",columnNumber:s,numOfColumns:D,insertBefore:c,columns:f,headers:P,colgroup:g,records:u,footers:j,data:m}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,s,D,u,c)}},obj.deleteColumn=function(n,s){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(n==null){var c=obj.getSelectedColumns(!0);c.length?(n=parseInt(c[0]),s=parseInt(c.length)):(n=obj.headers.length-1,s=1)}var f=obj.options.data[0].length-1;if((n==null||n>f||n<0)&&(n=f),s||(s=1),s>obj.options.data[0].length-n&&(s=obj.options.data[0].length-n),obj.dispatch("onbeforedeletecolumn",el,n,s)===!1)return!1;if(parseInt(n)>-1){var E=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var D=n;D<n+s;D++)obj.isColMerged(D,!1).length&&(E=!0);if(E){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var U=obj.options.columns.splice(n,s);for(D=n;D<n+s;D++)obj.colgroup[D].className="",obj.headers[D].className="",obj.colgroup[D].parentNode.removeChild(obj.colgroup[D]),obj.headers[D].parentNode.removeChild(obj.headers[D]);for(var d=obj.headers.splice(n,s),r=obj.colgroup.splice(n,s),b=[],H=[],P=[],g=0;g<obj.options.data.length;g++)for(D=n;D<n+s;D++)obj.records[g][D].className="",obj.records[g][D].parentNode.removeChild(obj.records[g][D]);for(g=0;g<obj.options.data.length;g++)H[g]=obj.options.data[g].splice(n,s),b[g]=obj.records[g].splice(n,s);if(obj.options.footers)for(g=0;g<obj.options.footers.length;g++)P[g]=obj.options.footers[g].splice(n,s);if(obj.conditionalSelectionUpdate(0,n,n+s-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var u=0;u<obj.options.nestedHeaders.length;u++){var m=parseInt(obj.options.nestedHeaders[u][obj.options.nestedHeaders[u].length-1].colspan)-s;obj.options.nestedHeaders[u][obj.options.nestedHeaders[u].length-1].colspan=m,obj.thead.children[u].children[obj.thead.children[u].children.length-1].setAttribute("colspan",m)}else m=parseInt(obj.options.nestedHeaders[0].colspan)-s,obj.options.nestedHeaders[0].colspan=m,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",m);obj.setHistory({action:"deleteColumn",columnNumber:n,numOfColumns:s,insertBefore:1,columns:U,headers:d,colgroup:r,records:b,footers:P,data:H}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,n,s,b)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(n){for(var s=[],c=0;c<obj.rows.length;c++)obj.rows[c].classList.contains("selected")&&(n?s.push(c):s.push(obj.rows[c]));return s},obj.getSelectedColumns=function(){for(var n=[],s=0;s<obj.headers.length;s++)obj.headers[s].classList.contains("selected")&&n.push(s);return n},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var n=0;n<obj.headers.length;n++)(D=obj.headers[n].getAttribute("data-x"))!=n&&(obj.headers[n].setAttribute("data-x",n),obj.headers[n].getAttribute("title")||(obj.headers[n].innerHTML=jexcel.getColumnName(n)));for(var s=0;s<obj.rows.length;s++)obj.rows[s]&&(U=obj.rows[s].getAttribute("data-y"))!=s&&(obj.rows[s].setAttribute("data-y",s),obj.rows[s].children[0].setAttribute("data-y",s),obj.rows[s].children[0].innerHTML=s+1);var c=[],f=[],E=function(u,m,j,h){if(u!=j&&obj.records[h][j].setAttribute("data-x",j),m!=h&&obj.records[h][j].setAttribute("data-y",h),u!=j||m!=h){var C=jexcel.getColumnNameFromId([u,m]),T=jexcel.getColumnNameFromId([j,h]);c[C]=T}};for(s=0;s<obj.records.length;s++)for(n=0;n<obj.records[0].length;n++)if(obj.records[s][n]){var D=obj.records[s][n].getAttribute("data-x"),U=obj.records[s][n].getAttribute("data-y");if(obj.records[s][n].getAttribute("data-merged")){var d=jexcel.getColumnNameFromId([D,U]),r=jexcel.getColumnNameFromId([n,s]);if(f[d]==null)if(d==r)f[d]=!1;else{var b=parseInt(n-D),H=parseInt(s-U);f[d]=[r,b,H]}}else E(D,U,n,s)}var P=Object.keys(f);if(P.length){for(n=0;n<P.length;n++)if(f[P[n]]){var g=jexcel.getIdFromColumnName(P[n],!0);for(E(D=g[0],U=g[1],D+f[P[n]][1],U+f[P[n]][2]),d=P[n],r=f[P[n]][0],s=0;s<obj.options.mergeCells[d][2].length;s++)D=parseInt(obj.options.mergeCells[d][2][s].getAttribute("data-x")),U=parseInt(obj.options.mergeCells[d][2][s].getAttribute("data-y")),obj.options.mergeCells[d][2][s].setAttribute("data-x",D+f[P[n]][1]),obj.options.mergeCells[d][2][s].setAttribute("data-y",U+f[P[n]][2]);obj.options.mergeCells[r]=obj.options.mergeCells[d],delete obj.options.mergeCells[d]}}obj.updateFormulas(c),obj.updateMeta(c),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var n=0,s=obj.rows.length-1;s>=0;s--){for(var c=!1,f=0;f<obj.headers.length;f++)obj.options.data[s][f]&&(c=!0);if(c)break;n++}obj.options.minSpareRows-n>0&&obj.insertRow(obj.options.minSpareRows-n)}if(obj.options.minSpareCols>0){var E=0;for(f=obj.headers.length-1;f>=0;f--){for(c=!1,s=0;s<obj.rows.length;s++)obj.options.data[s][f]&&(c=!0);if(c)break;E++}obj.options.minSpareCols-E>0&&obj.insertColumn(obj.options.minSpareCols-E)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),s=0;s<obj.rows.length;s++)for(f=0;f<obj.headers.length;f++)obj.options.updateTable(el,obj.records[s][f],f,s,obj.options.data[s][f],obj.records[s][f].textContent,jexcel.getColumnNameFromId([f,s]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(n){if(n=obj.getCell(n))return!!n.classList.contains("readonly")},obj.setReadOnly=function(n,s){(n=obj.getCell(n))&&(s?n.classList.add("readonly"):n.classList.remove("readonly"))},obj.showRow=function(n){obj.rows[n].style.display=""},obj.hideRow=function(n){obj.rows[n].style.display="none"},obj.showColumn=function(n){obj.headers[n].style.display="",obj.colgroup[n].style.display="",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="");for(var s=0;s<obj.options.data.length;s++)obj.records[s][n].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(n){obj.headers[n].style.display="none",obj.colgroup[n].style.display="none",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="none");for(var s=0;s<obj.options.data.length;s++)obj.records[s][n].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(n,s,c){var f=jexcel.getColumnNameFromId([n,s]);if(obj.formula[f]&&obj.formula[f].length>0)if(chainLoopProtection[f])obj.records[s][n].innerHTML="#ERROR",obj.formula[f]="";else{chainLoopProtection[f]=!0;for(var E=0;E<obj.formula[f].length;E++){var D=jexcel.getIdFromColumnName(obj.formula[f][E],!0),U=""+obj.options.data[D[1]][D[0]];U.substr(0,1)=="="?c.push(obj.updateCell(D[0],D[1],U,!0)):Object.keys(obj.formula)[E]=null,obj.updateFormulaChain(D[0],D[1],c)}}chainLoopProtection=[]},obj.updateFormulas=function(n){for(var s=0;s<obj.options.data.length;s++)for(var c=0;c<obj.options.data[0].length;c++)if((d=""+obj.options.data[s][c]).substr(0,1)=="="){var f=obj.updateFormula(d,n);f!=d&&(obj.options.data[s][c]=f)}var E=[],D=Object.keys(obj.formula);for(s=0;s<D.length;s++){var U=D[s],d=obj.formula[U];for(n[U]&&(U=n[U]),E[U]=[],c=0;c<d.length;c++){var r=d[c];n[r]&&(r=n[r]),E[U].push(r)}}obj.formula=E},obj.updateFormula=function(n,s){for(var c=/[A-Z]/,f=/[0-9]/,E="",D=null,U=null,d="",r=0;r<n.length;r++)c.exec(n[r])?(D=1,U=0,d+=n[r]):f.exec(n[r])?(U=D?1:0,d+=n[r]):(D&&U&&(d=s[d]?s[d]:d),E+=d,E+=n[r],D=0,U=0,d="");return d&&(D&&U&&(d=s[d]?s[d]:d),E+=d),E};var secureFormula=function(n){for(var s="",c=0,f=0;f<n.length;f++)n[f]=='"'&&(c=c==0?1:0),s+=c==1?n[f]:n[f].toUpperCase();return s};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(n){for(var s=0;s<n.length;s++){var c=[],f=n[s].split(":"),E=jexcel.getIdFromColumnName(f[0],!0),D=jexcel.getIdFromColumnName(f[1],!0);if(E[0]<=D[0])var U=E[0],d=D[0];else U=D[0],d=E[0];if(E[1]<=D[1])var r=E[1],b=D[1];else r=D[1],b=E[1];for(var H=r;H<=b;H++)for(var P=U;P<=d;P++)c.push(jexcel.getColumnNameFromId([P,H]));expression=expression.replace(n[s],c.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(n){var res="#ERROR";console.log(n)}return res};return execute(expression,x,y)},obj.parseNumber=function(n,s){var c=s&&obj.options.columns[s].decimal?obj.options.columns[s].decimal:".",f=""+n;return(f=f.split(c))[0]=f[0].match(/[+-]?[0-9]/g),f[0]&&(f[0]=f[0].join("")),f[1]&&(f[1]=f[1].match(/[0-9]*/g).join("")),f[0]&&Number.isInteger(Number(f[0]))?f[1]?n=+(f[0]+"."+f[1]):n=+(f[0]+".00"):n=null,n},obj.row=function(n){},obj.col=function(n){},obj.up=function(n,s){if(n?obj.selectedCell[3]>0&&obj.up.visible(1,s?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-c<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var f=obj.whichPage(obj.selectedCell[3]);f!=obj.pageNumber&&obj.page(f)}obj.updateScroll(1)},obj.up.visible=function(n,s){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=0;E<f;E++)if(obj.records[E][c].style.display!="none"&&obj.rows[E].style.display!="none"){f=E;break}}else f=obj.up.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.up.get=function(n,s){n=parseInt(n);for(var c=(s=parseInt(s))-1;c>=0;c--)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[s][n])continue;s=c;break}return s},obj.down=function(n,s){if(n?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,s?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}obj.updateScroll(3)},obj.down.visible=function(n,s){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=obj.rows.length-1;E>f;E--)if(obj.records[E][c].style.display!="none"&&obj.rows[E].style.display!="none"){f=E;break}}else f=obj.down.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.down.get=function(n,s){n=parseInt(n);for(var c=(s=parseInt(s))+1;c<obj.rows.length;c++)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[s][n])continue;s=c;break}return s},obj.right=function(n,s){n?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,s?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(n,s){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=obj.headers.length-1;E>c;E--)if(obj.records[f][E].style.display!="none"){c=E;break}}else c=obj.right.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.right.get=function(n,s){n=parseInt(n),s=parseInt(s);for(var c=n+1;c<obj.headers.length;c++)if(obj.records[s][c].style.display!="none"){if(obj.records[s][c].getAttribute("data-merged")&&obj.records[s][c]==obj.records[s][n])continue;n=c;break}return n},obj.left=function(n,s){n?obj.selectedCell[2]>0&&obj.left.visible(1,s?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(n,s){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(s==0){for(var E=0;E<c;E++)if(obj.records[f][E].style.display!="none"){c=E;break}}else c=obj.left.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.left.get=function(n,s){n=parseInt(n),s=parseInt(s);for(var c=n-1;c>=0;c--)if(obj.records[s][c].style.display!="none"){if(obj.records[s][c].getAttribute("data-merged")&&obj.records[s][c]==obj.records[s][n])continue;n=c;break}return n},obj.first=function(n,s){if(n?s?obj.selectedCell[3]=0:obj.left.visible(1,0):(s?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(n,s){if(n?s?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(s?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(n){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)s=obj.rows;else var s=obj.results;var c=100;n!=null&&n!=-1||(n=Math.ceil(s.length/c)-1);var f=n*c,E=n*c+c;E>s.length&&(E=s.length),(f=E-100)<0&&(f=0);for(var D=f;D<E;D++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[D]):obj.tbody.appendChild(obj.rows[s[D]]),obj.tbody.children.length>c&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var s=0;if(n.length>100){var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c>0)for(var f=0;f<30;f++)(c-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[c],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[n[c]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),s=1))}return s},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var s=0;if(n.length>100){var c=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c<obj.rows.length-1)for(var f=0;f<=30;f++)c<n.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[c]):obj.tbody.appendChild(obj.rows[n[c]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),s=1)),c+=1}return s},obj.loadValidation=function(){if(obj.selectedCell){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,s=parseInt(obj.selectedCell[3]/100),c=parseInt(obj.rows.length/100);if(n!=s&&s<=c&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(s),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(n){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],n){var s=function(f){obj.results.indexOf(f)==-1&&obj.results.push(f)},c=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");c=new RegExp(c,"i"),obj.options.data.forEach(function(f,E){if(function(b,H,P){for(var g=0;g<b.length;g++)if((""+b[g]).toLowerCase().search(H)>=0||(""+obj.records[P][g].innerHTML).toLowerCase().search(H)>=0)return!0;return!1}(f,c,E)){var D=obj.isRowMerged(E);if(D.length)for(var U=0;U<D.length;U++)for(var d=jexcel.getIdFromColumnName(D[U],!0),r=0;r<obj.options.mergeCells[D[U]][1];r++)s(d[1]+r);else s(E)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var n,s=0;for(n=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var c=0;c<obj.rows.length;c++)!obj.results||obj.results.indexOf(c)>-1?(s<n&&(obj.tbody.appendChild(obj.rows[c]),s++),obj.rows[c].style.display=""):obj.rows[c].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),n},obj.whichPage=function(n){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=obj.results.indexOf(n)),Math.ceil((parseInt(n)+1)/parseInt(obj.options.pagination))-1},obj.page=function(n){var s=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)c=obj.rows;else var c=obj.results;var f=parseInt(obj.options.pagination);n!=null&&n!=-1||(n=Math.ceil(c.length/f)-1),obj.pageNumber=n;var E=n*f,D=n*f+f;for(D>c.length&&(D=c.length),E<0&&(E=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var U=E;U<D;U++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[U]):obj.tbody.appendChild(obj.rows[c[U]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,n,s)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows.length;else var n=obj.results.length;if(n){var s=Math.ceil(n/obj.options.pagination);if(obj.pageNumber<6)var c=1,f=s<10?s:10;else s-obj.pageNumber<5?(f=s,(c=s-9)<1&&(c=1)):(c=obj.pageNumber-4,f=obj.pageNumber+5);c>1&&((D=document.createElement("div")).className="jexcel_page",D.innerHTML="<",D.title=1,obj.pagination.children[1].appendChild(D));for(var E=c;E<=f;E++){var D;(D=document.createElement("div")).className="jexcel_page",D.innerHTML=E,obj.pagination.children[1].appendChild(D),obj.pageNumber==E-1&&D.classList.add("jexcel_page_selected")}f<s&&((D=document.createElement("div")).className="jexcel_page",D.innerHTML=">",D.title=s,obj.pagination.children[1].appendChild(D)),obj.pagination.children[0].innerHTML=function(U){var d=Array.prototype.slice.call(arguments,1);return U.replace(/{(\d+)}/g,function(r,b){return d[b]!==void 0?d[b]:r})}(obj.options.text.showingPage,obj.pageNumber+1,s)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(n){if(obj.options.allowExport==0)console.error("Export not allowed");else{var s="";s+=obj.copy(!1,obj.options.csvDelimiter,!0,n,!0);var c=new Blob(["\uFEFF"+s],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(c,obj.options.csvFileName+".csv");else{var f=document.createElement("a"),E=URL.createObjectURL(c);f.href=E,f.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(f),f.click(),f.parentNode.removeChild(f)}}},obj.setHistory=function(n){if(obj.ignoreHistory!=1){var s=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,s+1),obj.history[s]=n}},obj.copy=function(n,s,c,f,E){s||(s="	");for(var D=new RegExp(s,"ig"),U=[],d=[],r=[],b=[],H=[],P=obj.options.data[0].length,g=obj.options.data.length,u="",m=!1,j="",h="",C=0,T=0,I=0,B=0,F=!0,N=0;N<g;N++)for(var O=0;O<P;O++)n&&!obj.records[N][O].classList.contains("highlight")||(I<=O&&(I=O),B<=N&&(B=N));if(P===I+1&&g===B+1&&(F=!1),E&&obj.options.includeHeadersOnDownload==1||!E&&obj.options.includeHeadersOnCopy==1&&!F||f){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(u=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],N=0;N<u.length;N++){var G=[];for(O=0;O<u[N].length;O++){var q=parseInt(u[N][O].colspan);G.push(u[N][O].title);for(var se=0;se<q-1;se++)G.push("")}h+=G.join(s)+`\r
`}m=!0}for(obj.style=[],N=0;N<g;N++){for(d=[],r=[],O=0;O<P;O++)if(!n||obj.records[N][O].classList.contains("highlight")){m==1&&U.push(obj.headers[O].textContent);var ge=obj.options.data[N][O];if(ge.match&&(ge.match(D)||ge.match(/,/g)||ge.match(/\n/)||ge.match(/\"/))&&(ge='"'+(ge=ge.replace(new RegExp('"',"g"),'""'))+'"'),d.push(ge),obj.options.columns[O].type=="checkbox"||obj.options.columns[O].type=="radio")var ie=ge;else(ie=obj.options.stripHTMLOnCopy==1?obj.records[N][O].textContent:obj.records[N][O].innerHTML).match&&(ie.match(D)||ie.match(/,/g)||ie.match(/\n/)||ie.match(/\"/))&&(ie='"'+(ie=ie.replace(new RegExp('"',"g"),'""'))+'"');r.push(ie),u=(u=obj.records[N][O].getAttribute("style")).replace("display: none;",""),obj.style.push(u||"")}d.length&&(m&&(C=d.length,b.push(U.join(s))),b.push(d.join(s))),r.length&&(T++,m&&(H.push(U.join(s)),m=!1),H.push(r.join(s)))}P==C&&g==T&&(j=h);var xe=j+b.join(`\r
`),Te=j+H.join(`\r
`);if(c||(obj.options.copyCompatibility==1?obj.textarea.value=Te:obj.textarea.value=xe,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Te:obj.data=xe,obj.hashString=obj.hash(obj.data),!c){if(obj.removeCopyingSelection(),obj.highlighted)for(O=0;O<obj.highlighted.length;O++)obj.highlighted[O].classList.add("copying"),obj.highlighted[O].classList.contains("highlight-left")&&obj.highlighted[O].classList.add("copying-left"),obj.highlighted[O].classList.contains("highlight-right")&&obj.highlighted[O].classList.add("copying-right"),obj.highlighted[O].classList.contains("highlight-top")&&obj.highlighted[O].classList.add("copying-top"),obj.highlighted[O].classList.contains("highlight-bottom")&&obj.highlighted[O].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?H:b,obj.hashString)}return obj.data},obj.paste=function(n,s,c){var f=obj.dispatch("onbeforepaste",el,c,n,s);if(f===!1)return!1;f&&(c=f);var E=obj.hash(c),D=E==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&E==obj.hashString&&(c=obj.data),c=obj.parseCSV(c,"	"),n!=null&&s!=null&&c){for(var U=0,d=0,r=[],b={},H={},P=0,g=parseInt(n),u=parseInt(s),m=null;m=c[d];){for(U=0,g=parseInt(n);m[U]!=null;){var j=obj.updateCell(g,u,m[U]);if(r.push(j),obj.updateFormulaChain(g,u,r),D&&D[P]){var h=jexcel.getColumnNameFromId([g,u]);b[h]=D[P],H[h]=obj.getStyle(h),obj.records[u][g].setAttribute("style",D[P]),P++}if(m[++U]!=null){if(g>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}g=obj.right.get(g,u)}}if(c[++d]){if(u>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}u=obj.down.get(n,u)}}obj.updateSelectionFromCoords(n,s,g,u),obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell,newStyle:b,oldStyle:H}),obj.updateTable(),obj.dispatch("onpaste",el,c),obj.onafterchanges(el,r)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var n=document.querySelectorAll(".jexcel .copying"),s=0;s<n.length;s++)n[s].classList.remove("copying"),n[s].classList.remove("copying-left"),n[s].classList.remove("copying-right"),n[s].classList.remove("copying-top"),n[s].classList.remove("copying-bottom")},obj.historyProcessRow=function(n,s){var c=s.insertBefore?+s.rowNumber:s.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),n==1){for(var f=s.numOfRows,E=c;E<f+c;E++)obj.rows[E].parentNode.removeChild(obj.rows[E]);obj.records.splice(c,f),obj.options.data.splice(c,f),obj.rows.splice(c,f),obj.conditionalSelectionUpdate(1,c,f+c-1)}else{obj.records=jexcel.injectArray(obj.records,c,s.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,c,s.rowData),obj.rows=jexcel.injectArray(obj.rows,c,s.rowNode);var D=0;for(E=c;E<s.numOfRows+c;E++)obj.tbody.insertBefore(s.rowNode[D],obj.tbody.children[E]),D++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(n,s){var c=s.insertBefore?s.columnNumber:s.columnNumber+1;if(n==1){var f=s.numOfColumns;obj.options.columns.splice(c,f);for(var E=c;E<f+c;E++)obj.headers[E].parentNode.removeChild(obj.headers[E]),obj.colgroup[E].parentNode.removeChild(obj.colgroup[E]);obj.headers.splice(c,f),obj.colgroup.splice(c,f);for(var D=0;D<s.data.length;D++){for(E=c;E<f+c;E++)obj.records[D][E].parentNode.removeChild(obj.records[D][E]);obj.records[D].splice(c,f),obj.options.data[D].splice(c,f)}if(obj.options.footers)for(D=0;D<obj.options.footers.length;D++)obj.options.footers[D].splice(c,f)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,c,s.columns),obj.headers=jexcel.injectArray(obj.headers,c,s.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,c,s.colgroup);var U=0;for(E=c;E<s.numOfColumns+c;E++)obj.headerContainer.insertBefore(s.headers[U],obj.headerContainer.children[E+1]),obj.colgroupContainer.insertBefore(s.colgroup[U],obj.colgroupContainer.children[E+1]),U++;for(D=0;D<s.data.length;D++)for(obj.options.data[D]=jexcel.injectArray(obj.options.data[D],c,s.data[D]),obj.records[D]=jexcel.injectArray(obj.records[D],c,s.records[D]),U=0,E=c;E<s.numOfColumns+c;E++)obj.rows[D].insertBefore(s.records[D][U],obj.rows[D].children[E+1]),U++;if(obj.options.footers)for(D=0;D<obj.options.footers.length;D++)obj.options.footers[D]=jexcel.injectArray(obj.options.footers[D],c,s.footers[D])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(D=0;D<obj.options.nestedHeaders.length;D++){if(n==1)var d=parseInt(obj.options.nestedHeaders[D][obj.options.nestedHeaders[D].length-1].colspan)-s.numOfColumns;else d=parseInt(obj.options.nestedHeaders[D][obj.options.nestedHeaders[D].length-1].colspan)+s.numOfColumns;obj.options.nestedHeaders[D][obj.options.nestedHeaders[D].length-1].colspan=d,obj.thead.children[D].children[obj.thead.children[D].children.length-1].setAttribute("colspan",d)}else d=n==1?parseInt(obj.options.nestedHeaders[0].colspan)-s.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+s.numOfColumns,obj.options.nestedHeaders[0].colspan=d,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",d);obj.updateTableReferences()},obj.undo=function(){var n=!!obj.ignoreEvents,s=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var c=[];if(obj.historyIndex>=0){var f=obj.history[obj.historyIndex--];if(f.action=="insertRow")obj.historyProcessRow(1,f);else if(f.action=="deleteRow")obj.historyProcessRow(0,f);else if(f.action=="insertColumn")obj.historyProcessColumn(1,f);else if(f.action=="deleteColumn")obj.historyProcessColumn(0,f);else if(f.action=="moveRow")obj.moveRow(f.newValue,f.oldValue);else if(f.action=="moveColumn")obj.moveColumn(f.newValue,f.oldValue);else if(f.action=="setMerge")obj.removeMerge(f.column,f.data);else if(f.action=="setStyle")obj.setStyle(f.oldValue,null,null,1);else if(f.action=="setWidth")obj.setWidth(f.column,f.oldValue);else if(f.action=="setHeight")obj.setHeight(f.row,f.oldValue);else if(f.action=="setHeader")obj.setHeader(f.column,f.oldValue);else if(f.action=="setComments")obj.setComments(f.column,f.oldValue[0],f.oldValue[1]);else if(f.action=="orderBy"){for(var E=[],D=0;D<f.rows.length;D++)E[f.rows[D]]=D;obj.updateOrderArrow(f.column,f.order?0:1),obj.updateOrder(E)}else if(f.action=="setValue"){for(var U=0;U<f.records.length;U++)c.push({x:f.records[U].x,y:f.records[U].y,newValue:f.records[U].oldValue}),f.oldStyle&&obj.resetStyle(f.oldStyle);obj.setValue(c),f.selection&&obj.updateSelectionFromCoords(f.selection[0],f.selection[1],f.selection[2],f.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=s,obj.dispatch("onundo",el,f)},obj.redo=function(){var n=!!obj.ignoreEvents,s=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var c=obj.history[++obj.historyIndex];if(c.action=="insertRow")obj.historyProcessRow(0,c);else if(c.action=="deleteRow")obj.historyProcessRow(1,c);else if(c.action=="insertColumn")obj.historyProcessColumn(0,c);else if(c.action=="deleteColumn")obj.historyProcessColumn(1,c);else if(c.action=="moveRow")obj.moveRow(c.oldValue,c.newValue);else if(c.action=="moveColumn")obj.moveColumn(c.oldValue,c.newValue);else if(c.action=="setMerge")obj.setMerge(c.column,c.colspan,c.rowspan,1);else if(c.action=="setStyle")obj.setStyle(c.newValue,null,null,1);else if(c.action=="setWidth")obj.setWidth(c.column,c.newValue);else if(c.action=="setHeight")obj.setHeight(c.row,c.newValue);else if(c.action=="setHeader")obj.setHeader(c.column,c.newValue);else if(c.action=="setComments")obj.setComments(c.column,c.newValue[0],c.newValue[1]);else if(c.action=="orderBy")obj.updateOrderArrow(c.column,c.order),obj.updateOrder(c.rows);else if(c.action=="setValue"){obj.setValue(c.records);for(var f=0;f<c.records.length;f++)c.oldStyle&&obj.resetStyle(c.newStyle);c.selection&&obj.updateSelectionFromCoords(c.selection[0],c.selection[1],c.selection[2],c.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=s,obj.dispatch("onredo",el,c)},obj.getDropDownValue=function(n,s){var c=[];if(obj.options.columns[n]&&obj.options.columns[n].source){for(var f=[],E=obj.options.columns[n].source,D=0;D<E.length;D++)typeof E[D]=="object"?f[E[D].id]=E[D].name:f[E[D]]=E[D];var U=Array.isArray(s)?s:(""+s).split(";");for(D=0;D<U.length;D++)typeof U[D]=="object"?c.push(f[U[D].id]):f[U[D]]&&c.push(f[U[D]])}else console.error("Invalid column");return c.length>0?c.join("; "):""},obj.parseCSV=function(n,s){(n=n.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(n.length-1)==9&&(n+="\0"),s=s||",";for(var c=[],f=!1,E=0,D=0,U=0;U<n.length;U++){var d=n[U],r=n[U+1];c[E]=c[E]||[],c[E][D]=c[E][D]||"",d=='"'&&f&&r=='"'?(c[E][D]+=d,++U):d!='"'?d!=s||f?d!="\r"||r!=`
`||f?d==`
`&&!f||d=="\r"&&!f?(++E,D=0):c[E][D]+=d:(++E,D=0,++U):++D:f=!f}return c},obj.hash=function(n){var s,c=0;if(n.length===0)return c;for(s=0;s<n.length;s++)c=(c<<5)-c+n.charCodeAt(s),c|=0;return c},obj.onafterchanges=function(n,s){obj.dispatch("onafterchanges",n,s)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(n){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(n){var s=obj.parseCSV(n,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&s.length>0)for(var c=s.shift(),f=0;f<c.length;f++)obj.options.columns[f]||(obj.options.columns[f]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[f].title===void 0&&(obj.options.columns[f].title=c[f]);obj.options.data=s,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(n,s,c,f){var E=[];if(c==null)obj.options.allowInsertColumn==1&&E.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(s),1)}}),obj.options.allowInsertColumn==1&&E.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(s),0)}}),obj.options.allowDeleteColumn==1&&E.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(s))}}),obj.options.allowRenameColumn==1&&E.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(s)}}),obj.options.columnSorting==1&&(E.push({type:"line"}),E.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(s,0)}}),E.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(s,1)}}));else if(obj.options.allowInsertRow==1&&(E.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(c),1)}}),E.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(c))}})),obj.options.allowDeleteRow==1&&E.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(c))}}),s&&obj.options.allowComments==1){E.push({type:"line"});var D=obj.records[c][s].getAttribute("title")||"";E.push({title:D?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var U=prompt(obj.options.text.comments,D);U&&obj.setComments([s,c],U)}}),D&&E.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([s,c],"")}})}return E.push({type:"line"}),E.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&E.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(U){U&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],U)})}}),obj.options.allowExport&&E.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&E.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),E},obj.scrollControls=function(n){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&n.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(n){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var n=0;if(obj.options.freezeColumns>0)for(var s=0;s<obj.options.freezeColumns;s++)n+=parseInt(obj.options.columns[s].width);return n};var scrollLeft=0;return obj.updateFreezePosition=function(){var n=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var s=0;s<obj.options.freezeColumns;s++){s>0&&obj.options.columns[s-1].type!=="hidden"&&(n+=parseInt(obj.options.columns[s-1].width)),obj.headers[s].classList.add("jexcel_freezed"),obj.headers[s].style.left=n+"px";for(var c=0;c<obj.rows.length;c++)if(obj.rows[c]&&obj.records[c][s]){var f=scrollLeft+(s>0?obj.records[c][s-1].style.width:0)-51+"px";obj.records[c][s].classList.add("jexcel_freezed"),obj.records[c][s].style.left=f}}else for(s=0;s<obj.options.freezeColumns;s++)for(obj.headers[s].classList.remove("jexcel_freezed"),obj.headers[s].style.left="",c=0;c<obj.rows.length;c++)obj.records[c][s]&&(obj.records[c][s].classList.remove("jexcel_freezed"),obj.records[c][s].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(n){jSuites.setDictionary(n)},jexcel.setExtensions=function(n){for(var s=Object.keys(n),c=0;c<s.length;c++)typeof n[s[c]]=="function"&&(jexcel[s[c]]=n[s[c]],jexcel.license&&typeof n[s[c]].license=="function"&&n[s[c]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(n){n.removeEventListener("mouseup",jexcel.mouseUpControls),n.removeEventListener("mousedown",jexcel.mouseDownControls),n.removeEventListener("mousemove",jexcel.mouseMoveControls),n.removeEventListener("mouseover",jexcel.mouseOverControls),n.removeEventListener("dblclick",jexcel.doubleClickControls),n.removeEventListener("paste",jexcel.pasteControls),n.removeEventListener("contextmenu",jexcel.contextMenuControls),n.removeEventListener("touchstart",jexcel.touchStartControls),n.removeEventListener("touchend",jexcel.touchEndControls),n.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(n,s){if(n.jexcel){var c=n.jexcel.options.root?n.jexcel.options.root:document;n.removeEventListener("DOMMouseScroll",n.jexcel.scrollControls),n.removeEventListener("mousewheel",n.jexcel.scrollControls),n.jexcel=null,n.innerHTML="",s&&(destroyEvents(c),jexcel=null)}},jexcel.build=function(n){destroyEvents(n),n.addEventListener("mouseup",jexcel.mouseUpControls),n.addEventListener("mousedown",jexcel.mouseDownControls),n.addEventListener("mousemove",jexcel.mouseMoveControls),n.addEventListener("mouseover",jexcel.mouseOverControls),n.addEventListener("dblclick",jexcel.doubleClickControls),n.addEventListener("paste",jexcel.pasteControls),n.addEventListener("contextmenu",jexcel.contextMenuControls),n.addEventListener("touchstart",jexcel.touchStartControls),n.addEventListener("touchend",jexcel.touchEndControls),n.addEventListener("touchcancel",jexcel.touchEndControls),n.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(n){if(jexcel.current){if(jexcel.current.edition)if(n.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&n.altKey){var s=jexcel.current.edition[0].children[0],c=jexcel.current.edition[0].children[0].value,f=s.selectionStart;c=c.slice(0,f)+`
`+c.slice(f),s.value=c,s.focus(),s.selectionStart=f+1,s.selectionEnd=f+1}else jexcel.current.edition[0].children[0].blur()}else n.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(n.which==37)jexcel.current.left(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)jexcel.current.right(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)jexcel.current.up(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)jexcel.current.down(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)jexcel.current.first(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)jexcel.current.last(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(n.which==13)n.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),n.preventDefault();else if(n.which==9)n.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var E=jexcel.current.selectedCell[1],D=jexcel.current.selectedCell[0];jexcel.current.options.columns[D].type!="readonly"&&(n.keyCode==32?(n.preventDefault(),jexcel.current.options.columns[D].type=="checkbox"||jexcel.current.options.columns[D].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[E][D],!0)):n.keyCode==113?jexcel.current.openEditor(jexcel.current.records[E][D],!1):(n.keyCode==8||n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=111||n.keyCode>=187&&n.keyCode<=190||(String.fromCharCode(n.keyCode)==n.key||String.fromCharCode(n.keyCode).toLowerCase()==n.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(n.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[E][D],!0),jexcel.current.options.columns[D].type=="calendar"&&n.preventDefault()))}}else n.which==65?(jexcel.current.selectAll(),n.preventDefault()):n.which==83?(jexcel.current.download(),n.preventDefault()):n.which==89?(jexcel.current.redo(),n.preventDefault()):n.which==90?(jexcel.current.undo(),n.preventDefault()):n.which==67?(jexcel.current.copy(!0),n.preventDefault()):n.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),n.preventDefault()):n.which==86&&jexcel.pasteControls();else n.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(n.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;var c=jexcel.getElement(n.target);if(c[0]?jexcel.current!=c[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=c[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&s==1){if(n.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(n.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(c[1]==1){if(u=n.target.getAttribute("data-x")){var f=n.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&f.width-n.offsetX<6){jexcel.current.resizing={mousePosition:n.pageX,column:u,width:f.width},jexcel.current.headers[u].classList.add("resizing");for(var E=0;E<jexcel.current.records.length;E++)jexcel.current.records[E][u]&&jexcel.current.records[E][u].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&f.height-n.offsetY<6)if(jexcel.current.isColMerged(u).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target,column:u,destination:u},jexcel.current.headers[u].classList.add("dragging"),E=0;E<jexcel.current.records.length;E++)jexcel.current.records[E][u]&&jexcel.current.records[E][u].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(n.shiftKey||n.ctrlKey))var D=jexcel.current.selectedHeader,U=u;else jexcel.current.selectedHeader==u&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(u)},800)),jexcel.current.selectedHeader=u,D=u,U=u;jexcel.current.updateSelectionFromCoords(D,0,U,jexcel.current.options.data.length-1)}}else if(n.target.parentNode.classList.contains("jexcel_nested")){if(n.target.getAttribute("data-column"))var d=n.target.getAttribute("data-column").split(","),r=parseInt(d[0]),b=parseInt(d[d.length-1]);else r=0,b=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(r,0,b,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(c[1]==2){var H=n.target.getAttribute("data-y");if(n.target.classList.contains("jexcel_row"))f=n.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&f.height-n.offsetY<6?(jexcel.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:H,height:f.height},n.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&f.width-n.offsetX<6?jexcel.current.isRowMerged(H).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target.parentNode,row:H,destination:H},n.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(n.shiftKey||n.ctrlKey)?(D=jexcel.current.selectedRow,U=H):(jexcel.current.selectedRow=H,D=H,U=H),jexcel.current.updateSelectionFromCoords(0,D,jexcel.current.options.data[0].length-1,U));else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var P=function(m){var j=m.getAttribute("data-x"),h=m.getAttribute("data-y");return j&&h?[j,h]:m.parentNode?P(m.parentNode):void 0},g=P(n.target);if(g){var u=g[0];H=g[1],jexcel.current.edition&&(jexcel.current.edition[2]==u&&jexcel.current.edition[3]==H||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(n.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],u,H):jexcel.current.updateSelectionFromCoords(u,H)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;n.target.classList.contains("jexcel_page")&&(n.target.textContent=="<"?jexcel.current.page(0):n.target.textContent==">"?jexcel.current.page(n.target.getAttribute("title")-1):jexcel.current.page(n.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(n){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var s=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),c=jexcel.current.getSelectedColumns();if(c.length>1){for(var f=[],E=0;E<c.length;E++)f.push(parseInt(jexcel.current.colgroup[c[E]].getAttribute("width")));f[c.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(c,s,f)}else jexcel.current.setWidth(jexcel.current.resizing.column,s,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var D=0;D<jexcel.current.records.length;D++)jexcel.current.records[D][jexcel.current.resizing.column]&&jexcel.current.records[D][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var U=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,U,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var d=n.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),D=0;D<jexcel.current.rows.length;D++)jexcel.current.records[D][jexcel.current.dragging.column]&&jexcel.current.records[D][jexcel.current.dragging.column].classList.remove("dragging");for(E=0;E<jexcel.current.headers.length;E++)jexcel.current.headers[E].classList.remove("dragging-left"),jexcel.current.headers[E].classList.remove("dragging-right");d&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var r=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<r&&(r-=1)}else r=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,r,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;if(s||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var c=n.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+c>0){var f=jexcel.current.resizing.width+c;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",f),jexcel.current.updateCornerPosition()}}else{var E=n.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+E>0){var D=jexcel.current.resizing.height+E;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",D),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var U=n.target.getAttribute("data-x");if(U)if(jexcel.current.isColMerged(U).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var d=0;d<jexcel.current.headers.length;d++)jexcel.current.headers[d].classList.remove("dragging-left"),jexcel.current.headers[d].classList.remove("dragging-right");jexcel.current.dragging.column==U?jexcel.current.dragging.destination=parseInt(U):n.target.clientWidth/2>n.offsetX?(jexcel.current.dragging.column<U?jexcel.current.dragging.destination=parseInt(U)-1:jexcel.current.dragging.destination=parseInt(U),jexcel.current.headers[U].classList.add("dragging-left")):(jexcel.current.dragging.column<U?jexcel.current.dragging.destination=parseInt(U):jexcel.current.dragging.destination=parseInt(U)+1,jexcel.current.headers[U].classList.add("dragging-right"))}}else{var r=n.target.getAttribute("data-y");if(r)if(jexcel.current.isRowMerged(r).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var b=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;jexcel.current.dragging.element!=b&&(n.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,b),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var H=n.target.getAttribute("data-x"),P=n.target.getAttribute("data-y"),g=n.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&H&&!P&&g.width-(n.clientX-g.left)<6?(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="col-resize"):n.target&&!H&&P&&g.height-(n.clientY-g.top)<6&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!H&&P&&g.width-(n.clientX-g.left)<6||n.target&&H&&!P&&g.height-(n.clientY-g.top)<6)&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;if(s||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var c=jexcel.getElement(n.target);if(c[0]){if(jexcel.current!=c[0].jexcel&&jexcel.current)return!1;var f=n.target.getAttribute("data-x"),E=n.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(c[1]==1&&jexcel.current.selectedHeader){f=n.target.getAttribute("data-x");var D=jexcel.current.selectedHeader,U=f;jexcel.current.updateSelectionFromCoords(D,0,U,jexcel.current.options.data.length-1)}c[1]==2&&(n.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(D=jexcel.current.selectedRow,U=E,jexcel.current.updateSelectionFromCoords(0,D,jexcel.current.options.data[0].length-1,U)):jexcel.current.edition||f&&E&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(f,E):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],f,E)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(n){if(jexcel.current)if(n.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var s=jexcel.current.highlighted[0].getAttribute("data-x"),c=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,f=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),E=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[c][s],jexcel.current.records[E][f])}}else if(n.target.classList.contains("jexcel_column_filter")){var D=n.target.getAttribute("data-x");jexcel.current.openFilter(D)}else{var U=jexcel.getElement(n.target);if(U[1]==1&&jexcel.current.options.columnSorting==1&&(D=n.target.getAttribute("data-x"))&&jexcel.current.orderBy(D),U[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var d=function(b){if(b.parentNode){var H=b.getAttribute("data-x"),P=b.getAttribute("data-y");return H&&P?b:d(b.parentNode)}},r=d(n.target);r&&r.classList.contains("highlight")&&jexcel.current.openEditor(r)}}},jexcel.copyControls=function(n){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(n){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(n){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(n&&n.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,jexcel.current){if(jexcel.current.edition)n.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var s=n.target.getAttribute("data-x"),c=n.target.getAttribute("data-y");if(s||c){(s<parseInt(jexcel.current.selectedCell[0])||s>parseInt(jexcel.current.selectedCell[2])||c<parseInt(jexcel.current.selectedCell[1])||c>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(s,c,s,c);var f=jexcel.current.options.contextMenu(jexcel.current,s,c,n);jexcel.current.contextMenu.contextmenu.open(n,f),n.preventDefault()}}}},jexcel.touchStartControls=function(n){var s=jexcel.getElement(n.target);if(s[0]?jexcel.current!=s[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=s[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var c=n.target.getAttribute("data-x"),f=n.target.getAttribute("data-y");c&&f&&(jexcel.current.updateSelectionFromCoords(c,f),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[c].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=n.target,jexcel.current.openEditor(n.target,!1,n)},500))}},jexcel.touchEndControls=function(n){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(n,s){var c=[];if(n.classList.contains("jexcel_tabs"))E=n.children[0],D=n.children[1];else{n.innerHTML="",n.classList.add("jexcel_tabs"),n.jexcel=[];var f=document.createElement("div"),E=n.appendChild(f),D=(f=document.createElement("div"),n.appendChild(f))}for(var U=[],d=[],r=0;r<s.length;r++){U[r]=document.createElement("div"),U[r].classList.add("jexcel_tab");var b=jexcel(U[r],s[r]);D.appendChild(U[r]),c[r]=n.jexcel.push(b),d[r]=document.createElement("div"),d[r].classList.add("jexcel_tab_link"),d[r].setAttribute("data-spreadsheet",n.jexcel.length-1),d[r].innerHTML=s[r].sheetName,d[r].onclick=function(){for(var P=0;P<E.children.length;P++)E.children[P].classList.remove("selected"),D.children[P].style.display="none";var g=this.getAttribute("data-spreadsheet");D.children[g].style.display="block",E.children[g].classList.add("selected")},E.appendChild(d[r])}for(var H=0;H<E.children.length;H++)E.children[H].classList.remove("selected"),D.children[H].style.display="none";return E.children[E.children.length-1].classList.add("selected"),D.children[E.children.length-1].style.display="block",c},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(n,s){var c,f=function(E){var D=[];return E.SheetNames.forEach(function(U){var d={rows:[],columns:[],data:[],style:{}};if(d.sheetName=U,(h=E.Sheets[U]["!cols"])&&h.length)for(var r=0;r<h.length;r++)d.columns[r]={},h[r]&&h[r].wpx&&(d.columns[r].width=h[r].wpx+"px");if((h=E.Sheets[U]["!rows"])&&h.length)for(r=0;r<h.length;r++)h[r]&&h[r].hpx&&(d.rows[r]={},d.rows[r].height=h[r].hpx+"px");if((h=E.Sheets[U]["!merges"])&&h.length>0)for(d.mergeCells=[],r=0;r<h.length;r++){var b=h[r].s.c,H=h[r].s.r,P=h[r].e.c,g=h[r].e.r,u=jexcel.getColumnNameFromId([b,H]);d.mergeCells[u]=[P-b+1,g-H+1]}var m=0,j=0,h=Object.keys(E.Sheets[U]);for(r=0;r<h.length;r++)if(h[r].substr(0,1)!="!"){var C=E.Sheets[U][h[r]],T=jexcel.getIdFromColumnName(h[r],!0);d.data[T[1]]||(d.data[T[1]]=[]),d.data[T[1]][T[0]]=C.f?"="+C.f:C.w,m<T[0]&&(m=T[0]),j<T[1]&&(j=T[1]),C.style&&Object.keys(C.style).length>0&&(d.style[h[r]]=C.style),C.s&&C.s.fgColor&&(d.style[h[r]]&&(d.style[h[r]]+=";"),d.style[h[r]]+="background-color:#"+C.s.fgColor.rgb)}for(var I=d.columns,B=0;B<=j;B++)for(r=0;r<=m;r++)d.data[B]||(d.data[B]=[]),d.data[B][r]||I<r&&(d.data[B][r]="");D.push(d)}),D};(c=new XMLHttpRequest).open("GET",n,!0),typeof Uint8Array<"u"?(c.responseType="arraybuffer",c.onload=function(E){var D=c.response,U=new Uint8Array(D),d=XLSX.read(U,{type:"array",cellFormula:!0,cellStyles:!0});s(f(d))}):(c.setRequestHeader("Accept-Charset","x-user-defined"),c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){var E=convertResponseBodyToText(c.responseBody),D=XLSX.read(E,{type:"binary",cellFormula:!0,cellStyles:!0});s(f(D))}}),c.send()},jexcel.validLetter=function(n){return n.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(n,s,c){return n.slice(0,s).concat(c).concat(n.slice(s))},jexcel.getColumnName=function(n){var s="";return n>701?(s+=String.fromCharCode(64+parseInt(n/676)),s+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(s+=String.fromCharCode(64+parseInt(n/26))),s+String.fromCharCode(65+n%26)},jexcel.getIdFromColumnName=function(n,s){var c=/^[a-zA-Z]+/.exec(n);if(c){for(var f=0,E=0;E<c[0].length;E++)f+=parseInt(c[0].charCodeAt(E)-64)*Math.pow(26,c[0].length-1-E);--f<0&&(f=0);var D=parseInt(/[0-9]+$/.exec(n));D>0&&D--,n=s==1?[f,D]:f+"-"+D}return n},jexcel.getColumnNameFromId=function(n){return Array.isArray(n)||(n=n.split("-")),jexcel.getColumnName(parseInt(n[0]))+(parseInt(n[1])+1)},jexcel.getElement=function(n){var s=0,c=0;return function f(E){E.className&&E.classList.contains("jexcel_container")&&(c=E),E.tagName=="THEAD"?s=1:E.tagName=="TBODY"&&(s=2),E.parentNode&&(c||f(E.parentNode))}(n),[c,s]},jexcel.doubleDigitFormat=function(n){return(n=""+n).length==1&&(n="0"+n),n},jexcel.createFromTable=function(n,s){if(n.tagName=="TABLE"){s||(s={}),s.columns=[],s.data=[];var c=n.querySelectorAll("colgroup > col");if(c.length)for(var f=0;f<c.length;f++){if(!(E=c[f].style.width))var E=c[f].getAttribute("width");E&&(s.columns[f]||(s.columns[f]={}),s.columns[f].width=E)}var D=function(xe){var Te=xe.getBoundingClientRect(),ye=Te.width>50?Te.width:50;s.columns[f]||(s.columns[f]={}),xe.getAttribute("data-celltype")?s.columns[f].type=xe.getAttribute("data-celltype"):s.columns[f].type="text",s.columns[f].width=ye+"px",s.columns[f].title=xe.innerHTML,s.columns[f].align=xe.style.textAlign||"center",(Te=xe.getAttribute("name"))&&(s.columns[f].name=Te),(Te=xe.getAttribute("id"))&&(s.columns[f].id=Te),(Te=xe.getAttribute("data-mask"))&&(s.columns[f].mask=Te)},U=[],d=n.querySelectorAll(":scope > thead > tr");if(d.length){for(var r=0;r<d.length-1;r++){var b=[];for(f=0;f<d[r].children.length;f++){var H={title:d[r].children[f].textContent,colspan:d[r].children[f].getAttribute("colspan")||1};b.push(H)}U.push(b)}for(d=d[d.length-1].children,f=0;f<d.length;f++)D(d[f])}var P=0,g={},u={},m={},j={},h=n.querySelectorAll(":scope > tr, :scope > tbody > tr");for(r=0;r<h.length;r++)if(s.data[P]=[],s.parseTableFirstRowAsHeader!=1||d.length||r!=0){for(f=0;f<h[r].children.length;f++){if(C=h[r].children[f].getAttribute("data-formula"))C.substr(0,1)!="="&&(C="="+C);else var C=h[r].children[f].innerHTML;s.data[P].push(C);var T=jexcel.getColumnNameFromId([f,r]),I=h[r].children[f].getAttribute("class");I&&(j[T]=I);var B=parseInt(h[r].children[f].getAttribute("colspan"))||0,F=parseInt(h[r].children[f].getAttribute("rowspan"))||0;(B||F)&&(g[T]=[B||1,F||1]),h[r].children[f].style&&h[r].children[f].style.display=="none"&&(h[r].children[f].style.display="");var N=h[r].children[f].getAttribute("style");N&&(m[T]=N),h[r].children[f].classList.contains("styleBold")&&(m[T]?m[T]+="; font-weight:bold;":m[T]="font-weight:bold;")}h[r].style&&h[r].style.height&&(u[r]={height:h[r].style.height}),P++}else for(f=0;f<h[r].children.length;f++)D(h[r].children[f]);if(Object.keys(U).length>0&&(s.nestedHeaders=U),Object.keys(m).length>0&&(s.style=m),Object.keys(g).length>0&&(s.mergeCells=g),Object.keys(u).length>0&&(s.rows=u),Object.keys(j).length>0&&(s.classes=j),(h=n.querySelectorAll("tfoot tr")).length){var O=[];for(r=0;r<h.length;r++){var G=[];for(f=0;f<h[r].children.length;f++)G.push(h[r].children[f].textContent);O.push(G)}Object.keys(O).length>0&&(s.footers=O)}if(s.parseTableAutoCellType==1){var q=[];for(f=0;f<s.columns.length;f++){var se=!0,ge=!0;for(q[f]=[],r=0;r<s.data.length;r++)C=s.data[r][f],q[f][C]||(q[f][C]=0),q[f][C]++,C.length>25&&(se=!1),C.length==10&&C.substr(4,1)=="-"&&C.substr(7,1)=="-"||(ge=!1);var ie=Object.keys(q[f]).length;ge?s.columns[f].type="calendar":se==1&&ie>1&&ie<=parseInt(.1*s.data.length)&&(s.columns[f].type="dropdown",s.columns[f].source=Object.keys(q[f]))}}return s}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(n){if(this.config.root)var s=this.config.root;else s=window;var c=0,f=s.getSelection();if(f&&f.rangeCount!==0){var E=f.getRangeAt(0),D=E.cloneRange();D.selectNodeContents(n),D.setEnd(E.endContainer,E.endOffset),c=D.toString().length}return c},invert:function(n){for(var s=[],c=Object.keys(n),f=0;f<c.length;f++)s[n[c[f]]]=c[f];return s},getColumnName:function(n){var s="";return n>701?(s+=String.fromCharCode(64+parseInt(n/676)),s+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(s+=String.fromCharCode(64+parseInt(n/26))),s+String.fromCharCode(65+n%26)},getColumnNameFromCoords:function(n,s){return component.getColumnName(parseInt(n))+(parseInt(s)+1)},getCoordsFromColumnName:function(n){var s=/^[a-zA-Z]+/.exec(n);if(s){for(var c=0,f=0;f<s[0].length;f++)c+=parseInt(s[0].charCodeAt(f)-64)*Math.pow(26,s[0].length-1-f);--c<0&&(c=0);var E=parseInt(/[0-9]+$/.exec(n))||null;return E>0&&E--,[c,E]}},createFromTable:function(){},injectArray:function(n,s,c){return n.slice(0,s).concat(c).concat(n.slice(s))},parseCSV:function(n,s){s=s||",";for(var c=0,f=0,E=[[]],D=0,U=null,d=!1,r=!1,b=0;b<n.length;b++)if(E[f]||(E[f]=[]),E[f][c]||(E[f][c]=""),n[b]!="\r")if(n[b]!=`
`&&n[b]!=s||d!=0&&r!=1&&U){if(n[b]=='"'&&(d=!d),U===null){if((U=d)==1)continue}else if(U===!0&&!r&&n[b]=='"'){n[b+1]=='"'?(d=!0,E[f][c]+=n[b],b++):r=!0;continue}E[f][c]+=n[b]}else{if(U=null,d=!1,r=!1,E[f][c][0]=='"'){var H=E[f][c].trim();H[H.length-1]=='"'&&(E[f][c]=H.substr(1,H.length-2))}n[b]==`
`?(c=0,f++):++c>D&&(D=c)}for(var P=0;P<E.length;P++)for(b=0;b<=D;b++)E[P][b]===void 0&&(E[P][b]="");return E}},component),typeof jQuery<"u"&&function(n){n.fn.jspreadsheet=n.fn.jexcel=function(s){var c=n(this).get(0);return c.jexcel?Array.isArray(c.jexcel)?c.jexcel[s][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):c.jexcel[s].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(n){var s=__webpack_module_cache__[n];if(s!==void 0)return s.exports;var c=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(c.exports,c,c.exports,__webpack_require__),c.exports}var __webpack_exports__=__webpack_require__(138);return __webpack_exports__}()})})(dist);var distExports=dist.exports;const jspreadsheet=getDefaultExportFromCjs(distExports);requireJsuites();function tostring(n){return"⬉⬋⬊⬈"[n]}function opposite(n){return n+2&3}function clockwise(n){return n+3&3}function counterClockwise(n){return n+1&3}var Wall=(n=>(n[n.BLOCK=0]="BLOCK",n[n.REFLECT=1]="REFLECT",n[n.SPACE=2]="SPACE",n))(Wall||{}),WallCell=(n=>(n.BLOCK="⬛",n.REFLECT="🟦",n.SPACE="",n))(WallCell||{});class Room{constructor(s){xt(this,"data");xt(this,"width");xt(this,"height");this.data=s.getData(),this.width=this.data[0].length,this.height=this.data.length}at(s){if(s.y<0||this.height<=s.y||s.x<0||this.width<=s.x)return Wall.BLOCK;let c=this.data[s.y][s.x];return c===WallCell.BLOCK?Wall.BLOCK:c===WallCell.REFLECT?Wall.REFLECT:Wall.SPACE}}class Path{constructor(s,c){xt(this,"trace");xt(this,"wallOrientation");xt(this,"player");xt(this,"direction");xt(this,"crashed");xt(this,"catched");this.trace=[],this.wallOrientation=new Set,this.player=s,this.direction=c,this.crashed=!1,this.catched=!1}length(){return this.trace.length}add(s,c){this.trace.push([s,c])}reflect(s,c){let f;c?f=s:f=clockwise(s),this.wallOrientation.add(f)}catch(){this.catched=!0}crash(){this.crashed=!0}satisfy(){return this.wallOrientation.size===4}}const Forward=[[-1,-1],[-1,1],[1,1],[1,-1]],LeftHandSide=[[-1,0],[0,1],[1,0],[0,-1]],RightHandSide=[[0,-1],[-1,0],[0,1],[1,0]];class Point{constructor(s,c){this.x=s,this.y=c}add(s){return new Point(this.x+s.x,this.y+s.y)}equal(s){return this.x===s.x&&this.y===s.y}forward(s){const c=Forward[s];return new Point(this.x+c[0],this.y+c[1])}lhs(s){const c=LeftHandSide[s];return new Point(this.x+c[0],this.y+c[1])}rhs(s){const c=RightHandSide[s];return new Point(this.x+c[0],this.y+c[1])}}function _solve(n,s,c,f,E){for(;;){if(E.length()!==0&&s.equal(c))return E.catch(),E;if(n.at(c)===Wall.BLOCK)return E.crash(),E;E.add(c,f);const D=c.forward(f),U=c.lhs(f),d=c.rhs(f);if(n.at(U)===Wall.REFLECT&&n.at(d)===Wall.REFLECT)return E;if(n.at(D)===Wall.REFLECT){if(n.at(U)===Wall.REFLECT){E.reflect(f,!0),c=d,f=clockwise(f);continue}if(n.at(d)===Wall.REFLECT){E.reflect(f,!1),c=U,f=counterClockwise(f);continue}f=opposite(f);continue}c=D}}function solve(n){const s=[];for(let c=0;c<n.height;++c)for(let f=0;f<n.width;++f){const E=new Point(f,c);if(n.at(E)===Wall.SPACE)for(let D=0;D<4;++D){const U=D,d=_solve(n,E,E,U,new Path(E,U));d.satisfy()&&s.push(d)}}return s}function point2Cell(n,s){return[n(s.x),s.y+1]}document.addEventListener("DOMContentLoaded",()=>{var E,D,U,d,r;const n=document.getElementById("room"),s={type:"dropdown",source:[WallCell.REFLECT,WallCell.BLOCK,"　"],width:30},c=jspreadsheet(n,{data:[["⬛","⬛","🟦","🟦","🟦","🟦","🟦","🟦","🟦","🟦","⬛","⬛"],["⬛","⬛","🟦","","","","","","","🟦","⬛","⬛"],["🟦","🟦","🟦","","","","","","","🟦","🟦","🟦"],["🟦","","","","","","","","","","","🟦"],["🟦","","","","","","","","","","","🟦"],["🟦","","","","","","","","","","","🟦"],["🟦","🟦","🟦","","","","","","","","🟦","🟦"],["⬛","⬛","🟦","🟦","🟦","🟦","🟦","🟦","🟦","","🟦","⬛"]],columnSorting:!1,columns:new Array(12).fill(s)});(E=document.getElementById("addRowButton"))==null||E.addEventListener("click",()=>{c.insertRow()}),(D=document.getElementById("rmRowButton"))==null||D.addEventListener("click",()=>{c.deleteRow()}),(U=document.getElementById("addColButton"))==null||U.addEventListener("click",()=>{c.insertColumn(void 0,void 0,void 0,[s])}),(d=document.getElementById("rmColButton"))==null||d.addEventListener("click",()=>{c.deleteColumn()});const f=document.getElementById("result");(r=document.getElementById("solveButton"))==null||r.addEventListener("click",()=>{f.innerHTML="";const b=new Room(c),H=solve(b),P=document.createElement("div");P.innerHTML=`分裂可能な初期位置数: ${H.length}`,f.appendChild(P);for(const g of H){const u=document.createElement("div"),m=point2Cell(c.getHeader,g.player);let j="";g.catched&&(j+=", シレンの位置に飛んでくる"),g.crashed&&(j+=", 壺割れる"),u.innerHTML=`<div>
      初期位置: (${m[0]}, ${m[1]}), 投げる向き: ${tostring(g.direction)}${j}
      </div>`,f.appendChild(u)}})});
